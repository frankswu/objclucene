//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: ./core/src/java/org/apache/lucene/codecs/NormsConsumer.java
//

#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "java/io/IOException.h"
#include "java/lang/Iterable.h"
#include "java/lang/Long.h"
#include "java/lang/UnsupportedOperationException.h"
#include "java/util/ArrayList.h"
#include "java/util/Iterator.h"
#include "java/util/List.h"
#include "java/util/NoSuchElementException.h"
#include "org/apache/lucene/codecs/NormsConsumer.h"
#include "org/apache/lucene/codecs/NormsProducer.h"
#include "org/apache/lucene/index/DocValues.h"
#include "org/apache/lucene/index/FieldInfo.h"
#include "org/apache/lucene/index/FieldInfos.h"
#include "org/apache/lucene/index/MergeState.h"
#include "org/apache/lucene/index/NumericDocValues.h"
#include "org/apache/lucene/util/Bits.h"

#pragma clang diagnostic ignored "-Wprotocol"

@interface OrgApacheLuceneCodecsNormsConsumer_$1 : NSObject < JavaLangIterable > {
 @public
  id<JavaUtilList> val$toMerge_;
  OrgApacheLuceneIndexMergeState *val$mergeState_;
}

- (id<JavaUtilIterator>)iterator;

- (instancetype)initWithJavaUtilList:(id<JavaUtilList>)capture$0
  withOrgApacheLuceneIndexMergeState:(OrgApacheLuceneIndexMergeState *)capture$1;

@end

J2OBJC_EMPTY_STATIC_INIT(OrgApacheLuceneCodecsNormsConsumer_$1)

J2OBJC_FIELD_SETTER(OrgApacheLuceneCodecsNormsConsumer_$1, val$toMerge_, id<JavaUtilList>)
J2OBJC_FIELD_SETTER(OrgApacheLuceneCodecsNormsConsumer_$1, val$mergeState_, OrgApacheLuceneIndexMergeState *)

__attribute__((unused)) static void OrgApacheLuceneCodecsNormsConsumer_$1_initWithJavaUtilList_withOrgApacheLuceneIndexMergeState_(OrgApacheLuceneCodecsNormsConsumer_$1 *self, id<JavaUtilList> capture$0, OrgApacheLuceneIndexMergeState *capture$1);

__attribute__((unused)) static OrgApacheLuceneCodecsNormsConsumer_$1 *new_OrgApacheLuceneCodecsNormsConsumer_$1_initWithJavaUtilList_withOrgApacheLuceneIndexMergeState_(id<JavaUtilList> capture$0, OrgApacheLuceneIndexMergeState *capture$1) NS_RETURNS_RETAINED;

__attribute__((unused)) static OrgApacheLuceneCodecsNormsConsumer_$1 *create_OrgApacheLuceneCodecsNormsConsumer_$1_initWithJavaUtilList_withOrgApacheLuceneIndexMergeState_(id<JavaUtilList> capture$0, OrgApacheLuceneIndexMergeState *capture$1);

J2OBJC_TYPE_LITERAL_HEADER(OrgApacheLuceneCodecsNormsConsumer_$1)

@interface OrgApacheLuceneCodecsNormsConsumer_$1_$1 : NSObject < JavaUtilIterator > {
 @public
  OrgApacheLuceneCodecsNormsConsumer_$1 *this$0_;
  jint readerUpto_;
  jint docIDUpto_;
  jlong nextValue_;
  jint maxDoc_;
  OrgApacheLuceneIndexNumericDocValues *currentValues_;
  id<OrgApacheLuceneUtilBits> currentLiveDocs_;
  jboolean nextIsSet_;
}

- (jboolean)hasNext;

- (void)remove;

- (NSNumber *)next;

- (jboolean)setNext;

- (instancetype)initWithOrgApacheLuceneCodecsNormsConsumer_$1:(OrgApacheLuceneCodecsNormsConsumer_$1 *)outer$;

@end

J2OBJC_EMPTY_STATIC_INIT(OrgApacheLuceneCodecsNormsConsumer_$1_$1)

J2OBJC_FIELD_SETTER(OrgApacheLuceneCodecsNormsConsumer_$1_$1, this$0_, OrgApacheLuceneCodecsNormsConsumer_$1 *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneCodecsNormsConsumer_$1_$1, currentValues_, OrgApacheLuceneIndexNumericDocValues *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneCodecsNormsConsumer_$1_$1, currentLiveDocs_, id<OrgApacheLuceneUtilBits>)

__attribute__((unused)) static jboolean OrgApacheLuceneCodecsNormsConsumer_$1_$1_setNext(OrgApacheLuceneCodecsNormsConsumer_$1_$1 *self);

__attribute__((unused)) static void OrgApacheLuceneCodecsNormsConsumer_$1_$1_initWithOrgApacheLuceneCodecsNormsConsumer_$1_(OrgApacheLuceneCodecsNormsConsumer_$1_$1 *self, OrgApacheLuceneCodecsNormsConsumer_$1 *outer$);

__attribute__((unused)) static OrgApacheLuceneCodecsNormsConsumer_$1_$1 *new_OrgApacheLuceneCodecsNormsConsumer_$1_$1_initWithOrgApacheLuceneCodecsNormsConsumer_$1_(OrgApacheLuceneCodecsNormsConsumer_$1 *outer$) NS_RETURNS_RETAINED;

__attribute__((unused)) static OrgApacheLuceneCodecsNormsConsumer_$1_$1 *create_OrgApacheLuceneCodecsNormsConsumer_$1_$1_initWithOrgApacheLuceneCodecsNormsConsumer_$1_(OrgApacheLuceneCodecsNormsConsumer_$1 *outer$);

J2OBJC_TYPE_LITERAL_HEADER(OrgApacheLuceneCodecsNormsConsumer_$1_$1)

@implementation OrgApacheLuceneCodecsNormsConsumer

J2OBJC_IGNORE_DESIGNATED_BEGIN
- (instancetype)init {
  OrgApacheLuceneCodecsNormsConsumer_init(self);
  return self;
}
J2OBJC_IGNORE_DESIGNATED_END

- (void)addNormsFieldWithOrgApacheLuceneIndexFieldInfo:(OrgApacheLuceneIndexFieldInfo *)field
                                  withJavaLangIterable:(id<JavaLangIterable>)values {
  // can't call an abstract method
  [self doesNotRecognizeSelector:_cmd];
}

- (void)mergeWithOrgApacheLuceneIndexMergeState:(OrgApacheLuceneIndexMergeState *)mergeState {
  {
    IOSObjectArray *a__ = ((OrgApacheLuceneIndexMergeState *) nil_chk(mergeState))->normsProducers_;
    OrgApacheLuceneCodecsNormsProducer * const *b__ = ((IOSObjectArray *) nil_chk(a__))->buffer_;
    OrgApacheLuceneCodecsNormsProducer * const *e__ = b__ + a__->size_;
    while (b__ < e__) {
      OrgApacheLuceneCodecsNormsProducer *normsProducer = *b__++;
      if (normsProducer != nil) {
        [normsProducer checkIntegrity];
      }
    }
  }
  for (OrgApacheLuceneIndexFieldInfo * __strong mergeFieldInfo in nil_chk(mergeState->mergeFieldInfos_)) {
    if ([((OrgApacheLuceneIndexFieldInfo *) nil_chk(mergeFieldInfo)) hasNorms]) {
      id<JavaUtilList> toMerge = create_JavaUtilArrayList_init();
      for (jint i = 0; i < ((IOSObjectArray *) nil_chk(mergeState->normsProducers_))->size_; i++) {
        OrgApacheLuceneCodecsNormsProducer *normsProducer = IOSObjectArray_Get(mergeState->normsProducers_, i);
        OrgApacheLuceneIndexNumericDocValues *norms = nil;
        if (normsProducer != nil) {
          OrgApacheLuceneIndexFieldInfo *fieldInfo = [((OrgApacheLuceneIndexFieldInfos *) nil_chk(IOSObjectArray_Get(nil_chk(mergeState->fieldInfos_), i))) fieldInfoWithNSString:mergeFieldInfo->name_];
          if (fieldInfo != nil && [fieldInfo hasNorms]) {
            norms = [normsProducer getNormsWithOrgApacheLuceneIndexFieldInfo:fieldInfo];
          }
        }
        if (norms == nil) {
          norms = OrgApacheLuceneIndexDocValues_emptyNumeric();
        }
        [toMerge addWithId:norms];
      }
      [self mergeNormsFieldWithOrgApacheLuceneIndexFieldInfo:mergeFieldInfo withOrgApacheLuceneIndexMergeState:mergeState withJavaUtilList:toMerge];
    }
  }
}

- (void)mergeNormsFieldWithOrgApacheLuceneIndexFieldInfo:(OrgApacheLuceneIndexFieldInfo *)fieldInfo
                      withOrgApacheLuceneIndexMergeState:(OrgApacheLuceneIndexMergeState *)mergeState
                                        withJavaUtilList:(id<JavaUtilList>)toMerge {
  [self addNormsFieldWithOrgApacheLuceneIndexFieldInfo:fieldInfo withJavaLangIterable:create_OrgApacheLuceneCodecsNormsConsumer_$1_initWithJavaUtilList_withOrgApacheLuceneIndexMergeState_(toMerge, mergeState)];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "init", "NormsConsumer", NULL, 0x4, NULL, NULL },
    { "addNormsFieldWithOrgApacheLuceneIndexFieldInfo:withJavaLangIterable:", "addNormsField", "V", 0x401, "Ljava.io.IOException;", "(Lorg/apache/lucene/index/FieldInfo;Ljava/lang/Iterable<Ljava/lang/Number;>;)V" },
    { "mergeWithOrgApacheLuceneIndexMergeState:", "merge", "V", 0x1, "Ljava.io.IOException;", NULL },
    { "mergeNormsFieldWithOrgApacheLuceneIndexFieldInfo:withOrgApacheLuceneIndexMergeState:withJavaUtilList:", "mergeNormsField", "V", 0x1, "Ljava.io.IOException;", "(Lorg/apache/lucene/index/FieldInfo;Lorg/apache/lucene/index/MergeState;Ljava/util/List<Lorg/apache/lucene/index/NumericDocValues;>;)V" },
  };
  static const J2ObjcClassInfo _OrgApacheLuceneCodecsNormsConsumer = { 2, "NormsConsumer", "org.apache.lucene.codecs", NULL, 0x401, 4, methods, 0, NULL, 0, NULL, 0, NULL, NULL, NULL };
  return &_OrgApacheLuceneCodecsNormsConsumer;
}

@end

void OrgApacheLuceneCodecsNormsConsumer_init(OrgApacheLuceneCodecsNormsConsumer *self) {
  NSObject_init(self);
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneCodecsNormsConsumer)

@implementation OrgApacheLuceneCodecsNormsConsumer_$1

- (id<JavaUtilIterator>)iterator {
  return create_OrgApacheLuceneCodecsNormsConsumer_$1_$1_initWithOrgApacheLuceneCodecsNormsConsumer_$1_(self);
}

- (instancetype)initWithJavaUtilList:(id<JavaUtilList>)capture$0
  withOrgApacheLuceneIndexMergeState:(OrgApacheLuceneIndexMergeState *)capture$1 {
  OrgApacheLuceneCodecsNormsConsumer_$1_initWithJavaUtilList_withOrgApacheLuceneIndexMergeState_(self, capture$0, capture$1);
  return self;
}

- (NSUInteger)countByEnumeratingWithState:(NSFastEnumerationState *)state objects:(__unsafe_unretained id *)stackbuf count:(NSUInteger)len {
  return JreDefaultFastEnumeration(self, state, stackbuf, len);
}

- (void)dealloc {
  RELEASE_(val$toMerge_);
  RELEASE_(val$mergeState_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "iterator", NULL, "Ljava.util.Iterator;", 0x1, NULL, "()Ljava/util/Iterator<Ljava/lang/Number;>;" },
    { "initWithJavaUtilList:withOrgApacheLuceneIndexMergeState:", "", NULL, 0x0, NULL, "(Ljava/util/List<Lorg/apache/lucene/index/NumericDocValues;>;Lorg/apache/lucene/index/MergeState;)V" },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "val$toMerge_", NULL, 0x1012, "Ljava.util.List;", NULL, "Ljava/util/List<Lorg/apache/lucene/index/NumericDocValues;>;", .constantValue.asLong = 0 },
    { "val$mergeState_", NULL, 0x1012, "Lorg.apache.lucene.index.MergeState;", NULL, NULL, .constantValue.asLong = 0 },
  };
  static const J2ObjCEnclosingMethodInfo enclosing_method = { "OrgApacheLuceneCodecsNormsConsumer", "mergeNormsFieldWithOrgApacheLuceneIndexFieldInfo:withOrgApacheLuceneIndexMergeState:withJavaUtilList:" };
  static const J2ObjcClassInfo _OrgApacheLuceneCodecsNormsConsumer_$1 = { 2, "", "org.apache.lucene.codecs", "NormsConsumer", 0x8008, 2, methods, 2, fields, 0, NULL, 0, NULL, &enclosing_method, "Ljava/lang/Object;Ljava/lang/Iterable<Ljava/lang/Number;>;" };
  return &_OrgApacheLuceneCodecsNormsConsumer_$1;
}

@end

void OrgApacheLuceneCodecsNormsConsumer_$1_initWithJavaUtilList_withOrgApacheLuceneIndexMergeState_(OrgApacheLuceneCodecsNormsConsumer_$1 *self, id<JavaUtilList> capture$0, OrgApacheLuceneIndexMergeState *capture$1) {
  JreStrongAssign(&self->val$toMerge_, capture$0);
  JreStrongAssign(&self->val$mergeState_, capture$1);
  NSObject_init(self);
}

OrgApacheLuceneCodecsNormsConsumer_$1 *new_OrgApacheLuceneCodecsNormsConsumer_$1_initWithJavaUtilList_withOrgApacheLuceneIndexMergeState_(id<JavaUtilList> capture$0, OrgApacheLuceneIndexMergeState *capture$1) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneCodecsNormsConsumer_$1, initWithJavaUtilList_withOrgApacheLuceneIndexMergeState_, capture$0, capture$1)
}

OrgApacheLuceneCodecsNormsConsumer_$1 *create_OrgApacheLuceneCodecsNormsConsumer_$1_initWithJavaUtilList_withOrgApacheLuceneIndexMergeState_(id<JavaUtilList> capture$0, OrgApacheLuceneIndexMergeState *capture$1) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneCodecsNormsConsumer_$1, initWithJavaUtilList_withOrgApacheLuceneIndexMergeState_, capture$0, capture$1)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneCodecsNormsConsumer_$1)

@implementation OrgApacheLuceneCodecsNormsConsumer_$1_$1

- (jboolean)hasNext {
  return nextIsSet_ || OrgApacheLuceneCodecsNormsConsumer_$1_$1_setNext(self);
}

- (void)remove {
  @throw create_JavaLangUnsupportedOperationException_init();
}

- (NSNumber *)next {
  if (![self hasNext]) {
    @throw create_JavaUtilNoSuchElementException_init();
  }
  JreAssert((nextIsSet_), (@"org/apache/lucene/codecs/NormsConsumer.java:138 condition failed: assert nextIsSet;"));
  nextIsSet_ = false;
  return JavaLangLong_valueOfWithLong_(nextValue_);
}

- (jboolean)setNext {
  return OrgApacheLuceneCodecsNormsConsumer_$1_$1_setNext(self);
}

- (instancetype)initWithOrgApacheLuceneCodecsNormsConsumer_$1:(OrgApacheLuceneCodecsNormsConsumer_$1 *)outer$ {
  OrgApacheLuceneCodecsNormsConsumer_$1_$1_initWithOrgApacheLuceneCodecsNormsConsumer_$1_(self, outer$);
  return self;
}

- (void)dealloc {
  RELEASE_(this$0_);
  RELEASE_(currentValues_);
  RELEASE_(currentLiveDocs_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "hasNext", NULL, "Z", 0x1, NULL, NULL },
    { "remove", NULL, "V", 0x1, NULL, NULL },
    { "next", NULL, "Ljava.lang.Number;", 0x1, NULL, NULL },
    { "setNext", NULL, "Z", 0x2, NULL, NULL },
    { "initWithOrgApacheLuceneCodecsNormsConsumer_$1:", "", NULL, 0x0, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "this$0_", NULL, 0x1012, "Lorg.apache.lucene.codecs.NormsConsumer$1;", NULL, NULL, .constantValue.asLong = 0 },
    { "readerUpto_", NULL, 0x0, "I", NULL, NULL, .constantValue.asLong = 0 },
    { "docIDUpto_", NULL, 0x0, "I", NULL, NULL, .constantValue.asLong = 0 },
    { "nextValue_", NULL, 0x0, "J", NULL, NULL, .constantValue.asLong = 0 },
    { "maxDoc_", NULL, 0x0, "I", NULL, NULL, .constantValue.asLong = 0 },
    { "currentValues_", NULL, 0x0, "Lorg.apache.lucene.index.NumericDocValues;", NULL, NULL, .constantValue.asLong = 0 },
    { "currentLiveDocs_", NULL, 0x0, "Lorg.apache.lucene.util.Bits;", NULL, NULL, .constantValue.asLong = 0 },
    { "nextIsSet_", NULL, 0x0, "Z", NULL, NULL, .constantValue.asLong = 0 },
  };
  static const J2ObjCEnclosingMethodInfo enclosing_method = { "OrgApacheLuceneCodecsNormsConsumer_$1", "iterator" };
  static const J2ObjcClassInfo _OrgApacheLuceneCodecsNormsConsumer_$1_$1 = { 2, "", "org.apache.lucene.codecs", "NormsConsumer$", 0x8008, 5, methods, 8, fields, 0, NULL, 0, NULL, &enclosing_method, "Ljava/lang/Object;Ljava/util/Iterator<Ljava/lang/Number;>;" };
  return &_OrgApacheLuceneCodecsNormsConsumer_$1_$1;
}

@end

jboolean OrgApacheLuceneCodecsNormsConsumer_$1_$1_setNext(OrgApacheLuceneCodecsNormsConsumer_$1_$1 *self) {
  while (true) {
    if (self->readerUpto_ == [((id<JavaUtilList>) nil_chk(self->this$0_->val$toMerge_)) size]) {
      return false;
    }
    if (self->currentValues_ == nil || self->docIDUpto_ == self->maxDoc_) {
      self->readerUpto_++;
      if (self->readerUpto_ < [self->this$0_->val$toMerge_ size]) {
        JreStrongAssign(&self->currentValues_, [self->this$0_->val$toMerge_ getWithInt:self->readerUpto_]);
        JreStrongAssign(&self->currentLiveDocs_, IOSObjectArray_Get(nil_chk(((OrgApacheLuceneIndexMergeState *) nil_chk(self->this$0_->val$mergeState_))->liveDocs_), self->readerUpto_));
        self->maxDoc_ = IOSIntArray_Get(nil_chk(self->this$0_->val$mergeState_->maxDocs_), self->readerUpto_);
      }
      self->docIDUpto_ = 0;
      continue;
    }
    if (self->currentLiveDocs_ == nil || [self->currentLiveDocs_ getWithInt:self->docIDUpto_]) {
      self->nextIsSet_ = true;
      self->nextValue_ = [((OrgApacheLuceneIndexNumericDocValues *) nil_chk(self->currentValues_)) getWithInt:self->docIDUpto_];
      self->docIDUpto_++;
      return true;
    }
    self->docIDUpto_++;
  }
}

void OrgApacheLuceneCodecsNormsConsumer_$1_$1_initWithOrgApacheLuceneCodecsNormsConsumer_$1_(OrgApacheLuceneCodecsNormsConsumer_$1_$1 *self, OrgApacheLuceneCodecsNormsConsumer_$1 *outer$) {
  JreStrongAssign(&self->this$0_, outer$);
  NSObject_init(self);
  self->readerUpto_ = -1;
}

OrgApacheLuceneCodecsNormsConsumer_$1_$1 *new_OrgApacheLuceneCodecsNormsConsumer_$1_$1_initWithOrgApacheLuceneCodecsNormsConsumer_$1_(OrgApacheLuceneCodecsNormsConsumer_$1 *outer$) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneCodecsNormsConsumer_$1_$1, initWithOrgApacheLuceneCodecsNormsConsumer_$1_, outer$)
}

OrgApacheLuceneCodecsNormsConsumer_$1_$1 *create_OrgApacheLuceneCodecsNormsConsumer_$1_$1_initWithOrgApacheLuceneCodecsNormsConsumer_$1_(OrgApacheLuceneCodecsNormsConsumer_$1 *outer$) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneCodecsNormsConsumer_$1_$1, initWithOrgApacheLuceneCodecsNormsConsumer_$1_, outer$)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneCodecsNormsConsumer_$1_$1)
