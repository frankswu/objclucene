//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: ./core/src/java/org/apache/lucene/codecs/lucene50/Lucene50CompoundFormat.java
//

#include "IOSClass.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "java/io/IOException.h"
#include "java/lang/Throwable.h"
#include "java/util/Set.h"
#include "org/apache/lucene/codecs/CodecUtil.h"
#include "org/apache/lucene/codecs/CompoundFormat.h"
#include "org/apache/lucene/codecs/lucene50/Lucene50CompoundFormat.h"
#include "org/apache/lucene/codecs/lucene50/Lucene50CompoundReader.h"
#include "org/apache/lucene/index/IndexFileNames.h"
#include "org/apache/lucene/index/SegmentInfo.h"
#include "org/apache/lucene/store/Directory.h"
#include "org/apache/lucene/store/IOContext.h"
#include "org/apache/lucene/store/IndexInput.h"
#include "org/apache/lucene/store/IndexOutput.h"

NSString *OrgApacheLuceneCodecsLucene50Lucene50CompoundFormat_DATA_EXTENSION_ = @"cfs";
NSString *OrgApacheLuceneCodecsLucene50Lucene50CompoundFormat_ENTRIES_EXTENSION_ = @"cfe";
NSString *OrgApacheLuceneCodecsLucene50Lucene50CompoundFormat_DATA_CODEC_ = @"Lucene50CompoundData";
NSString *OrgApacheLuceneCodecsLucene50Lucene50CompoundFormat_ENTRY_CODEC_ = @"Lucene50CompoundEntries";

@implementation OrgApacheLuceneCodecsLucene50Lucene50CompoundFormat

- (instancetype)init {
  OrgApacheLuceneCodecsLucene50Lucene50CompoundFormat_init(self);
  return self;
}

- (OrgApacheLuceneStoreDirectory *)getCompoundReaderWithOrgApacheLuceneStoreDirectory:(OrgApacheLuceneStoreDirectory *)dir
                                                  withOrgApacheLuceneIndexSegmentInfo:(OrgApacheLuceneIndexSegmentInfo *)si
                                                    withOrgApacheLuceneStoreIOContext:(OrgApacheLuceneStoreIOContext *)context {
  return [new_OrgApacheLuceneCodecsLucene50Lucene50CompoundReader_initWithOrgApacheLuceneStoreDirectory_withOrgApacheLuceneIndexSegmentInfo_withOrgApacheLuceneStoreIOContext_(dir, si, context) autorelease];
}

- (void)writeWithOrgApacheLuceneStoreDirectory:(OrgApacheLuceneStoreDirectory *)dir
           withOrgApacheLuceneIndexSegmentInfo:(OrgApacheLuceneIndexSegmentInfo *)si
             withOrgApacheLuceneStoreIOContext:(OrgApacheLuceneStoreIOContext *)context {
  NSString *dataFile = OrgApacheLuceneIndexIndexFileNames_segmentFileNameWithNSString_withNSString_withNSString_(((OrgApacheLuceneIndexSegmentInfo *) nil_chk(si))->name_, @"", OrgApacheLuceneCodecsLucene50Lucene50CompoundFormat_DATA_EXTENSION_);
  NSString *entriesFile = OrgApacheLuceneIndexIndexFileNames_segmentFileNameWithNSString_withNSString_withNSString_(si->name_, @"", OrgApacheLuceneCodecsLucene50Lucene50CompoundFormat_ENTRIES_EXTENSION_);
  {
    JavaLangThrowable *__mainException = nil;
    OrgApacheLuceneStoreIndexOutput *data = [((OrgApacheLuceneStoreDirectory *) nil_chk(dir)) createOutputWithNSString:dataFile withOrgApacheLuceneStoreIOContext:context];
    OrgApacheLuceneStoreIndexOutput *entries = [dir createOutputWithNSString:entriesFile withOrgApacheLuceneStoreIOContext:context];
    @try {
      OrgApacheLuceneCodecsCodecUtil_writeIndexHeaderWithOrgApacheLuceneStoreDataOutput_withNSString_withInt_withByteArray_withNSString_(data, OrgApacheLuceneCodecsLucene50Lucene50CompoundFormat_DATA_CODEC_, OrgApacheLuceneCodecsLucene50Lucene50CompoundFormat_VERSION_CURRENT, [si getId], @"");
      OrgApacheLuceneCodecsCodecUtil_writeIndexHeaderWithOrgApacheLuceneStoreDataOutput_withNSString_withInt_withByteArray_withNSString_(entries, OrgApacheLuceneCodecsLucene50Lucene50CompoundFormat_ENTRY_CODEC_, OrgApacheLuceneCodecsLucene50Lucene50CompoundFormat_VERSION_CURRENT, [si getId], @"");
      [((OrgApacheLuceneStoreIndexOutput *) nil_chk(entries)) writeVIntWithInt:[((id<JavaUtilSet>) nil_chk([si files])) size]];
      for (NSString * __strong file in nil_chk([si files])) {
        jlong startOffset = [((OrgApacheLuceneStoreIndexOutput *) nil_chk(data)) getFilePointer];
        {
          JavaLangThrowable *__mainException = nil;
          OrgApacheLuceneStoreIndexInput *in = [dir openInputWithNSString:file withOrgApacheLuceneStoreIOContext:JreLoadStatic(OrgApacheLuceneStoreIOContext, READONCE_)];
          @try {
            [data copyBytesWithOrgApacheLuceneStoreDataInput:in withLong:[((OrgApacheLuceneStoreIndexInput *) nil_chk(in)) length]];
          }
          @finally {
            @try {
              [in close];
            }
            @catch (JavaLangThrowable *e) {
              if (__mainException) {
                [__mainException addSuppressedWithJavaLangThrowable:e];
              } else {
                __mainException = e;
              }
            }
            if (__mainException) {
              @throw __mainException;
            }
          }
        }
        jlong endOffset = [data getFilePointer];
        jlong length = endOffset - startOffset;
        [entries writeStringWithNSString:OrgApacheLuceneIndexIndexFileNames_stripSegmentNameWithNSString_(file)];
        [entries writeLongWithLong:startOffset];
        [entries writeLongWithLong:length];
      }
      OrgApacheLuceneCodecsCodecUtil_writeFooterWithOrgApacheLuceneStoreIndexOutput_(data);
      OrgApacheLuceneCodecsCodecUtil_writeFooterWithOrgApacheLuceneStoreIndexOutput_(entries);
    }
    @finally {
      @try {
        [entries close];
      }
      @catch (JavaLangThrowable *e) {
        if (__mainException) {
          [__mainException addSuppressedWithJavaLangThrowable:e];
        } else {
          __mainException = e;
        }
      }
      @try {
        [data close];
      }
      @catch (JavaLangThrowable *e) {
        if (__mainException) {
          [__mainException addSuppressedWithJavaLangThrowable:e];
        } else {
          __mainException = e;
        }
      }
      if (__mainException) {
        @throw __mainException;
      }
    }
  }
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "init", "Lucene50CompoundFormat", NULL, 0x1, NULL, NULL },
    { "getCompoundReaderWithOrgApacheLuceneStoreDirectory:withOrgApacheLuceneIndexSegmentInfo:withOrgApacheLuceneStoreIOContext:", "getCompoundReader", "Lorg.apache.lucene.store.Directory;", 0x1, "Ljava.io.IOException;", NULL },
    { "writeWithOrgApacheLuceneStoreDirectory:withOrgApacheLuceneIndexSegmentInfo:withOrgApacheLuceneStoreIOContext:", "write", "V", 0x1, "Ljava.io.IOException;", NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "DATA_EXTENSION_", NULL, 0x18, "Ljava.lang.String;", &OrgApacheLuceneCodecsLucene50Lucene50CompoundFormat_DATA_EXTENSION_, NULL, .constantValue.asLong = 0 },
    { "ENTRIES_EXTENSION_", NULL, 0x18, "Ljava.lang.String;", &OrgApacheLuceneCodecsLucene50Lucene50CompoundFormat_ENTRIES_EXTENSION_, NULL, .constantValue.asLong = 0 },
    { "DATA_CODEC_", NULL, 0x18, "Ljava.lang.String;", &OrgApacheLuceneCodecsLucene50Lucene50CompoundFormat_DATA_CODEC_, NULL, .constantValue.asLong = 0 },
    { "ENTRY_CODEC_", NULL, 0x18, "Ljava.lang.String;", &OrgApacheLuceneCodecsLucene50Lucene50CompoundFormat_ENTRY_CODEC_, NULL, .constantValue.asLong = 0 },
    { "VERSION_START", "VERSION_START", 0x18, "I", NULL, NULL, .constantValue.asInt = OrgApacheLuceneCodecsLucene50Lucene50CompoundFormat_VERSION_START },
    { "VERSION_CURRENT", "VERSION_CURRENT", 0x18, "I", NULL, NULL, .constantValue.asInt = OrgApacheLuceneCodecsLucene50Lucene50CompoundFormat_VERSION_CURRENT },
  };
  static const J2ObjcClassInfo _OrgApacheLuceneCodecsLucene50Lucene50CompoundFormat = { 2, "Lucene50CompoundFormat", "org.apache.lucene.codecs.lucene50", NULL, 0x11, 3, methods, 6, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_OrgApacheLuceneCodecsLucene50Lucene50CompoundFormat;
}

@end

void OrgApacheLuceneCodecsLucene50Lucene50CompoundFormat_init(OrgApacheLuceneCodecsLucene50Lucene50CompoundFormat *self) {
  OrgApacheLuceneCodecsCompoundFormat_init(self);
}

OrgApacheLuceneCodecsLucene50Lucene50CompoundFormat *new_OrgApacheLuceneCodecsLucene50Lucene50CompoundFormat_init() {
  OrgApacheLuceneCodecsLucene50Lucene50CompoundFormat *self = [OrgApacheLuceneCodecsLucene50Lucene50CompoundFormat alloc];
  OrgApacheLuceneCodecsLucene50Lucene50CompoundFormat_init(self);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneCodecsLucene50Lucene50CompoundFormat)
