//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: ./queries/src/java/org/apache/lucene/queries/CustomScoreQuery.java
//

#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "java/io/IOException.h"
#include "java/lang/Float.h"
#include "java/lang/IllegalArgumentException.h"
#include "java/lang/StringBuilder.h"
#include "java/util/Arrays.h"
#include "java/util/Collection.h"
#include "java/util/Collections.h"
#include "java/util/Set.h"
#include "org/apache/lucene/index/IndexReader.h"
#include "org/apache/lucene/index/LeafReaderContext.h"
#include "org/apache/lucene/queries/CustomScoreProvider.h"
#include "org/apache/lucene/queries/CustomScoreQuery.h"
#include "org/apache/lucene/queries/function/FunctionQuery.h"
#include "org/apache/lucene/search/Explanation.h"
#include "org/apache/lucene/search/FilterScorer.h"
#include "org/apache/lucene/search/IndexSearcher.h"
#include "org/apache/lucene/search/Query.h"
#include "org/apache/lucene/search/Scorer.h"
#include "org/apache/lucene/search/Weight.h"
#include "org/apache/lucene/util/ToStringUtils.h"

@interface OrgApacheLuceneQueriesCustomScoreQuery () {
 @public
  OrgApacheLuceneSearchQuery *subQuery_;
  IOSObjectArray *scoringQueries_;
  jboolean strict_;
}

@end

J2OBJC_FIELD_SETTER(OrgApacheLuceneQueriesCustomScoreQuery, subQuery_, OrgApacheLuceneSearchQuery *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneQueriesCustomScoreQuery, scoringQueries_, IOSObjectArray *)

@interface OrgApacheLuceneQueriesCustomScoreQuery_CustomWeight : OrgApacheLuceneSearchWeight {
 @public
  OrgApacheLuceneQueriesCustomScoreQuery *this$0_;
  OrgApacheLuceneSearchWeight *subQueryWeight_;
  IOSObjectArray *valSrcWeights_;
  jboolean qStrict_;
  jfloat queryWeight_;
}

- (instancetype)initWithOrgApacheLuceneQueriesCustomScoreQuery:(OrgApacheLuceneQueriesCustomScoreQuery *)outer$
                        withOrgApacheLuceneSearchIndexSearcher:(OrgApacheLuceneSearchIndexSearcher *)searcher
                                                   withBoolean:(jboolean)needsScores;

- (void)extractTermsWithJavaUtilSet:(id<JavaUtilSet>)terms;

- (jfloat)getValueForNormalization;

- (void)normalizeWithFloat:(jfloat)norm
                 withFloat:(jfloat)topLevelBoost;

- (OrgApacheLuceneSearchScorer *)scorerWithOrgApacheLuceneIndexLeafReaderContext:(OrgApacheLuceneIndexLeafReaderContext *)context;

- (OrgApacheLuceneSearchExplanation *)explainWithOrgApacheLuceneIndexLeafReaderContext:(OrgApacheLuceneIndexLeafReaderContext *)context
                                                                               withInt:(jint)doc;

- (OrgApacheLuceneSearchExplanation *)doExplainWithOrgApacheLuceneIndexLeafReaderContext:(OrgApacheLuceneIndexLeafReaderContext *)info
                                                                                 withInt:(jint)doc;

@end

J2OBJC_EMPTY_STATIC_INIT(OrgApacheLuceneQueriesCustomScoreQuery_CustomWeight)

J2OBJC_FIELD_SETTER(OrgApacheLuceneQueriesCustomScoreQuery_CustomWeight, this$0_, OrgApacheLuceneQueriesCustomScoreQuery *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneQueriesCustomScoreQuery_CustomWeight, subQueryWeight_, OrgApacheLuceneSearchWeight *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneQueriesCustomScoreQuery_CustomWeight, valSrcWeights_, IOSObjectArray *)

__attribute__((unused)) static void OrgApacheLuceneQueriesCustomScoreQuery_CustomWeight_initWithOrgApacheLuceneQueriesCustomScoreQuery_withOrgApacheLuceneSearchIndexSearcher_withBoolean_(OrgApacheLuceneQueriesCustomScoreQuery_CustomWeight *self, OrgApacheLuceneQueriesCustomScoreQuery *outer$, OrgApacheLuceneSearchIndexSearcher *searcher, jboolean needsScores);

__attribute__((unused)) static OrgApacheLuceneQueriesCustomScoreQuery_CustomWeight *new_OrgApacheLuceneQueriesCustomScoreQuery_CustomWeight_initWithOrgApacheLuceneQueriesCustomScoreQuery_withOrgApacheLuceneSearchIndexSearcher_withBoolean_(OrgApacheLuceneQueriesCustomScoreQuery *outer$, OrgApacheLuceneSearchIndexSearcher *searcher, jboolean needsScores) NS_RETURNS_RETAINED;

__attribute__((unused)) static OrgApacheLuceneSearchExplanation *OrgApacheLuceneQueriesCustomScoreQuery_CustomWeight_doExplainWithOrgApacheLuceneIndexLeafReaderContext_withInt_(OrgApacheLuceneQueriesCustomScoreQuery_CustomWeight *self, OrgApacheLuceneIndexLeafReaderContext *info, jint doc);

J2OBJC_TYPE_LITERAL_HEADER(OrgApacheLuceneQueriesCustomScoreQuery_CustomWeight)

@interface OrgApacheLuceneQueriesCustomScoreQuery_CustomScorer : OrgApacheLuceneSearchFilterScorer {
 @public
  jfloat qWeight_;
  OrgApacheLuceneSearchScorer *subQueryScorer_;
  IOSObjectArray *valSrcScorers_;
  OrgApacheLuceneQueriesCustomScoreProvider *provider_;
  IOSFloatArray *vScores_;
  jint valSrcDocID_;
}

- (instancetype)initWithOrgApacheLuceneQueriesCustomScoreQuery:(OrgApacheLuceneQueriesCustomScoreQuery *)outer$
                 withOrgApacheLuceneQueriesCustomScoreProvider:(OrgApacheLuceneQueriesCustomScoreProvider *)provider
       withOrgApacheLuceneQueriesCustomScoreQuery_CustomWeight:(OrgApacheLuceneQueriesCustomScoreQuery_CustomWeight *)w
                                                     withFloat:(jfloat)qWeight
                               withOrgApacheLuceneSearchScorer:(OrgApacheLuceneSearchScorer *)subQueryScorer
                          withOrgApacheLuceneSearchScorerArray:(IOSObjectArray *)valSrcScorers;

- (jfloat)score;

- (id<JavaUtilCollection>)getChildren;

@end

J2OBJC_EMPTY_STATIC_INIT(OrgApacheLuceneQueriesCustomScoreQuery_CustomScorer)

J2OBJC_FIELD_SETTER(OrgApacheLuceneQueriesCustomScoreQuery_CustomScorer, subQueryScorer_, OrgApacheLuceneSearchScorer *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneQueriesCustomScoreQuery_CustomScorer, valSrcScorers_, IOSObjectArray *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneQueriesCustomScoreQuery_CustomScorer, provider_, OrgApacheLuceneQueriesCustomScoreProvider *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneQueriesCustomScoreQuery_CustomScorer, vScores_, IOSFloatArray *)

__attribute__((unused)) static void OrgApacheLuceneQueriesCustomScoreQuery_CustomScorer_initWithOrgApacheLuceneQueriesCustomScoreQuery_withOrgApacheLuceneQueriesCustomScoreProvider_withOrgApacheLuceneQueriesCustomScoreQuery_CustomWeight_withFloat_withOrgApacheLuceneSearchScorer_withOrgApacheLuceneSearchScorerArray_(OrgApacheLuceneQueriesCustomScoreQuery_CustomScorer *self, OrgApacheLuceneQueriesCustomScoreQuery *outer$, OrgApacheLuceneQueriesCustomScoreProvider *provider, OrgApacheLuceneQueriesCustomScoreQuery_CustomWeight *w, jfloat qWeight, OrgApacheLuceneSearchScorer *subQueryScorer, IOSObjectArray *valSrcScorers);

__attribute__((unused)) static OrgApacheLuceneQueriesCustomScoreQuery_CustomScorer *new_OrgApacheLuceneQueriesCustomScoreQuery_CustomScorer_initWithOrgApacheLuceneQueriesCustomScoreQuery_withOrgApacheLuceneQueriesCustomScoreProvider_withOrgApacheLuceneQueriesCustomScoreQuery_CustomWeight_withFloat_withOrgApacheLuceneSearchScorer_withOrgApacheLuceneSearchScorerArray_(OrgApacheLuceneQueriesCustomScoreQuery *outer$, OrgApacheLuceneQueriesCustomScoreProvider *provider, OrgApacheLuceneQueriesCustomScoreQuery_CustomWeight *w, jfloat qWeight, OrgApacheLuceneSearchScorer *subQueryScorer, IOSObjectArray *valSrcScorers) NS_RETURNS_RETAINED;

J2OBJC_TYPE_LITERAL_HEADER(OrgApacheLuceneQueriesCustomScoreQuery_CustomScorer)

@implementation OrgApacheLuceneQueriesCustomScoreQuery

- (instancetype)initWithOrgApacheLuceneSearchQuery:(OrgApacheLuceneSearchQuery *)subQuery {
  OrgApacheLuceneQueriesCustomScoreQuery_initWithOrgApacheLuceneSearchQuery_(self, subQuery);
  return self;
}

- (instancetype)initWithOrgApacheLuceneSearchQuery:(OrgApacheLuceneSearchQuery *)subQuery
   withOrgApacheLuceneQueriesFunctionFunctionQuery:(OrgApacheLuceneQueriesFunctionFunctionQuery *)scoringQuery {
  OrgApacheLuceneQueriesCustomScoreQuery_initWithOrgApacheLuceneSearchQuery_withOrgApacheLuceneQueriesFunctionFunctionQuery_(self, subQuery, scoringQuery);
  return self;
}

- (instancetype)initWithOrgApacheLuceneSearchQuery:(OrgApacheLuceneSearchQuery *)subQuery
withOrgApacheLuceneQueriesFunctionFunctionQueryArray:(IOSObjectArray *)scoringQueries {
  OrgApacheLuceneQueriesCustomScoreQuery_initWithOrgApacheLuceneSearchQuery_withOrgApacheLuceneQueriesFunctionFunctionQueryArray_(self, subQuery, scoringQueries);
  return self;
}

- (OrgApacheLuceneSearchQuery *)rewriteWithOrgApacheLuceneIndexIndexReader:(OrgApacheLuceneIndexIndexReader *)reader {
  OrgApacheLuceneQueriesCustomScoreQuery *clone = nil;
  OrgApacheLuceneSearchQuery *sq = [((OrgApacheLuceneSearchQuery *) nil_chk(subQuery_)) rewriteWithOrgApacheLuceneIndexIndexReader:reader];
  if (sq != subQuery_) {
    clone = [self clone];
    JreStrongAssign(&((OrgApacheLuceneQueriesCustomScoreQuery *) nil_chk(clone))->subQuery_, sq);
  }
  for (jint i = 0; i < ((IOSObjectArray *) nil_chk(scoringQueries_))->size_; i++) {
    OrgApacheLuceneSearchQuery *v = [((OrgApacheLuceneSearchQuery *) nil_chk(IOSObjectArray_Get(scoringQueries_, i))) rewriteWithOrgApacheLuceneIndexIndexReader:reader];
    if (v != IOSObjectArray_Get(scoringQueries_, i)) {
      if (clone == nil) clone = [self clone];
      IOSObjectArray_Set(((OrgApacheLuceneQueriesCustomScoreQuery *) nil_chk(clone))->scoringQueries_, i, v);
    }
  }
  return (clone == nil) ? self : clone;
}

- (OrgApacheLuceneQueriesCustomScoreQuery *)clone {
  OrgApacheLuceneQueriesCustomScoreQuery *clone = (OrgApacheLuceneQueriesCustomScoreQuery *) check_class_cast([super clone], [OrgApacheLuceneQueriesCustomScoreQuery class]);
  JreStrongAssign(&((OrgApacheLuceneQueriesCustomScoreQuery *) nil_chk(clone))->subQuery_, [((OrgApacheLuceneSearchQuery *) nil_chk(subQuery_)) clone]);
  JreStrongAssignAndConsume(&clone->scoringQueries_, [IOSObjectArray newArrayWithLength:((IOSObjectArray *) nil_chk(scoringQueries_))->size_ type:OrgApacheLuceneSearchQuery_class_()]);
  for (jint i = 0; i < scoringQueries_->size_; i++) {
    IOSObjectArray_Set(clone->scoringQueries_, i, [((OrgApacheLuceneSearchQuery *) nil_chk(IOSObjectArray_Get(scoringQueries_, i))) clone]);
  }
  return clone;
}

- (NSString *)toStringWithNSString:(NSString *)field {
  JavaLangStringBuilder *sb = [((JavaLangStringBuilder *) [new_JavaLangStringBuilder_initWithNSString_([self name]) autorelease]) appendWithNSString:@"("];
  [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:[((OrgApacheLuceneSearchQuery *) nil_chk(subQuery_)) toStringWithNSString:field]];
  {
    IOSObjectArray *a__ = scoringQueries_;
    OrgApacheLuceneSearchQuery * const *b__ = ((IOSObjectArray *) nil_chk(a__))->buffer_;
    OrgApacheLuceneSearchQuery * const *e__ = b__ + a__->size_;
    while (b__ < e__) {
      OrgApacheLuceneSearchQuery *scoringQuery = *b__++;
      [((JavaLangStringBuilder *) nil_chk([sb appendWithNSString:@", "])) appendWithNSString:[((OrgApacheLuceneSearchQuery *) nil_chk(scoringQuery)) toStringWithNSString:field]];
    }
  }
  [sb appendWithNSString:@")"];
  [sb appendWithNSString:strict_ ? @" STRICT" : @""];
  return JreStrcat("$$", [sb description], OrgApacheLuceneUtilToStringUtils_boostWithFloat_([self getBoost]));
}

- (jboolean)isEqual:(id)o {
  if (self == o) return YES;
  if (![super isEqual:o]) return NO;
  if ([self getClass] != [nil_chk(o) getClass]) {
    return NO;
  }
  OrgApacheLuceneQueriesCustomScoreQuery *other = (OrgApacheLuceneQueriesCustomScoreQuery *) check_class_cast(o, [OrgApacheLuceneQueriesCustomScoreQuery class]);
  if ([self getBoost] != [other getBoost] || ![((OrgApacheLuceneSearchQuery *) nil_chk(self->subQuery_)) isEqual:other->subQuery_] || self->strict_ != other->strict_ || ((IOSObjectArray *) nil_chk(self->scoringQueries_))->size_ != other->scoringQueries_->size_) {
    return NO;
  }
  return JavaUtilArrays_equalsWithNSObjectArray_withNSObjectArray_(scoringQueries_, other->scoringQueries_);
}

- (NSUInteger)hash {
  return (((jint) [[self getClass] hash]) + ((jint) [((OrgApacheLuceneSearchQuery *) nil_chk(subQuery_)) hash]) + JavaUtilArrays_hashCodeWithNSObjectArray_(scoringQueries_)) ^ JavaLangFloat_floatToIntBitsWithFloat_([self getBoost]) ^ (strict_ ? 1234 : 4321);
}

- (OrgApacheLuceneQueriesCustomScoreProvider *)getCustomScoreProviderWithOrgApacheLuceneIndexLeafReaderContext:(OrgApacheLuceneIndexLeafReaderContext *)context {
  return [new_OrgApacheLuceneQueriesCustomScoreProvider_initWithOrgApacheLuceneIndexLeafReaderContext_(context) autorelease];
}

- (OrgApacheLuceneSearchWeight *)createWeightWithOrgApacheLuceneSearchIndexSearcher:(OrgApacheLuceneSearchIndexSearcher *)searcher
                                                                        withBoolean:(jboolean)needsScores {
  return [new_OrgApacheLuceneQueriesCustomScoreQuery_CustomWeight_initWithOrgApacheLuceneQueriesCustomScoreQuery_withOrgApacheLuceneSearchIndexSearcher_withBoolean_(self, searcher, needsScores) autorelease];
}

- (jboolean)isStrict {
  return strict_;
}

- (void)setStrictWithBoolean:(jboolean)strict {
  self->strict_ = strict;
}

- (OrgApacheLuceneSearchQuery *)getSubQuery {
  return subQuery_;
}

- (IOSObjectArray *)getScoringQueries {
  return scoringQueries_;
}

- (NSString *)name {
  return @"custom";
}

- (void)dealloc {
  RELEASE_(subQuery_);
  RELEASE_(scoringQueries_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithOrgApacheLuceneSearchQuery:", "CustomScoreQuery", NULL, 0x1, NULL, NULL },
    { "initWithOrgApacheLuceneSearchQuery:withOrgApacheLuceneQueriesFunctionFunctionQuery:", "CustomScoreQuery", NULL, 0x1, NULL, NULL },
    { "initWithOrgApacheLuceneSearchQuery:withOrgApacheLuceneQueriesFunctionFunctionQueryArray:", "CustomScoreQuery", NULL, 0x81, NULL, NULL },
    { "rewriteWithOrgApacheLuceneIndexIndexReader:", "rewrite", "Lorg.apache.lucene.search.Query;", 0x1, "Ljava.io.IOException;", NULL },
    { "clone", NULL, "Lorg.apache.lucene.queries.CustomScoreQuery;", 0x1, NULL, NULL },
    { "toStringWithNSString:", "toString", "Ljava.lang.String;", 0x1, NULL, NULL },
    { "isEqual:", "equals", "Z", 0x1, NULL, NULL },
    { "hash", "hashCode", "I", 0x1, NULL, NULL },
    { "getCustomScoreProviderWithOrgApacheLuceneIndexLeafReaderContext:", "getCustomScoreProvider", "Lorg.apache.lucene.queries.CustomScoreProvider;", 0x4, "Ljava.io.IOException;", NULL },
    { "createWeightWithOrgApacheLuceneSearchIndexSearcher:withBoolean:", "createWeight", "Lorg.apache.lucene.search.Weight;", 0x1, "Ljava.io.IOException;", NULL },
    { "isStrict", NULL, "Z", 0x1, NULL, NULL },
    { "setStrictWithBoolean:", "setStrict", "V", 0x1, NULL, NULL },
    { "getSubQuery", NULL, "Lorg.apache.lucene.search.Query;", 0x1, NULL, NULL },
    { "getScoringQueries", NULL, "[Lorg.apache.lucene.search.Query;", 0x1, NULL, NULL },
    { "name", NULL, "Ljava.lang.String;", 0x1, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "subQuery_", NULL, 0x2, "Lorg.apache.lucene.search.Query;", NULL, NULL, .constantValue.asLong = 0 },
    { "scoringQueries_", NULL, 0x2, "[Lorg.apache.lucene.search.Query;", NULL, NULL, .constantValue.asLong = 0 },
    { "strict_", NULL, 0x2, "Z", NULL, NULL, .constantValue.asLong = 0 },
  };
  static const char *inner_classes[] = {"Lorg.apache.lucene.queries.CustomScoreQuery$CustomWeight;", "Lorg.apache.lucene.queries.CustomScoreQuery$CustomScorer;"};
  static const J2ObjcClassInfo _OrgApacheLuceneQueriesCustomScoreQuery = { 2, "CustomScoreQuery", "org.apache.lucene.queries", NULL, 0x1, 15, methods, 3, fields, 0, NULL, 2, inner_classes, NULL, NULL };
  return &_OrgApacheLuceneQueriesCustomScoreQuery;
}

@end

void OrgApacheLuceneQueriesCustomScoreQuery_initWithOrgApacheLuceneSearchQuery_(OrgApacheLuceneQueriesCustomScoreQuery *self, OrgApacheLuceneSearchQuery *subQuery) {
  OrgApacheLuceneQueriesCustomScoreQuery_initWithOrgApacheLuceneSearchQuery_withOrgApacheLuceneQueriesFunctionFunctionQueryArray_(self, subQuery, [IOSObjectArray arrayWithLength:0 type:OrgApacheLuceneQueriesFunctionFunctionQuery_class_()]);
}

OrgApacheLuceneQueriesCustomScoreQuery *new_OrgApacheLuceneQueriesCustomScoreQuery_initWithOrgApacheLuceneSearchQuery_(OrgApacheLuceneSearchQuery *subQuery) {
  OrgApacheLuceneQueriesCustomScoreQuery *self = [OrgApacheLuceneQueriesCustomScoreQuery alloc];
  OrgApacheLuceneQueriesCustomScoreQuery_initWithOrgApacheLuceneSearchQuery_(self, subQuery);
  return self;
}

void OrgApacheLuceneQueriesCustomScoreQuery_initWithOrgApacheLuceneSearchQuery_withOrgApacheLuceneQueriesFunctionFunctionQuery_(OrgApacheLuceneQueriesCustomScoreQuery *self, OrgApacheLuceneSearchQuery *subQuery, OrgApacheLuceneQueriesFunctionFunctionQuery *scoringQuery) {
  OrgApacheLuceneQueriesCustomScoreQuery_initWithOrgApacheLuceneSearchQuery_withOrgApacheLuceneQueriesFunctionFunctionQueryArray_(self, subQuery, scoringQuery != nil ? [IOSObjectArray arrayWithObjects:(id[]){ scoringQuery } count:1 type:OrgApacheLuceneQueriesFunctionFunctionQuery_class_()] : [IOSObjectArray arrayWithLength:0 type:OrgApacheLuceneQueriesFunctionFunctionQuery_class_()]);
}

OrgApacheLuceneQueriesCustomScoreQuery *new_OrgApacheLuceneQueriesCustomScoreQuery_initWithOrgApacheLuceneSearchQuery_withOrgApacheLuceneQueriesFunctionFunctionQuery_(OrgApacheLuceneSearchQuery *subQuery, OrgApacheLuceneQueriesFunctionFunctionQuery *scoringQuery) {
  OrgApacheLuceneQueriesCustomScoreQuery *self = [OrgApacheLuceneQueriesCustomScoreQuery alloc];
  OrgApacheLuceneQueriesCustomScoreQuery_initWithOrgApacheLuceneSearchQuery_withOrgApacheLuceneQueriesFunctionFunctionQuery_(self, subQuery, scoringQuery);
  return self;
}

void OrgApacheLuceneQueriesCustomScoreQuery_initWithOrgApacheLuceneSearchQuery_withOrgApacheLuceneQueriesFunctionFunctionQueryArray_(OrgApacheLuceneQueriesCustomScoreQuery *self, OrgApacheLuceneSearchQuery *subQuery, IOSObjectArray *scoringQueries) {
  OrgApacheLuceneSearchQuery_init(self);
  self->strict_ = NO;
  JreStrongAssign(&self->subQuery_, subQuery);
  JreStrongAssign(&self->scoringQueries_, scoringQueries != nil ? scoringQueries : [IOSObjectArray arrayWithLength:0 type:OrgApacheLuceneSearchQuery_class_()]);
  if (subQuery == nil) @throw [new_JavaLangIllegalArgumentException_initWithNSString_(@"<subquery> must not be null!") autorelease];
}

OrgApacheLuceneQueriesCustomScoreQuery *new_OrgApacheLuceneQueriesCustomScoreQuery_initWithOrgApacheLuceneSearchQuery_withOrgApacheLuceneQueriesFunctionFunctionQueryArray_(OrgApacheLuceneSearchQuery *subQuery, IOSObjectArray *scoringQueries) {
  OrgApacheLuceneQueriesCustomScoreQuery *self = [OrgApacheLuceneQueriesCustomScoreQuery alloc];
  OrgApacheLuceneQueriesCustomScoreQuery_initWithOrgApacheLuceneSearchQuery_withOrgApacheLuceneQueriesFunctionFunctionQueryArray_(self, subQuery, scoringQueries);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneQueriesCustomScoreQuery)

@implementation OrgApacheLuceneQueriesCustomScoreQuery_CustomWeight

- (instancetype)initWithOrgApacheLuceneQueriesCustomScoreQuery:(OrgApacheLuceneQueriesCustomScoreQuery *)outer$
                        withOrgApacheLuceneSearchIndexSearcher:(OrgApacheLuceneSearchIndexSearcher *)searcher
                                                   withBoolean:(jboolean)needsScores {
  OrgApacheLuceneQueriesCustomScoreQuery_CustomWeight_initWithOrgApacheLuceneQueriesCustomScoreQuery_withOrgApacheLuceneSearchIndexSearcher_withBoolean_(self, outer$, searcher, needsScores);
  return self;
}

- (void)extractTermsWithJavaUtilSet:(id<JavaUtilSet>)terms {
  [((OrgApacheLuceneSearchWeight *) nil_chk(subQueryWeight_)) extractTermsWithJavaUtilSet:terms];
  {
    IOSObjectArray *a__ = valSrcWeights_;
    OrgApacheLuceneSearchWeight * const *b__ = ((IOSObjectArray *) nil_chk(a__))->buffer_;
    OrgApacheLuceneSearchWeight * const *e__ = b__ + a__->size_;
    while (b__ < e__) {
      OrgApacheLuceneSearchWeight *scoringWeight = *b__++;
      [((OrgApacheLuceneSearchWeight *) nil_chk(scoringWeight)) extractTermsWithJavaUtilSet:terms];
    }
  }
}

- (jfloat)getValueForNormalization {
  jfloat sum = [((OrgApacheLuceneSearchWeight *) nil_chk(subQueryWeight_)) getValueForNormalization];
  {
    IOSObjectArray *a__ = valSrcWeights_;
    OrgApacheLuceneSearchWeight * const *b__ = ((IOSObjectArray *) nil_chk(a__))->buffer_;
    OrgApacheLuceneSearchWeight * const *e__ = b__ + a__->size_;
    while (b__ < e__) {
      OrgApacheLuceneSearchWeight *valSrcWeight = *b__++;
      if (qStrict_) {
        [((OrgApacheLuceneSearchWeight *) nil_chk(valSrcWeight)) getValueForNormalization];
      }
      else {
        JrePlusAssignFloatF(&sum, [((OrgApacheLuceneSearchWeight *) nil_chk(valSrcWeight)) getValueForNormalization]);
      }
    }
  }
  return sum;
}

- (void)normalizeWithFloat:(jfloat)norm
                 withFloat:(jfloat)topLevelBoost {
  [((OrgApacheLuceneSearchWeight *) nil_chk(subQueryWeight_)) normalizeWithFloat:norm withFloat:1.0f];
  {
    IOSObjectArray *a__ = valSrcWeights_;
    OrgApacheLuceneSearchWeight * const *b__ = ((IOSObjectArray *) nil_chk(a__))->buffer_;
    OrgApacheLuceneSearchWeight * const *e__ = b__ + a__->size_;
    while (b__ < e__) {
      OrgApacheLuceneSearchWeight *valSrcWeight = *b__++;
      if (qStrict_) {
        [((OrgApacheLuceneSearchWeight *) nil_chk(valSrcWeight)) normalizeWithFloat:1 withFloat:1];
      }
      else {
        [((OrgApacheLuceneSearchWeight *) nil_chk(valSrcWeight)) normalizeWithFloat:norm withFloat:1.0f];
      }
    }
  }
  queryWeight_ = topLevelBoost * [this$0_ getBoost];
}

- (OrgApacheLuceneSearchScorer *)scorerWithOrgApacheLuceneIndexLeafReaderContext:(OrgApacheLuceneIndexLeafReaderContext *)context {
  OrgApacheLuceneSearchScorer *subQueryScorer = [((OrgApacheLuceneSearchWeight *) nil_chk(subQueryWeight_)) scorerWithOrgApacheLuceneIndexLeafReaderContext:context];
  if (subQueryScorer == nil) {
    return nil;
  }
  IOSObjectArray *valSrcScorers = [IOSObjectArray arrayWithLength:((IOSObjectArray *) nil_chk(valSrcWeights_))->size_ type:OrgApacheLuceneSearchScorer_class_()];
  for (jint i = 0; i < valSrcScorers->size_; i++) {
    IOSObjectArray_Set(valSrcScorers, i, [((OrgApacheLuceneSearchWeight *) nil_chk(IOSObjectArray_Get(valSrcWeights_, i))) scorerWithOrgApacheLuceneIndexLeafReaderContext:context]);
  }
  return [new_OrgApacheLuceneQueriesCustomScoreQuery_CustomScorer_initWithOrgApacheLuceneQueriesCustomScoreQuery_withOrgApacheLuceneQueriesCustomScoreProvider_withOrgApacheLuceneQueriesCustomScoreQuery_CustomWeight_withFloat_withOrgApacheLuceneSearchScorer_withOrgApacheLuceneSearchScorerArray_(this$0_, [this$0_ getCustomScoreProviderWithOrgApacheLuceneIndexLeafReaderContext:context], self, queryWeight_, subQueryScorer, valSrcScorers) autorelease];
}

- (OrgApacheLuceneSearchExplanation *)explainWithOrgApacheLuceneIndexLeafReaderContext:(OrgApacheLuceneIndexLeafReaderContext *)context
                                                                               withInt:(jint)doc {
  OrgApacheLuceneSearchExplanation *explain = OrgApacheLuceneQueriesCustomScoreQuery_CustomWeight_doExplainWithOrgApacheLuceneIndexLeafReaderContext_withInt_(self, context, doc);
  return explain == nil ? OrgApacheLuceneSearchExplanation_noMatchWithNSString_withOrgApacheLuceneSearchExplanationArray_(@"no matching docs", [IOSObjectArray arrayWithLength:0 type:OrgApacheLuceneSearchExplanation_class_()]) : explain;
}

- (OrgApacheLuceneSearchExplanation *)doExplainWithOrgApacheLuceneIndexLeafReaderContext:(OrgApacheLuceneIndexLeafReaderContext *)info
                                                                                 withInt:(jint)doc {
  return OrgApacheLuceneQueriesCustomScoreQuery_CustomWeight_doExplainWithOrgApacheLuceneIndexLeafReaderContext_withInt_(self, info, doc);
}

- (void)dealloc {
  RELEASE_(this$0_);
  RELEASE_(subQueryWeight_);
  RELEASE_(valSrcWeights_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithOrgApacheLuceneQueriesCustomScoreQuery:withOrgApacheLuceneSearchIndexSearcher:withBoolean:", "CustomWeight", NULL, 0x1, NULL, NULL },
    { "extractTermsWithJavaUtilSet:", "extractTerms", "V", 0x1, NULL, NULL },
    { "getValueForNormalization", NULL, "F", 0x1, "Ljava.io.IOException;", NULL },
    { "normalizeWithFloat:withFloat:", "normalize", "V", 0x1, NULL, NULL },
    { "scorerWithOrgApacheLuceneIndexLeafReaderContext:", "scorer", "Lorg.apache.lucene.search.Scorer;", 0x1, "Ljava.io.IOException;", NULL },
    { "explainWithOrgApacheLuceneIndexLeafReaderContext:withInt:", "explain", "Lorg.apache.lucene.search.Explanation;", 0x1, "Ljava.io.IOException;", NULL },
    { "doExplainWithOrgApacheLuceneIndexLeafReaderContext:withInt:", "doExplain", "Lorg.apache.lucene.search.Explanation;", 0x2, "Ljava.io.IOException;", NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "this$0_", NULL, 0x1012, "Lorg.apache.lucene.queries.CustomScoreQuery;", NULL, NULL, .constantValue.asLong = 0 },
    { "subQueryWeight_", NULL, 0x0, "Lorg.apache.lucene.search.Weight;", NULL, NULL, .constantValue.asLong = 0 },
    { "valSrcWeights_", NULL, 0x0, "[Lorg.apache.lucene.search.Weight;", NULL, NULL, .constantValue.asLong = 0 },
    { "qStrict_", NULL, 0x0, "Z", NULL, NULL, .constantValue.asLong = 0 },
    { "queryWeight_", NULL, 0x0, "F", NULL, NULL, .constantValue.asLong = 0 },
  };
  static const J2ObjcClassInfo _OrgApacheLuceneQueriesCustomScoreQuery_CustomWeight = { 2, "CustomWeight", "org.apache.lucene.queries", "CustomScoreQuery", 0x2, 7, methods, 5, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_OrgApacheLuceneQueriesCustomScoreQuery_CustomWeight;
}

@end

void OrgApacheLuceneQueriesCustomScoreQuery_CustomWeight_initWithOrgApacheLuceneQueriesCustomScoreQuery_withOrgApacheLuceneSearchIndexSearcher_withBoolean_(OrgApacheLuceneQueriesCustomScoreQuery_CustomWeight *self, OrgApacheLuceneQueriesCustomScoreQuery *outer$, OrgApacheLuceneSearchIndexSearcher *searcher, jboolean needsScores) {
  JreStrongAssign(&self->this$0_, outer$);
  OrgApacheLuceneSearchWeight_initWithOrgApacheLuceneSearchQuery_(self, outer$);
  JreStrongAssign(&self->subQueryWeight_, [((OrgApacheLuceneSearchQuery *) nil_chk(outer$->subQuery_)) createWeightWithOrgApacheLuceneSearchIndexSearcher:searcher withBoolean:needsScores]);
  JreStrongAssignAndConsume(&self->valSrcWeights_, [IOSObjectArray newArrayWithLength:((IOSObjectArray *) nil_chk(outer$->scoringQueries_))->size_ type:OrgApacheLuceneSearchWeight_class_()]);
  for (jint i = 0; i < outer$->scoringQueries_->size_; i++) {
    IOSObjectArray_Set(self->valSrcWeights_, i, [((OrgApacheLuceneSearchQuery *) nil_chk(IOSObjectArray_Get(outer$->scoringQueries_, i))) createWeightWithOrgApacheLuceneSearchIndexSearcher:searcher withBoolean:needsScores]);
  }
  self->qStrict_ = outer$->strict_;
}

OrgApacheLuceneQueriesCustomScoreQuery_CustomWeight *new_OrgApacheLuceneQueriesCustomScoreQuery_CustomWeight_initWithOrgApacheLuceneQueriesCustomScoreQuery_withOrgApacheLuceneSearchIndexSearcher_withBoolean_(OrgApacheLuceneQueriesCustomScoreQuery *outer$, OrgApacheLuceneSearchIndexSearcher *searcher, jboolean needsScores) {
  OrgApacheLuceneQueriesCustomScoreQuery_CustomWeight *self = [OrgApacheLuceneQueriesCustomScoreQuery_CustomWeight alloc];
  OrgApacheLuceneQueriesCustomScoreQuery_CustomWeight_initWithOrgApacheLuceneQueriesCustomScoreQuery_withOrgApacheLuceneSearchIndexSearcher_withBoolean_(self, outer$, searcher, needsScores);
  return self;
}

OrgApacheLuceneSearchExplanation *OrgApacheLuceneQueriesCustomScoreQuery_CustomWeight_doExplainWithOrgApacheLuceneIndexLeafReaderContext_withInt_(OrgApacheLuceneQueriesCustomScoreQuery_CustomWeight *self, OrgApacheLuceneIndexLeafReaderContext *info, jint doc) {
  OrgApacheLuceneSearchExplanation *subQueryExpl = [((OrgApacheLuceneSearchWeight *) nil_chk(self->subQueryWeight_)) explainWithOrgApacheLuceneIndexLeafReaderContext:info withInt:doc];
  if (![((OrgApacheLuceneSearchExplanation *) nil_chk(subQueryExpl)) isMatch]) {
    return subQueryExpl;
  }
  IOSObjectArray *valSrcExpls = [IOSObjectArray arrayWithLength:((IOSObjectArray *) nil_chk(self->valSrcWeights_))->size_ type:OrgApacheLuceneSearchExplanation_class_()];
  for (jint i = 0; i < self->valSrcWeights_->size_; i++) {
    IOSObjectArray_Set(valSrcExpls, i, [((OrgApacheLuceneSearchWeight *) nil_chk(IOSObjectArray_Get(self->valSrcWeights_, i))) explainWithOrgApacheLuceneIndexLeafReaderContext:info withInt:doc]);
  }
  OrgApacheLuceneSearchExplanation *customExp = [((OrgApacheLuceneQueriesCustomScoreProvider *) nil_chk([self->this$0_ getCustomScoreProviderWithOrgApacheLuceneIndexLeafReaderContext:info])) customExplainWithInt:doc withOrgApacheLuceneSearchExplanation:subQueryExpl withOrgApacheLuceneSearchExplanationArray:valSrcExpls];
  jfloat sc = self->queryWeight_ * [((OrgApacheLuceneSearchExplanation *) nil_chk(customExp)) getValue];
  return OrgApacheLuceneSearchExplanation_matchWithFloat_withNSString_withOrgApacheLuceneSearchExplanationArray_(sc, JreStrcat("$$", [self->this$0_ description], @", product of:"), [IOSObjectArray arrayWithObjects:(id[]){ customExp, OrgApacheLuceneSearchExplanation_matchWithFloat_withNSString_withOrgApacheLuceneSearchExplanationArray_(self->queryWeight_, @"queryWeight", [IOSObjectArray arrayWithLength:0 type:OrgApacheLuceneSearchExplanation_class_()]) } count:2 type:OrgApacheLuceneSearchExplanation_class_()]);
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneQueriesCustomScoreQuery_CustomWeight)

@implementation OrgApacheLuceneQueriesCustomScoreQuery_CustomScorer

- (instancetype)initWithOrgApacheLuceneQueriesCustomScoreQuery:(OrgApacheLuceneQueriesCustomScoreQuery *)outer$
                 withOrgApacheLuceneQueriesCustomScoreProvider:(OrgApacheLuceneQueriesCustomScoreProvider *)provider
       withOrgApacheLuceneQueriesCustomScoreQuery_CustomWeight:(OrgApacheLuceneQueriesCustomScoreQuery_CustomWeight *)w
                                                     withFloat:(jfloat)qWeight
                               withOrgApacheLuceneSearchScorer:(OrgApacheLuceneSearchScorer *)subQueryScorer
                          withOrgApacheLuceneSearchScorerArray:(IOSObjectArray *)valSrcScorers {
  OrgApacheLuceneQueriesCustomScoreQuery_CustomScorer_initWithOrgApacheLuceneQueriesCustomScoreQuery_withOrgApacheLuceneQueriesCustomScoreProvider_withOrgApacheLuceneQueriesCustomScoreQuery_CustomWeight_withFloat_withOrgApacheLuceneSearchScorer_withOrgApacheLuceneSearchScorerArray_(self, outer$, provider, w, qWeight, subQueryScorer, valSrcScorers);
  return self;
}

- (jfloat)score {
  jint doc = [self docID];
  if (doc > valSrcDocID_) {
    {
      IOSObjectArray *a__ = valSrcScorers_;
      OrgApacheLuceneSearchScorer * const *b__ = ((IOSObjectArray *) nil_chk(a__))->buffer_;
      OrgApacheLuceneSearchScorer * const *e__ = b__ + a__->size_;
      while (b__ < e__) {
        OrgApacheLuceneSearchScorer *valSrcScorer = *b__++;
        [((OrgApacheLuceneSearchScorer *) nil_chk(valSrcScorer)) advanceWithInt:doc];
      }
    }
    valSrcDocID_ = doc;
  }
  for (jint i = 0; i < ((IOSObjectArray *) nil_chk(valSrcScorers_))->size_; i++) {
    *IOSFloatArray_GetRef(nil_chk(vScores_), i) = [((OrgApacheLuceneSearchScorer *) nil_chk(IOSObjectArray_Get(valSrcScorers_, i))) score];
  }
  return qWeight_ * [((OrgApacheLuceneQueriesCustomScoreProvider *) nil_chk(provider_)) customScoreWithInt:[((OrgApacheLuceneSearchScorer *) nil_chk(subQueryScorer_)) docID] withFloat:[subQueryScorer_ score] withFloatArray:vScores_];
}

- (id<JavaUtilCollection>)getChildren {
  return JavaUtilCollections_singletonWithId_([new_OrgApacheLuceneSearchScorer_ChildScorer_initWithOrgApacheLuceneSearchScorer_withNSString_(subQueryScorer_, @"CUSTOM") autorelease]);
}

- (void)dealloc {
  RELEASE_(subQueryScorer_);
  RELEASE_(valSrcScorers_);
  RELEASE_(provider_);
  RELEASE_(vScores_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithOrgApacheLuceneQueriesCustomScoreQuery:withOrgApacheLuceneQueriesCustomScoreProvider:withOrgApacheLuceneQueriesCustomScoreQuery_CustomWeight:withFloat:withOrgApacheLuceneSearchScorer:withOrgApacheLuceneSearchScorerArray:", "CustomScorer", NULL, 0x2, NULL, NULL },
    { "score", NULL, "F", 0x1, "Ljava.io.IOException;", NULL },
    { "getChildren", NULL, "Ljava.util.Collection;", 0x1, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "qWeight_", NULL, 0x12, "F", NULL, NULL, .constantValue.asLong = 0 },
    { "subQueryScorer_", NULL, 0x12, "Lorg.apache.lucene.search.Scorer;", NULL, NULL, .constantValue.asLong = 0 },
    { "valSrcScorers_", NULL, 0x12, "[Lorg.apache.lucene.search.Scorer;", NULL, NULL, .constantValue.asLong = 0 },
    { "provider_", NULL, 0x12, "Lorg.apache.lucene.queries.CustomScoreProvider;", NULL, NULL, .constantValue.asLong = 0 },
    { "vScores_", NULL, 0x12, "[F", NULL, NULL, .constantValue.asLong = 0 },
    { "valSrcDocID_", NULL, 0x2, "I", NULL, NULL, .constantValue.asLong = 0 },
  };
  static const J2ObjcClassInfo _OrgApacheLuceneQueriesCustomScoreQuery_CustomScorer = { 2, "CustomScorer", "org.apache.lucene.queries", "CustomScoreQuery", 0x2, 3, methods, 6, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_OrgApacheLuceneQueriesCustomScoreQuery_CustomScorer;
}

@end

void OrgApacheLuceneQueriesCustomScoreQuery_CustomScorer_initWithOrgApacheLuceneQueriesCustomScoreQuery_withOrgApacheLuceneQueriesCustomScoreProvider_withOrgApacheLuceneQueriesCustomScoreQuery_CustomWeight_withFloat_withOrgApacheLuceneSearchScorer_withOrgApacheLuceneSearchScorerArray_(OrgApacheLuceneQueriesCustomScoreQuery_CustomScorer *self, OrgApacheLuceneQueriesCustomScoreQuery *outer$, OrgApacheLuceneQueriesCustomScoreProvider *provider, OrgApacheLuceneQueriesCustomScoreQuery_CustomWeight *w, jfloat qWeight, OrgApacheLuceneSearchScorer *subQueryScorer, IOSObjectArray *valSrcScorers) {
  OrgApacheLuceneSearchFilterScorer_initWithOrgApacheLuceneSearchScorer_withOrgApacheLuceneSearchWeight_(self, subQueryScorer, w);
  self->valSrcDocID_ = -1;
  self->qWeight_ = qWeight;
  JreStrongAssign(&self->subQueryScorer_, subQueryScorer);
  JreStrongAssign(&self->valSrcScorers_, valSrcScorers);
  JreStrongAssignAndConsume(&self->vScores_, [IOSFloatArray newArrayWithLength:((IOSObjectArray *) nil_chk(valSrcScorers))->size_]);
  JreStrongAssign(&self->provider_, provider);
}

OrgApacheLuceneQueriesCustomScoreQuery_CustomScorer *new_OrgApacheLuceneQueriesCustomScoreQuery_CustomScorer_initWithOrgApacheLuceneQueriesCustomScoreQuery_withOrgApacheLuceneQueriesCustomScoreProvider_withOrgApacheLuceneQueriesCustomScoreQuery_CustomWeight_withFloat_withOrgApacheLuceneSearchScorer_withOrgApacheLuceneSearchScorerArray_(OrgApacheLuceneQueriesCustomScoreQuery *outer$, OrgApacheLuceneQueriesCustomScoreProvider *provider, OrgApacheLuceneQueriesCustomScoreQuery_CustomWeight *w, jfloat qWeight, OrgApacheLuceneSearchScorer *subQueryScorer, IOSObjectArray *valSrcScorers) {
  OrgApacheLuceneQueriesCustomScoreQuery_CustomScorer *self = [OrgApacheLuceneQueriesCustomScoreQuery_CustomScorer alloc];
  OrgApacheLuceneQueriesCustomScoreQuery_CustomScorer_initWithOrgApacheLuceneQueriesCustomScoreQuery_withOrgApacheLuceneQueriesCustomScoreProvider_withOrgApacheLuceneQueriesCustomScoreQuery_CustomWeight_withFloat_withOrgApacheLuceneSearchScorer_withOrgApacheLuceneSearchScorerArray_(self, outer$, provider, w, qWeight, subQueryScorer, valSrcScorers);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneQueriesCustomScoreQuery_CustomScorer)
