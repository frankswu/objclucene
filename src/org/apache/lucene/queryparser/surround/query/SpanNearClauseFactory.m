//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: ./queryparser/src/java/org/apache/lucene/queryparser/surround/query/SpanNearClauseFactory.java
//

#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "J2ObjC_source.h"
#include "java/io/IOException.h"
#include "java/lang/AssertionError.h"
#include "java/lang/Float.h"
#include "java/util/HashMap.h"
#include "java/util/Iterator.h"
#include "java/util/Set.h"
#include "org/apache/lucene/index/IndexReader.h"
#include "org/apache/lucene/index/Term.h"
#include "org/apache/lucene/queryparser/surround/query/BasicQueryFactory.h"
#include "org/apache/lucene/queryparser/surround/query/SpanNearClauseFactory.h"
#include "org/apache/lucene/search/MatchNoDocsQuery.h"
#include "org/apache/lucene/search/Query.h"
#include "org/apache/lucene/search/spans/SpanOrQuery.h"
#include "org/apache/lucene/search/spans/SpanQuery.h"
#include "org/apache/lucene/search/spans/SpanTermQuery.h"

@interface OrgApacheLuceneQueryparserSurroundQuerySpanNearClauseFactory () {
 @public
  OrgApacheLuceneIndexIndexReader *reader_;
  NSString *fieldName_;
  JavaUtilHashMap *weightBySpanQuery_;
  OrgApacheLuceneQueryparserSurroundQueryBasicQueryFactory *qf_;
}

@end

J2OBJC_FIELD_SETTER(OrgApacheLuceneQueryparserSurroundQuerySpanNearClauseFactory, reader_, OrgApacheLuceneIndexIndexReader *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneQueryparserSurroundQuerySpanNearClauseFactory, fieldName_, NSString *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneQueryparserSurroundQuerySpanNearClauseFactory, weightBySpanQuery_, JavaUtilHashMap *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneQueryparserSurroundQuerySpanNearClauseFactory, qf_, OrgApacheLuceneQueryparserSurroundQueryBasicQueryFactory *)

@implementation OrgApacheLuceneQueryparserSurroundQuerySpanNearClauseFactory

- (instancetype)initWithOrgApacheLuceneIndexIndexReader:(OrgApacheLuceneIndexIndexReader *)reader
                                           withNSString:(NSString *)fieldName
withOrgApacheLuceneQueryparserSurroundQueryBasicQueryFactory:(OrgApacheLuceneQueryparserSurroundQueryBasicQueryFactory *)qf {
  OrgApacheLuceneQueryparserSurroundQuerySpanNearClauseFactory_initWithOrgApacheLuceneIndexIndexReader_withNSString_withOrgApacheLuceneQueryparserSurroundQueryBasicQueryFactory_(self, reader, fieldName, qf);
  return self;
}

- (OrgApacheLuceneIndexIndexReader *)getIndexReader {
  return reader_;
}

- (NSString *)getFieldName {
  return fieldName_;
}

- (OrgApacheLuceneQueryparserSurroundQueryBasicQueryFactory *)getBasicQueryFactory {
  return qf_;
}

- (jint)size {
  return [((JavaUtilHashMap *) nil_chk(weightBySpanQuery_)) size];
}

- (void)clear {
  [((JavaUtilHashMap *) nil_chk(weightBySpanQuery_)) clear];
}

- (void)addSpanQueryWeightedWithOrgApacheLuceneSearchSpansSpanQuery:(OrgApacheLuceneSearchSpansSpanQuery *)sq
                                                          withFloat:(jfloat)weight {
  JavaLangFloat *w = [((JavaUtilHashMap *) nil_chk(weightBySpanQuery_)) getWithId:sq];
  if (w != nil) w = JavaLangFloat_valueOfWithFloat_([w floatValue] + weight);
  else w = JavaLangFloat_valueOfWithFloat_(weight);
  [((JavaUtilHashMap *) nil_chk(weightBySpanQuery_)) putWithId:sq withId:w];
}

- (void)addTermWeightedWithOrgApacheLuceneIndexTerm:(OrgApacheLuceneIndexTerm *)t
                                          withFloat:(jfloat)weight {
  OrgApacheLuceneSearchSpansSpanTermQuery *stq = [((OrgApacheLuceneQueryparserSurroundQueryBasicQueryFactory *) nil_chk(qf_)) newSpanTermQueryWithOrgApacheLuceneIndexTerm:t];
  [self addSpanQueryWeightedWithOrgApacheLuceneSearchSpansSpanQuery:stq withFloat:weight];
}

- (void)addSpanQueryWithOrgApacheLuceneSearchQuery:(OrgApacheLuceneSearchQuery *)q {
  if ([((OrgApacheLuceneSearchQuery *) nil_chk(q)) getClass] == (id) OrgApacheLuceneSearchMatchNoDocsQuery_class_()) return;
  if (!([q isKindOfClass:[OrgApacheLuceneSearchSpansSpanQuery class]])) @throw create_JavaLangAssertionError_initWithId_(JreStrcat("$$", @"Expected SpanQuery: ", [q toStringWithNSString:[self getFieldName]]));
  [self addSpanQueryWeightedWithOrgApacheLuceneSearchSpansSpanQuery:(OrgApacheLuceneSearchSpansSpanQuery *) cast_chk(q, [OrgApacheLuceneSearchSpansSpanQuery class]) withFloat:[q getBoost]];
}

- (OrgApacheLuceneSearchSpansSpanQuery *)makeSpanClause {
  IOSObjectArray *spanQueries = [IOSObjectArray arrayWithLength:[self size] type:OrgApacheLuceneSearchSpansSpanQuery_class_()];
  id<JavaUtilIterator> sqi = [((id<JavaUtilSet>) nil_chk([((JavaUtilHashMap *) nil_chk(weightBySpanQuery_)) keySet])) iterator];
  jint i = 0;
  while ([((id<JavaUtilIterator>) nil_chk(sqi)) hasNext]) {
    OrgApacheLuceneSearchSpansSpanQuery *sq = [sqi next];
    [((OrgApacheLuceneSearchSpansSpanQuery *) nil_chk(sq)) setBoostWithFloat:[((JavaLangFloat *) nil_chk([((JavaUtilHashMap *) nil_chk(weightBySpanQuery_)) getWithId:sq])) floatValue]];
    IOSObjectArray_Set(spanQueries, i++, sq);
  }
  if (spanQueries->size_ == 1) return IOSObjectArray_Get(spanQueries, 0);
  else return create_OrgApacheLuceneSearchSpansSpanOrQuery_initWithOrgApacheLuceneSearchSpansSpanQueryArray_(spanQueries);
}

- (void)dealloc {
  RELEASE_(reader_);
  RELEASE_(fieldName_);
  RELEASE_(weightBySpanQuery_);
  RELEASE_(qf_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithOrgApacheLuceneIndexIndexReader:withNSString:withOrgApacheLuceneQueryparserSurroundQueryBasicQueryFactory:", "SpanNearClauseFactory", NULL, 0x1, NULL, NULL },
    { "getIndexReader", NULL, "Lorg.apache.lucene.index.IndexReader;", 0x1, NULL, NULL },
    { "getFieldName", NULL, "Ljava.lang.String;", 0x1, NULL, NULL },
    { "getBasicQueryFactory", NULL, "Lorg.apache.lucene.queryparser.surround.query.BasicQueryFactory;", 0x1, NULL, NULL },
    { "size", NULL, "I", 0x1, NULL, NULL },
    { "clear", NULL, "V", 0x1, NULL, NULL },
    { "addSpanQueryWeightedWithOrgApacheLuceneSearchSpansSpanQuery:withFloat:", "addSpanQueryWeighted", "V", 0x4, NULL, NULL },
    { "addTermWeightedWithOrgApacheLuceneIndexTerm:withFloat:", "addTermWeighted", "V", 0x1, "Ljava.io.IOException;", NULL },
    { "addSpanQueryWithOrgApacheLuceneSearchQuery:", "addSpanQuery", "V", 0x1, NULL, NULL },
    { "makeSpanClause", NULL, "Lorg.apache.lucene.search.spans.SpanQuery;", 0x1, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "reader_", NULL, 0x2, "Lorg.apache.lucene.index.IndexReader;", NULL, NULL, .constantValue.asLong = 0 },
    { "fieldName_", NULL, 0x2, "Ljava.lang.String;", NULL, NULL, .constantValue.asLong = 0 },
    { "weightBySpanQuery_", NULL, 0x2, "Ljava.util.HashMap;", NULL, "Ljava/util/HashMap<Lorg/apache/lucene/search/spans/SpanQuery;Ljava/lang/Float;>;", .constantValue.asLong = 0 },
    { "qf_", NULL, 0x2, "Lorg.apache.lucene.queryparser.surround.query.BasicQueryFactory;", NULL, NULL, .constantValue.asLong = 0 },
  };
  static const J2ObjcClassInfo _OrgApacheLuceneQueryparserSurroundQuerySpanNearClauseFactory = { 2, "SpanNearClauseFactory", "org.apache.lucene.queryparser.surround.query", NULL, 0x1, 10, methods, 4, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_OrgApacheLuceneQueryparserSurroundQuerySpanNearClauseFactory;
}

@end

void OrgApacheLuceneQueryparserSurroundQuerySpanNearClauseFactory_initWithOrgApacheLuceneIndexIndexReader_withNSString_withOrgApacheLuceneQueryparserSurroundQueryBasicQueryFactory_(OrgApacheLuceneQueryparserSurroundQuerySpanNearClauseFactory *self, OrgApacheLuceneIndexIndexReader *reader, NSString *fieldName, OrgApacheLuceneQueryparserSurroundQueryBasicQueryFactory *qf) {
  NSObject_init(self);
  JreStrongAssign(&self->reader_, reader);
  JreStrongAssign(&self->fieldName_, fieldName);
  JreStrongAssignAndConsume(&self->weightBySpanQuery_, new_JavaUtilHashMap_init());
  JreStrongAssign(&self->qf_, qf);
}

OrgApacheLuceneQueryparserSurroundQuerySpanNearClauseFactory *new_OrgApacheLuceneQueryparserSurroundQuerySpanNearClauseFactory_initWithOrgApacheLuceneIndexIndexReader_withNSString_withOrgApacheLuceneQueryparserSurroundQueryBasicQueryFactory_(OrgApacheLuceneIndexIndexReader *reader, NSString *fieldName, OrgApacheLuceneQueryparserSurroundQueryBasicQueryFactory *qf) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneQueryparserSurroundQuerySpanNearClauseFactory, initWithOrgApacheLuceneIndexIndexReader_withNSString_withOrgApacheLuceneQueryparserSurroundQueryBasicQueryFactory_, reader, fieldName, qf)
}

OrgApacheLuceneQueryparserSurroundQuerySpanNearClauseFactory *create_OrgApacheLuceneQueryparserSurroundQuerySpanNearClauseFactory_initWithOrgApacheLuceneIndexIndexReader_withNSString_withOrgApacheLuceneQueryparserSurroundQueryBasicQueryFactory_(OrgApacheLuceneIndexIndexReader *reader, NSString *fieldName, OrgApacheLuceneQueryparserSurroundQueryBasicQueryFactory *qf) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneQueryparserSurroundQuerySpanNearClauseFactory, initWithOrgApacheLuceneIndexIndexReader_withNSString_withOrgApacheLuceneQueryparserSurroundQueryBasicQueryFactory_, reader, fieldName, qf)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneQueryparserSurroundQuerySpanNearClauseFactory)
