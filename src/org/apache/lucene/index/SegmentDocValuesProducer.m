//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: ./core/src/java/org/apache/lucene/index/SegmentDocValuesProducer.java
//

#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "J2ObjC_source.h"
#include "java/io/IOException.h"
#include "java/lang/Long.h"
#include "java/lang/Throwable.h"
#include "java/lang/UnsupportedOperationException.h"
#include "java/util/ArrayList.h"
#include "java/util/Collection.h"
#include "java/util/Collections.h"
#include "java/util/HashMap.h"
#include "java/util/IdentityHashMap.h"
#include "java/util/List.h"
#include "java/util/Map.h"
#include "java/util/Set.h"
#include "org/apache/lucene/codecs/DocValuesProducer.h"
#include "org/apache/lucene/index/BinaryDocValues.h"
#include "org/apache/lucene/index/DocValuesType.h"
#include "org/apache/lucene/index/FieldInfo.h"
#include "org/apache/lucene/index/FieldInfos.h"
#include "org/apache/lucene/index/NumericDocValues.h"
#include "org/apache/lucene/index/SegmentCommitInfo.h"
#include "org/apache/lucene/index/SegmentDocValues.h"
#include "org/apache/lucene/index/SegmentDocValuesProducer.h"
#include "org/apache/lucene/index/SegmentInfo.h"
#include "org/apache/lucene/index/SortedDocValues.h"
#include "org/apache/lucene/index/SortedNumericDocValues.h"
#include "org/apache/lucene/index/SortedSetDocValues.h"
#include "org/apache/lucene/store/Directory.h"
#include "org/apache/lucene/util/Accountable.h"
#include "org/apache/lucene/util/Accountables.h"
#include "org/apache/lucene/util/Bits.h"
#include "org/apache/lucene/util/RamUsageEstimator.h"
#include "org/apache/lucene/util/Version.h"

static jlong OrgApacheLuceneIndexSegmentDocValuesProducer_LONG_RAM_BYTES_USED_;
J2OBJC_STATIC_FIELD_GETTER(OrgApacheLuceneIndexSegmentDocValuesProducer, LONG_RAM_BYTES_USED_, jlong)

static jlong OrgApacheLuceneIndexSegmentDocValuesProducer_BASE_RAM_BYTES_USED_;
J2OBJC_STATIC_FIELD_GETTER(OrgApacheLuceneIndexSegmentDocValuesProducer, BASE_RAM_BYTES_USED_, jlong)

J2OBJC_INITIALIZED_DEFN(OrgApacheLuceneIndexSegmentDocValuesProducer)

@implementation OrgApacheLuceneIndexSegmentDocValuesProducer

- (instancetype)initWithOrgApacheLuceneIndexSegmentCommitInfo:(OrgApacheLuceneIndexSegmentCommitInfo *)si
                            withOrgApacheLuceneStoreDirectory:(OrgApacheLuceneStoreDirectory *)dir
                           withOrgApacheLuceneIndexFieldInfos:(OrgApacheLuceneIndexFieldInfos *)coreInfos
                           withOrgApacheLuceneIndexFieldInfos:(OrgApacheLuceneIndexFieldInfos *)allInfos
                     withOrgApacheLuceneIndexSegmentDocValues:(OrgApacheLuceneIndexSegmentDocValues *)segDocValues {
  OrgApacheLuceneIndexSegmentDocValuesProducer_initWithOrgApacheLuceneIndexSegmentCommitInfo_withOrgApacheLuceneStoreDirectory_withOrgApacheLuceneIndexFieldInfos_withOrgApacheLuceneIndexFieldInfos_withOrgApacheLuceneIndexSegmentDocValues_(self, si, dir, coreInfos, allInfos, segDocValues);
  return self;
}

- (OrgApacheLuceneIndexNumericDocValues *)getNumericWithOrgApacheLuceneIndexFieldInfo:(OrgApacheLuceneIndexFieldInfo *)field {
  OrgApacheLuceneCodecsDocValuesProducer *dvProducer = [((id<JavaUtilMap>) nil_chk(dvProducersByField_)) getWithId:((OrgApacheLuceneIndexFieldInfo *) nil_chk(field))->name_];
  JreAssert((dvProducer != nil), (@"org/apache/lucene/index/SegmentDocValuesProducer.java:137 condition failed: assert dvProducer != null;"));
  return [((OrgApacheLuceneCodecsDocValuesProducer *) nil_chk(dvProducer)) getNumericWithOrgApacheLuceneIndexFieldInfo:field];
}

- (OrgApacheLuceneIndexBinaryDocValues *)getBinaryWithOrgApacheLuceneIndexFieldInfo:(OrgApacheLuceneIndexFieldInfo *)field {
  OrgApacheLuceneCodecsDocValuesProducer *dvProducer = [((id<JavaUtilMap>) nil_chk(dvProducersByField_)) getWithId:((OrgApacheLuceneIndexFieldInfo *) nil_chk(field))->name_];
  JreAssert((dvProducer != nil), (@"org/apache/lucene/index/SegmentDocValuesProducer.java:144 condition failed: assert dvProducer != null;"));
  return [((OrgApacheLuceneCodecsDocValuesProducer *) nil_chk(dvProducer)) getBinaryWithOrgApacheLuceneIndexFieldInfo:field];
}

- (OrgApacheLuceneIndexSortedDocValues *)getSortedWithOrgApacheLuceneIndexFieldInfo:(OrgApacheLuceneIndexFieldInfo *)field {
  OrgApacheLuceneCodecsDocValuesProducer *dvProducer = [((id<JavaUtilMap>) nil_chk(dvProducersByField_)) getWithId:((OrgApacheLuceneIndexFieldInfo *) nil_chk(field))->name_];
  JreAssert((dvProducer != nil), (@"org/apache/lucene/index/SegmentDocValuesProducer.java:151 condition failed: assert dvProducer != null;"));
  return [((OrgApacheLuceneCodecsDocValuesProducer *) nil_chk(dvProducer)) getSortedWithOrgApacheLuceneIndexFieldInfo:field];
}

- (OrgApacheLuceneIndexSortedNumericDocValues *)getSortedNumericWithOrgApacheLuceneIndexFieldInfo:(OrgApacheLuceneIndexFieldInfo *)field {
  OrgApacheLuceneCodecsDocValuesProducer *dvProducer = [((id<JavaUtilMap>) nil_chk(dvProducersByField_)) getWithId:((OrgApacheLuceneIndexFieldInfo *) nil_chk(field))->name_];
  JreAssert((dvProducer != nil), (@"org/apache/lucene/index/SegmentDocValuesProducer.java:158 condition failed: assert dvProducer != null;"));
  return [((OrgApacheLuceneCodecsDocValuesProducer *) nil_chk(dvProducer)) getSortedNumericWithOrgApacheLuceneIndexFieldInfo:field];
}

- (OrgApacheLuceneIndexSortedSetDocValues *)getSortedSetWithOrgApacheLuceneIndexFieldInfo:(OrgApacheLuceneIndexFieldInfo *)field {
  OrgApacheLuceneCodecsDocValuesProducer *dvProducer = [((id<JavaUtilMap>) nil_chk(dvProducersByField_)) getWithId:((OrgApacheLuceneIndexFieldInfo *) nil_chk(field))->name_];
  JreAssert((dvProducer != nil), (@"org/apache/lucene/index/SegmentDocValuesProducer.java:165 condition failed: assert dvProducer != null;"));
  return [((OrgApacheLuceneCodecsDocValuesProducer *) nil_chk(dvProducer)) getSortedSetWithOrgApacheLuceneIndexFieldInfo:field];
}

- (id<OrgApacheLuceneUtilBits>)getDocsWithFieldWithOrgApacheLuceneIndexFieldInfo:(OrgApacheLuceneIndexFieldInfo *)field {
  OrgApacheLuceneCodecsDocValuesProducer *dvProducer = [((id<JavaUtilMap>) nil_chk(dvProducersByField_)) getWithId:((OrgApacheLuceneIndexFieldInfo *) nil_chk(field))->name_];
  JreAssert((dvProducer != nil), (@"org/apache/lucene/index/SegmentDocValuesProducer.java:172 condition failed: assert dvProducer != null;"));
  return [((OrgApacheLuceneCodecsDocValuesProducer *) nil_chk(dvProducer)) getDocsWithFieldWithOrgApacheLuceneIndexFieldInfo:field];
}

- (void)checkIntegrity {
  for (OrgApacheLuceneCodecsDocValuesProducer * __strong producer in nil_chk(dvProducers_)) {
    [((OrgApacheLuceneCodecsDocValuesProducer *) nil_chk(producer)) checkIntegrity];
  }
}

- (void)close {
  @throw [new_JavaLangUnsupportedOperationException_init() autorelease];
}

- (jlong)ramBytesUsed {
  jlong ramBytesUsed = OrgApacheLuceneIndexSegmentDocValuesProducer_BASE_RAM_BYTES_USED_;
  ramBytesUsed += [((id<JavaUtilList>) nil_chk(dvGens_)) size] * OrgApacheLuceneIndexSegmentDocValuesProducer_LONG_RAM_BYTES_USED_;
  ramBytesUsed += [((id<JavaUtilSet>) nil_chk(dvProducers_)) size] * JreLoadStatic(OrgApacheLuceneUtilRamUsageEstimator, NUM_BYTES_OBJECT_REF_);
  ramBytesUsed += [((id<JavaUtilMap>) nil_chk(dvProducersByField_)) size] * 2 * JreLoadStatic(OrgApacheLuceneUtilRamUsageEstimator, NUM_BYTES_OBJECT_REF_);
  for (OrgApacheLuceneCodecsDocValuesProducer * __strong producer in dvProducers_) {
    ramBytesUsed += [((OrgApacheLuceneCodecsDocValuesProducer *) nil_chk(producer)) ramBytesUsed];
  }
  return ramBytesUsed;
}

- (id<JavaUtilCollection>)getChildResources {
  id<JavaUtilList> resources = [new_JavaUtilArrayList_init() autorelease];
  for (id<OrgApacheLuceneUtilAccountable> __strong producer in nil_chk(dvProducers_)) {
    [resources addWithId:OrgApacheLuceneUtilAccountables_namedAccountableWithNSString_withOrgApacheLuceneUtilAccountable_(@"delegate", producer)];
  }
  return JavaUtilCollections_unmodifiableListWithJavaUtilList_(resources);
}

- (NSString *)description {
  return JreStrcat("$$IC", [[self getClass] getSimpleName], @"(producers=", [((id<JavaUtilSet>) nil_chk(dvProducers_)) size], ')');
}

- (void)dealloc {
  RELEASE_(dvProducersByField_);
  RELEASE_(dvProducers_);
  RELEASE_(dvGens_);
  [super dealloc];
}

+ (void)initialize {
  if (self == [OrgApacheLuceneIndexSegmentDocValuesProducer class]) {
    OrgApacheLuceneIndexSegmentDocValuesProducer_LONG_RAM_BYTES_USED_ = OrgApacheLuceneUtilRamUsageEstimator_shallowSizeOfInstanceWithIOSClass_(JavaLangLong_class_());
    OrgApacheLuceneIndexSegmentDocValuesProducer_BASE_RAM_BYTES_USED_ = OrgApacheLuceneUtilRamUsageEstimator_shallowSizeOfInstanceWithIOSClass_(OrgApacheLuceneIndexSegmentDocValuesProducer_class_());
    J2OBJC_SET_INITIALIZED(OrgApacheLuceneIndexSegmentDocValuesProducer)
  }
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithOrgApacheLuceneIndexSegmentCommitInfo:withOrgApacheLuceneStoreDirectory:withOrgApacheLuceneIndexFieldInfos:withOrgApacheLuceneIndexFieldInfos:withOrgApacheLuceneIndexSegmentDocValues:", "SegmentDocValuesProducer", NULL, 0x0, "Ljava.io.IOException;", NULL },
    { "getNumericWithOrgApacheLuceneIndexFieldInfo:", "getNumeric", "Lorg.apache.lucene.index.NumericDocValues;", 0x1, "Ljava.io.IOException;", NULL },
    { "getBinaryWithOrgApacheLuceneIndexFieldInfo:", "getBinary", "Lorg.apache.lucene.index.BinaryDocValues;", 0x1, "Ljava.io.IOException;", NULL },
    { "getSortedWithOrgApacheLuceneIndexFieldInfo:", "getSorted", "Lorg.apache.lucene.index.SortedDocValues;", 0x1, "Ljava.io.IOException;", NULL },
    { "getSortedNumericWithOrgApacheLuceneIndexFieldInfo:", "getSortedNumeric", "Lorg.apache.lucene.index.SortedNumericDocValues;", 0x1, "Ljava.io.IOException;", NULL },
    { "getSortedSetWithOrgApacheLuceneIndexFieldInfo:", "getSortedSet", "Lorg.apache.lucene.index.SortedSetDocValues;", 0x1, "Ljava.io.IOException;", NULL },
    { "getDocsWithFieldWithOrgApacheLuceneIndexFieldInfo:", "getDocsWithField", "Lorg.apache.lucene.util.Bits;", 0x1, "Ljava.io.IOException;", NULL },
    { "checkIntegrity", NULL, "V", 0x1, "Ljava.io.IOException;", NULL },
    { "close", NULL, "V", 0x1, "Ljava.io.IOException;", NULL },
    { "ramBytesUsed", NULL, "J", 0x1, NULL, NULL },
    { "getChildResources", NULL, "Ljava.util.Collection;", 0x1, NULL, NULL },
    { "description", "toString", "Ljava.lang.String;", 0x1, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "LONG_RAM_BYTES_USED_", NULL, 0x1a, "J", &OrgApacheLuceneIndexSegmentDocValuesProducer_LONG_RAM_BYTES_USED_, NULL, .constantValue.asLong = 0 },
    { "BASE_RAM_BYTES_USED_", NULL, 0x1a, "J", &OrgApacheLuceneIndexSegmentDocValuesProducer_BASE_RAM_BYTES_USED_, NULL, .constantValue.asLong = 0 },
    { "dvProducersByField_", NULL, 0x10, "Ljava.util.Map;", NULL, "Ljava/util/Map<Ljava/lang/String;Lorg/apache/lucene/codecs/DocValuesProducer;>;", .constantValue.asLong = 0 },
    { "dvProducers_", NULL, 0x10, "Ljava.util.Set;", NULL, "Ljava/util/Set<Lorg/apache/lucene/codecs/DocValuesProducer;>;", .constantValue.asLong = 0 },
    { "dvGens_", NULL, 0x10, "Ljava.util.List;", NULL, "Ljava/util/List<Ljava/lang/Long;>;", .constantValue.asLong = 0 },
  };
  static const J2ObjcClassInfo _OrgApacheLuceneIndexSegmentDocValuesProducer = { 2, "SegmentDocValuesProducer", "org.apache.lucene.index", NULL, 0x0, 12, methods, 5, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_OrgApacheLuceneIndexSegmentDocValuesProducer;
}

@end

void OrgApacheLuceneIndexSegmentDocValuesProducer_initWithOrgApacheLuceneIndexSegmentCommitInfo_withOrgApacheLuceneStoreDirectory_withOrgApacheLuceneIndexFieldInfos_withOrgApacheLuceneIndexFieldInfos_withOrgApacheLuceneIndexSegmentDocValues_(OrgApacheLuceneIndexSegmentDocValuesProducer *self, OrgApacheLuceneIndexSegmentCommitInfo *si, OrgApacheLuceneStoreDirectory *dir, OrgApacheLuceneIndexFieldInfos *coreInfos, OrgApacheLuceneIndexFieldInfos *allInfos, OrgApacheLuceneIndexSegmentDocValues *segDocValues) {
  OrgApacheLuceneCodecsDocValuesProducer_init(self);
  JreStrongAssignAndConsume(&self->dvProducersByField_, new_JavaUtilHashMap_init());
  JreStrongAssign(&self->dvProducers_, JavaUtilCollections_newSetFromMapWithJavaUtilMap_([new_JavaUtilIdentityHashMap_init() autorelease]));
  JreStrongAssignAndConsume(&self->dvGens_, new_JavaUtilArrayList_init());
  jboolean success = false;
  @try {
    OrgApacheLuceneUtilVersion *ver = [((OrgApacheLuceneIndexSegmentInfo *) nil_chk(((OrgApacheLuceneIndexSegmentCommitInfo *) nil_chk(si))->info_)) getVersion];
    if (ver != nil && [ver onOrAfterWithOrgApacheLuceneUtilVersion:JreLoadStatic(OrgApacheLuceneUtilVersion, LUCENE_4_9_0_)]) {
      OrgApacheLuceneCodecsDocValuesProducer *baseProducer = nil;
      for (OrgApacheLuceneIndexFieldInfo * __strong fi in nil_chk(allInfos)) {
        if ([((OrgApacheLuceneIndexFieldInfo *) nil_chk(fi)) getDocValuesType] == JreLoadStatic(OrgApacheLuceneIndexDocValuesTypeEnum, NONE)) {
          continue;
        }
        jlong docValuesGen = [fi getDocValuesGen];
        if (docValuesGen == -1) {
          if (baseProducer == nil) {
            baseProducer = [((OrgApacheLuceneIndexSegmentDocValues *) nil_chk(segDocValues)) getDocValuesProducerWithLong:docValuesGen withOrgApacheLuceneIndexSegmentCommitInfo:si withOrgApacheLuceneStoreDirectory:dir withOrgApacheLuceneIndexFieldInfos:coreInfos];
            [self->dvGens_ addWithId:JavaLangLong_valueOfWithLong_(docValuesGen)];
            [((id<JavaUtilSet>) nil_chk(self->dvProducers_)) addWithId:baseProducer];
          }
          [self->dvProducersByField_ putWithId:fi->name_ withId:baseProducer];
        }
        else {
          JreAssert((![self->dvGens_ containsWithId:JavaLangLong_valueOfWithLong_(docValuesGen)]), (@"org/apache/lucene/index/SegmentDocValuesProducer.java:79 condition failed: assert !dvGens.contains(docValuesGen);"));
          OrgApacheLuceneCodecsDocValuesProducer *dvp = [((OrgApacheLuceneIndexSegmentDocValues *) nil_chk(segDocValues)) getDocValuesProducerWithLong:docValuesGen withOrgApacheLuceneIndexSegmentCommitInfo:si withOrgApacheLuceneStoreDirectory:dir withOrgApacheLuceneIndexFieldInfos:[new_OrgApacheLuceneIndexFieldInfos_initWithOrgApacheLuceneIndexFieldInfoArray_([IOSObjectArray arrayWithObjects:(id[]){ fi } count:1 type:OrgApacheLuceneIndexFieldInfo_class_()]) autorelease]];
          [self->dvGens_ addWithId:JavaLangLong_valueOfWithLong_(docValuesGen)];
          [((id<JavaUtilSet>) nil_chk(self->dvProducers_)) addWithId:dvp];
          [self->dvProducersByField_ putWithId:fi->name_ withId:dvp];
        }
      }
    }
    else {
      id<JavaUtilMap> genInfos = [new_JavaUtilHashMap_init() autorelease];
      for (OrgApacheLuceneIndexFieldInfo * __strong fi in nil_chk(allInfos)) {
        if ([((OrgApacheLuceneIndexFieldInfo *) nil_chk(fi)) getDocValuesType] == JreLoadStatic(OrgApacheLuceneIndexDocValuesTypeEnum, NONE)) {
          continue;
        }
        id<JavaUtilList> genFieldInfos = [genInfos getWithId:JavaLangLong_valueOfWithLong_([fi getDocValuesGen])];
        if (genFieldInfos == nil) {
          genFieldInfos = [new_JavaUtilArrayList_init() autorelease];
          [genInfos putWithId:JavaLangLong_valueOfWithLong_([fi getDocValuesGen]) withId:genFieldInfos];
        }
        [((id<JavaUtilList>) nil_chk(genFieldInfos)) addWithId:fi];
      }
      for (id<JavaUtilMap_Entry> __strong e in nil_chk([genInfos entrySet])) {
        jlong docValuesGen = [((JavaLangLong *) nil_chk([((id<JavaUtilMap_Entry>) nil_chk(e)) getKey])) longLongValue];
        id<JavaUtilList> infos = [e getValue];
        OrgApacheLuceneCodecsDocValuesProducer *dvp;
        if (docValuesGen == -1) {
          dvp = [((OrgApacheLuceneIndexSegmentDocValues *) nil_chk(segDocValues)) getDocValuesProducerWithLong:docValuesGen withOrgApacheLuceneIndexSegmentCommitInfo:si withOrgApacheLuceneStoreDirectory:dir withOrgApacheLuceneIndexFieldInfos:coreInfos];
        }
        else {
          dvp = [((OrgApacheLuceneIndexSegmentDocValues *) nil_chk(segDocValues)) getDocValuesProducerWithLong:docValuesGen withOrgApacheLuceneIndexSegmentCommitInfo:si withOrgApacheLuceneStoreDirectory:dir withOrgApacheLuceneIndexFieldInfos:[new_OrgApacheLuceneIndexFieldInfos_initWithOrgApacheLuceneIndexFieldInfoArray_([infos toArrayWithNSObjectArray:[IOSObjectArray arrayWithLength:[((id<JavaUtilList>) nil_chk(infos)) size] type:OrgApacheLuceneIndexFieldInfo_class_()]]) autorelease]];
        }
        [self->dvGens_ addWithId:JavaLangLong_valueOfWithLong_(docValuesGen)];
        [((id<JavaUtilSet>) nil_chk(self->dvProducers_)) addWithId:dvp];
        for (OrgApacheLuceneIndexFieldInfo * __strong fi in nil_chk(infos)) {
          [self->dvProducersByField_ putWithId:((OrgApacheLuceneIndexFieldInfo *) nil_chk(fi))->name_ withId:dvp];
        }
      }
    }
    success = true;
  }
  @finally {
    if (success == false) {
      @try {
        [((OrgApacheLuceneIndexSegmentDocValues *) nil_chk(segDocValues)) decRefWithJavaUtilList:self->dvGens_];
      }
      @catch (JavaLangThrowable *t) {
      }
    }
  }
}

OrgApacheLuceneIndexSegmentDocValuesProducer *new_OrgApacheLuceneIndexSegmentDocValuesProducer_initWithOrgApacheLuceneIndexSegmentCommitInfo_withOrgApacheLuceneStoreDirectory_withOrgApacheLuceneIndexFieldInfos_withOrgApacheLuceneIndexFieldInfos_withOrgApacheLuceneIndexSegmentDocValues_(OrgApacheLuceneIndexSegmentCommitInfo *si, OrgApacheLuceneStoreDirectory *dir, OrgApacheLuceneIndexFieldInfos *coreInfos, OrgApacheLuceneIndexFieldInfos *allInfos, OrgApacheLuceneIndexSegmentDocValues *segDocValues) {
  OrgApacheLuceneIndexSegmentDocValuesProducer *self = [OrgApacheLuceneIndexSegmentDocValuesProducer alloc];
  OrgApacheLuceneIndexSegmentDocValuesProducer_initWithOrgApacheLuceneIndexSegmentCommitInfo_withOrgApacheLuceneStoreDirectory_withOrgApacheLuceneIndexFieldInfos_withOrgApacheLuceneIndexFieldInfos_withOrgApacheLuceneIndexSegmentDocValues_(self, si, dir, coreInfos, allInfos, segDocValues);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneIndexSegmentDocValuesProducer)
