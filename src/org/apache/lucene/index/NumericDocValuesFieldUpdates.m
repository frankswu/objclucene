//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: ./core/src/java/org/apache/lucene/index/NumericDocValuesFieldUpdates.java
//

#include "IOSClass.h"
#include "J2ObjC_source.h"
#include "java/lang/IllegalStateException.h"
#include "java/lang/Integer.h"
#include "java/lang/Long.h"
#include "java/lang/Math.h"
#include "org/apache/lucene/index/DocValuesFieldUpdates.h"
#include "org/apache/lucene/index/DocValuesType.h"
#include "org/apache/lucene/index/NumericDocValuesFieldUpdates.h"
#include "org/apache/lucene/search/DocIdSetIterator.h"
#include "org/apache/lucene/util/InPlaceMergeSorter.h"
#include "org/apache/lucene/util/packed/PackedInts.h"
#include "org/apache/lucene/util/packed/PagedGrowableWriter.h"
#include "org/apache/lucene/util/packed/PagedMutable.h"

@interface OrgApacheLuceneIndexNumericDocValuesFieldUpdates () {
 @public
  jint bitsPerValue_;
  OrgApacheLuceneUtilPackedPagedMutable *docs_;
  OrgApacheLuceneUtilPackedPagedGrowableWriter *values_;
  jint size_;
}

@end

J2OBJC_FIELD_SETTER(OrgApacheLuceneIndexNumericDocValuesFieldUpdates, docs_, OrgApacheLuceneUtilPackedPagedMutable *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneIndexNumericDocValuesFieldUpdates, values_, OrgApacheLuceneUtilPackedPagedGrowableWriter *)

@interface OrgApacheLuceneIndexNumericDocValuesFieldUpdates_Iterator () {
 @public
  jint size_;
  OrgApacheLuceneUtilPackedPagedGrowableWriter *values_;
  OrgApacheLuceneUtilPackedPagedMutable *docs_;
  jlong idx_;
  jint doc_;
  JavaLangLong *value_;
}

@end

J2OBJC_FIELD_SETTER(OrgApacheLuceneIndexNumericDocValuesFieldUpdates_Iterator, values_, OrgApacheLuceneUtilPackedPagedGrowableWriter *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneIndexNumericDocValuesFieldUpdates_Iterator, docs_, OrgApacheLuceneUtilPackedPagedMutable *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneIndexNumericDocValuesFieldUpdates_Iterator, value_, JavaLangLong *)

@interface OrgApacheLuceneIndexNumericDocValuesFieldUpdates_$1 : OrgApacheLuceneUtilInPlaceMergeSorter {
 @public
  OrgApacheLuceneUtilPackedPagedMutable *val$docs_;
  OrgApacheLuceneUtilPackedPagedGrowableWriter *val$values_;
}

- (void)swapWithInt:(jint)i
            withInt:(jint)j;

- (jint)compareWithInt:(jint)i
               withInt:(jint)j;

- (instancetype)initWithOrgApacheLuceneUtilPackedPagedMutable:(OrgApacheLuceneUtilPackedPagedMutable *)capture$0
             withOrgApacheLuceneUtilPackedPagedGrowableWriter:(OrgApacheLuceneUtilPackedPagedGrowableWriter *)capture$1;

@end

J2OBJC_EMPTY_STATIC_INIT(OrgApacheLuceneIndexNumericDocValuesFieldUpdates_$1)

J2OBJC_FIELD_SETTER(OrgApacheLuceneIndexNumericDocValuesFieldUpdates_$1, val$docs_, OrgApacheLuceneUtilPackedPagedMutable *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneIndexNumericDocValuesFieldUpdates_$1, val$values_, OrgApacheLuceneUtilPackedPagedGrowableWriter *)

__attribute__((unused)) static void OrgApacheLuceneIndexNumericDocValuesFieldUpdates_$1_initWithOrgApacheLuceneUtilPackedPagedMutable_withOrgApacheLuceneUtilPackedPagedGrowableWriter_(OrgApacheLuceneIndexNumericDocValuesFieldUpdates_$1 *self, OrgApacheLuceneUtilPackedPagedMutable *capture$0, OrgApacheLuceneUtilPackedPagedGrowableWriter *capture$1);

__attribute__((unused)) static OrgApacheLuceneIndexNumericDocValuesFieldUpdates_$1 *new_OrgApacheLuceneIndexNumericDocValuesFieldUpdates_$1_initWithOrgApacheLuceneUtilPackedPagedMutable_withOrgApacheLuceneUtilPackedPagedGrowableWriter_(OrgApacheLuceneUtilPackedPagedMutable *capture$0, OrgApacheLuceneUtilPackedPagedGrowableWriter *capture$1) NS_RETURNS_RETAINED;

J2OBJC_TYPE_LITERAL_HEADER(OrgApacheLuceneIndexNumericDocValuesFieldUpdates_$1)

@implementation OrgApacheLuceneIndexNumericDocValuesFieldUpdates

- (instancetype)initWithNSString:(NSString *)field
                         withInt:(jint)maxDoc {
  OrgApacheLuceneIndexNumericDocValuesFieldUpdates_initWithNSString_withInt_(self, field, maxDoc);
  return self;
}

- (void)addWithInt:(jint)doc
            withId:(id)value {
  if (size_ == JavaLangInteger_MAX_VALUE) {
    @throw [new_JavaLangIllegalStateException_initWithNSString_(@"cannot support more than Integer.MAX_VALUE doc/value entries") autorelease];
  }
  JavaLangLong *val = (JavaLangLong *) check_class_cast(value, [JavaLangLong class]);
  if ([((OrgApacheLuceneUtilPackedPagedMutable *) nil_chk(docs_)) size] == size_) {
    JreStrongAssign(&docs_, [docs_ growWithLong:size_ + 1]);
    JreStrongAssign(&values_, [((OrgApacheLuceneUtilPackedPagedGrowableWriter *) nil_chk(values_)) growWithLong:size_ + 1]);
  }
  [((OrgApacheLuceneUtilPackedPagedMutable *) nil_chk(docs_)) setWithLong:size_ withLong:doc];
  [((OrgApacheLuceneUtilPackedPagedGrowableWriter *) nil_chk(values_)) setWithLong:size_ withLong:[((JavaLangLong *) nil_chk(val)) longLongValue]];
  ++size_;
}

- (OrgApacheLuceneIndexNumericDocValuesFieldUpdates_Iterator *)iterator {
  OrgApacheLuceneUtilPackedPagedMutable *docs = self->docs_;
  OrgApacheLuceneUtilPackedPagedGrowableWriter *values = self->values_;
  [((OrgApacheLuceneIndexNumericDocValuesFieldUpdates_$1 *) [new_OrgApacheLuceneIndexNumericDocValuesFieldUpdates_$1_initWithOrgApacheLuceneUtilPackedPagedMutable_withOrgApacheLuceneUtilPackedPagedGrowableWriter_(docs, values) autorelease]) sortWithInt:0 withInt:size_];
  return [new_OrgApacheLuceneIndexNumericDocValuesFieldUpdates_Iterator_initWithInt_withOrgApacheLuceneUtilPackedPagedGrowableWriter_withOrgApacheLuceneUtilPackedPagedMutable_(size_, values, docs) autorelease];
}

- (void)mergeWithOrgApacheLuceneIndexDocValuesFieldUpdates:(OrgApacheLuceneIndexDocValuesFieldUpdates *)other {
  JreAssert(([other isKindOfClass:[OrgApacheLuceneIndexNumericDocValuesFieldUpdates class]]), (@"org/apache/lucene/index/NumericDocValuesFieldUpdates.java:145 condition failed: assert other instanceof NumericDocValuesFieldUpdates;"));
  OrgApacheLuceneIndexNumericDocValuesFieldUpdates *otherUpdates = (OrgApacheLuceneIndexNumericDocValuesFieldUpdates *) check_class_cast(other, [OrgApacheLuceneIndexNumericDocValuesFieldUpdates class]);
  if (size_ + ((OrgApacheLuceneIndexNumericDocValuesFieldUpdates *) nil_chk(otherUpdates))->size_ > JavaLangInteger_MAX_VALUE) {
    @throw [new_JavaLangIllegalStateException_initWithNSString_(JreStrcat("$I$I", @"cannot support more than Integer.MAX_VALUE doc/value entries; size=", size_, @" other.size=", otherUpdates->size_)) autorelease];
  }
  JreStrongAssign(&docs_, [((OrgApacheLuceneUtilPackedPagedMutable *) nil_chk(docs_)) growWithLong:size_ + otherUpdates->size_]);
  JreStrongAssign(&values_, [((OrgApacheLuceneUtilPackedPagedGrowableWriter *) nil_chk(values_)) growWithLong:size_ + otherUpdates->size_]);
  for (jint i = 0; i < otherUpdates->size_; i++) {
    jint doc = (jint) [((OrgApacheLuceneUtilPackedPagedMutable *) nil_chk(otherUpdates->docs_)) getWithInt:i];
    [docs_ setWithLong:size_ withLong:doc];
    [values_ setWithLong:size_ withLong:[((OrgApacheLuceneUtilPackedPagedGrowableWriter *) nil_chk(otherUpdates->values_)) getWithInt:i]];
    ++size_;
  }
}

- (jboolean)any {
  return size_ > 0;
}

- (jlong)ramBytesPerDoc {
  jlong bytesPerDoc = JreFpToLong(JavaLangMath_ceilWithDouble_((jdouble) (bitsPerValue_) / 8));
  jint capacity = OrgApacheLuceneIndexDocValuesFieldUpdates_estimateCapacityWithInt_(size_);
  bytesPerDoc += JreFpToLong(JavaLangMath_ceilWithDouble_((jdouble) [((OrgApacheLuceneUtilPackedPagedGrowableWriter *) nil_chk(values_)) ramBytesUsed] / capacity));
  return bytesPerDoc;
}

- (void)dealloc {
  RELEASE_(docs_);
  RELEASE_(values_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithNSString:withInt:", "NumericDocValuesFieldUpdates", NULL, 0x1, NULL, NULL },
    { "addWithInt:withId:", "add", "V", 0x1, NULL, NULL },
    { "iterator", NULL, "Lorg.apache.lucene.index.NumericDocValuesFieldUpdates$Iterator;", 0x1, NULL, NULL },
    { "mergeWithOrgApacheLuceneIndexDocValuesFieldUpdates:", "merge", "V", 0x1, NULL, NULL },
    { "any", NULL, "Z", 0x1, NULL, NULL },
    { "ramBytesPerDoc", NULL, "J", 0x1, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "bitsPerValue_", NULL, 0x12, "I", NULL, NULL, .constantValue.asLong = 0 },
    { "docs_", NULL, 0x2, "Lorg.apache.lucene.util.packed.PagedMutable;", NULL, NULL, .constantValue.asLong = 0 },
    { "values_", NULL, 0x2, "Lorg.apache.lucene.util.packed.PagedGrowableWriter;", NULL, NULL, .constantValue.asLong = 0 },
    { "size_", NULL, 0x2, "I", NULL, NULL, .constantValue.asLong = 0 },
  };
  static const char *inner_classes[] = {"Lorg.apache.lucene.index.NumericDocValuesFieldUpdates$Iterator;"};
  static const J2ObjcClassInfo _OrgApacheLuceneIndexNumericDocValuesFieldUpdates = { 2, "NumericDocValuesFieldUpdates", "org.apache.lucene.index", NULL, 0x0, 6, methods, 4, fields, 0, NULL, 1, inner_classes, NULL, NULL };
  return &_OrgApacheLuceneIndexNumericDocValuesFieldUpdates;
}

@end

void OrgApacheLuceneIndexNumericDocValuesFieldUpdates_initWithNSString_withInt_(OrgApacheLuceneIndexNumericDocValuesFieldUpdates *self, NSString *field, jint maxDoc) {
  OrgApacheLuceneIndexDocValuesFieldUpdates_initWithNSString_withOrgApacheLuceneIndexDocValuesTypeEnum_(self, field, JreLoadStatic(OrgApacheLuceneIndexDocValuesTypeEnum, NUMERIC));
  self->bitsPerValue_ = OrgApacheLuceneUtilPackedPackedInts_bitsRequiredWithLong_(maxDoc - 1);
  JreStrongAssignAndConsume(&self->docs_, new_OrgApacheLuceneUtilPackedPagedMutable_initWithLong_withInt_withInt_withFloat_(1, OrgApacheLuceneIndexDocValuesFieldUpdates_PAGE_SIZE, self->bitsPerValue_, OrgApacheLuceneUtilPackedPackedInts_COMPACT));
  JreStrongAssignAndConsume(&self->values_, new_OrgApacheLuceneUtilPackedPagedGrowableWriter_initWithLong_withInt_withInt_withFloat_(1, OrgApacheLuceneIndexDocValuesFieldUpdates_PAGE_SIZE, 1, OrgApacheLuceneUtilPackedPackedInts_FAST));
  self->size_ = 0;
}

OrgApacheLuceneIndexNumericDocValuesFieldUpdates *new_OrgApacheLuceneIndexNumericDocValuesFieldUpdates_initWithNSString_withInt_(NSString *field, jint maxDoc) {
  OrgApacheLuceneIndexNumericDocValuesFieldUpdates *self = [OrgApacheLuceneIndexNumericDocValuesFieldUpdates alloc];
  OrgApacheLuceneIndexNumericDocValuesFieldUpdates_initWithNSString_withInt_(self, field, maxDoc);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneIndexNumericDocValuesFieldUpdates)

@implementation OrgApacheLuceneIndexNumericDocValuesFieldUpdates_Iterator

- (instancetype)initWithInt:(jint)size
withOrgApacheLuceneUtilPackedPagedGrowableWriter:(OrgApacheLuceneUtilPackedPagedGrowableWriter *)values
withOrgApacheLuceneUtilPackedPagedMutable:(OrgApacheLuceneUtilPackedPagedMutable *)docs {
  OrgApacheLuceneIndexNumericDocValuesFieldUpdates_Iterator_initWithInt_withOrgApacheLuceneUtilPackedPagedGrowableWriter_withOrgApacheLuceneUtilPackedPagedMutable_(self, size, values, docs);
  return self;
}

- (JavaLangLong *)value {
  return value_;
}

- (jint)nextDoc {
  if (idx_ >= size_) {
    JreStrongAssign(&value_, nil);
    return doc_ = OrgApacheLuceneSearchDocIdSetIterator_NO_MORE_DOCS;
  }
  doc_ = (jint) [((OrgApacheLuceneUtilPackedPagedMutable *) nil_chk(docs_)) getWithLong:idx_];
  ++idx_;
  while (idx_ < size_ && [docs_ getWithLong:idx_] == doc_) {
    ++idx_;
  }
  JreStrongAssign(&value_, JavaLangLong_valueOfWithLong_([((OrgApacheLuceneUtilPackedPagedGrowableWriter *) nil_chk(values_)) getWithLong:idx_ - 1]));
  return doc_;
}

- (jint)doc {
  return doc_;
}

- (void)reset {
  doc_ = -1;
  JreStrongAssign(&value_, nil);
  idx_ = 0;
}

- (void)dealloc {
  RELEASE_(values_);
  RELEASE_(docs_);
  RELEASE_(value_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithInt:withOrgApacheLuceneUtilPackedPagedGrowableWriter:withOrgApacheLuceneUtilPackedPagedMutable:", "Iterator", NULL, 0x0, NULL, NULL },
    { "value", NULL, "Ljava.lang.Long;", 0x0, NULL, NULL },
    { "nextDoc", NULL, "I", 0x0, NULL, NULL },
    { "doc", NULL, "I", 0x0, NULL, NULL },
    { "reset", NULL, "V", 0x0, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "size_", NULL, 0x12, "I", NULL, NULL, .constantValue.asLong = 0 },
    { "values_", NULL, 0x12, "Lorg.apache.lucene.util.packed.PagedGrowableWriter;", NULL, NULL, .constantValue.asLong = 0 },
    { "docs_", NULL, 0x12, "Lorg.apache.lucene.util.packed.PagedMutable;", NULL, NULL, .constantValue.asLong = 0 },
    { "idx_", NULL, 0x2, "J", NULL, NULL, .constantValue.asLong = 0 },
    { "doc_", NULL, 0x2, "I", NULL, NULL, .constantValue.asLong = 0 },
    { "value_", NULL, 0x2, "Ljava.lang.Long;", NULL, NULL, .constantValue.asLong = 0 },
  };
  static const J2ObjcClassInfo _OrgApacheLuceneIndexNumericDocValuesFieldUpdates_Iterator = { 2, "Iterator", "org.apache.lucene.index", "NumericDocValuesFieldUpdates", 0x18, 5, methods, 6, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_OrgApacheLuceneIndexNumericDocValuesFieldUpdates_Iterator;
}

@end

void OrgApacheLuceneIndexNumericDocValuesFieldUpdates_Iterator_initWithInt_withOrgApacheLuceneUtilPackedPagedGrowableWriter_withOrgApacheLuceneUtilPackedPagedMutable_(OrgApacheLuceneIndexNumericDocValuesFieldUpdates_Iterator *self, jint size, OrgApacheLuceneUtilPackedPagedGrowableWriter *values, OrgApacheLuceneUtilPackedPagedMutable *docs) {
  OrgApacheLuceneIndexDocValuesFieldUpdates_Iterator_init(self);
  self->idx_ = 0;
  self->doc_ = -1;
  JreStrongAssign(&self->value_, nil);
  self->size_ = size;
  JreStrongAssign(&self->values_, values);
  JreStrongAssign(&self->docs_, docs);
}

OrgApacheLuceneIndexNumericDocValuesFieldUpdates_Iterator *new_OrgApacheLuceneIndexNumericDocValuesFieldUpdates_Iterator_initWithInt_withOrgApacheLuceneUtilPackedPagedGrowableWriter_withOrgApacheLuceneUtilPackedPagedMutable_(jint size, OrgApacheLuceneUtilPackedPagedGrowableWriter *values, OrgApacheLuceneUtilPackedPagedMutable *docs) {
  OrgApacheLuceneIndexNumericDocValuesFieldUpdates_Iterator *self = [OrgApacheLuceneIndexNumericDocValuesFieldUpdates_Iterator alloc];
  OrgApacheLuceneIndexNumericDocValuesFieldUpdates_Iterator_initWithInt_withOrgApacheLuceneUtilPackedPagedGrowableWriter_withOrgApacheLuceneUtilPackedPagedMutable_(self, size, values, docs);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneIndexNumericDocValuesFieldUpdates_Iterator)

@implementation OrgApacheLuceneIndexNumericDocValuesFieldUpdates_$1

- (void)swapWithInt:(jint)i
            withInt:(jint)j {
  jlong tmpDoc = [((OrgApacheLuceneUtilPackedPagedMutable *) nil_chk(val$docs_)) getWithInt:j];
  [val$docs_ setWithLong:j withLong:[val$docs_ getWithInt:i]];
  [val$docs_ setWithLong:i withLong:tmpDoc];
  jlong tmpVal = [((OrgApacheLuceneUtilPackedPagedGrowableWriter *) nil_chk(val$values_)) getWithInt:j];
  [val$values_ setWithLong:j withLong:[val$values_ getWithInt:i]];
  [val$values_ setWithLong:i withLong:tmpVal];
}

- (jint)compareWithInt:(jint)i
               withInt:(jint)j {
  jint x = (jint) [((OrgApacheLuceneUtilPackedPagedMutable *) nil_chk(val$docs_)) getWithInt:i];
  jint y = (jint) [val$docs_ getWithInt:j];
  return (x < y) ? -1 : ((x == y) ? 0 : 1);
}

- (instancetype)initWithOrgApacheLuceneUtilPackedPagedMutable:(OrgApacheLuceneUtilPackedPagedMutable *)capture$0
             withOrgApacheLuceneUtilPackedPagedGrowableWriter:(OrgApacheLuceneUtilPackedPagedGrowableWriter *)capture$1 {
  OrgApacheLuceneIndexNumericDocValuesFieldUpdates_$1_initWithOrgApacheLuceneUtilPackedPagedMutable_withOrgApacheLuceneUtilPackedPagedGrowableWriter_(self, capture$0, capture$1);
  return self;
}

- (void)dealloc {
  RELEASE_(val$docs_);
  RELEASE_(val$values_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "swapWithInt:withInt:", "swap", "V", 0x4, NULL, NULL },
    { "compareWithInt:withInt:", "compare", "I", 0x4, NULL, NULL },
    { "initWithOrgApacheLuceneUtilPackedPagedMutable:withOrgApacheLuceneUtilPackedPagedGrowableWriter:", "", NULL, 0x0, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "val$docs_", NULL, 0x1012, "Lorg.apache.lucene.util.packed.PagedMutable;", NULL, NULL, .constantValue.asLong = 0 },
    { "val$values_", NULL, 0x1012, "Lorg.apache.lucene.util.packed.PagedGrowableWriter;", NULL, NULL, .constantValue.asLong = 0 },
  };
  static const J2ObjCEnclosingMethodInfo enclosing_method = { "OrgApacheLuceneIndexNumericDocValuesFieldUpdates", "iterator" };
  static const J2ObjcClassInfo _OrgApacheLuceneIndexNumericDocValuesFieldUpdates_$1 = { 2, "", "org.apache.lucene.index", "NumericDocValuesFieldUpdates", 0x8008, 3, methods, 2, fields, 0, NULL, 0, NULL, &enclosing_method, NULL };
  return &_OrgApacheLuceneIndexNumericDocValuesFieldUpdates_$1;
}

@end

void OrgApacheLuceneIndexNumericDocValuesFieldUpdates_$1_initWithOrgApacheLuceneUtilPackedPagedMutable_withOrgApacheLuceneUtilPackedPagedGrowableWriter_(OrgApacheLuceneIndexNumericDocValuesFieldUpdates_$1 *self, OrgApacheLuceneUtilPackedPagedMutable *capture$0, OrgApacheLuceneUtilPackedPagedGrowableWriter *capture$1) {
  JreStrongAssign(&self->val$docs_, capture$0);
  JreStrongAssign(&self->val$values_, capture$1);
  OrgApacheLuceneUtilInPlaceMergeSorter_init(self);
}

OrgApacheLuceneIndexNumericDocValuesFieldUpdates_$1 *new_OrgApacheLuceneIndexNumericDocValuesFieldUpdates_$1_initWithOrgApacheLuceneUtilPackedPagedMutable_withOrgApacheLuceneUtilPackedPagedGrowableWriter_(OrgApacheLuceneUtilPackedPagedMutable *capture$0, OrgApacheLuceneUtilPackedPagedGrowableWriter *capture$1) {
  OrgApacheLuceneIndexNumericDocValuesFieldUpdates_$1 *self = [OrgApacheLuceneIndexNumericDocValuesFieldUpdates_$1 alloc];
  OrgApacheLuceneIndexNumericDocValuesFieldUpdates_$1_initWithOrgApacheLuceneUtilPackedPagedMutable_withOrgApacheLuceneUtilPackedPagedGrowableWriter_(self, capture$0, capture$1);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneIndexNumericDocValuesFieldUpdates_$1)
