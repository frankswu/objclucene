//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: ./core/src/java/org/apache/lucene/search/MultiCollector.java
//

#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "J2ObjC_source.h"
#include "java/io/IOException.h"
#include "java/lang/IllegalArgumentException.h"
#include "java/lang/Iterable.h"
#include "java/util/Arrays.h"
#include "java/util/List.h"
#include "org/apache/lucene/index/LeafReaderContext.h"
#include "org/apache/lucene/search/Collector.h"
#include "org/apache/lucene/search/LeafCollector.h"
#include "org/apache/lucene/search/MultiCollector.h"
#include "org/apache/lucene/search/ScoreCachingWrappingScorer.h"
#include "org/apache/lucene/search/Scorer.h"

@interface OrgApacheLuceneSearchMultiCollector () {
 @public
  jboolean cacheScores_;
  IOSObjectArray *collectors_;
}

- (instancetype)initWithOrgApacheLuceneSearchCollectorArray:(IOSObjectArray *)collectors;

@end

J2OBJC_FIELD_SETTER(OrgApacheLuceneSearchMultiCollector, collectors_, IOSObjectArray *)

__attribute__((unused)) static void OrgApacheLuceneSearchMultiCollector_initWithOrgApacheLuceneSearchCollectorArray_(OrgApacheLuceneSearchMultiCollector *self, IOSObjectArray *collectors);

__attribute__((unused)) static OrgApacheLuceneSearchMultiCollector *new_OrgApacheLuceneSearchMultiCollector_initWithOrgApacheLuceneSearchCollectorArray_(IOSObjectArray *collectors) NS_RETURNS_RETAINED;

@interface OrgApacheLuceneSearchMultiCollector_MultiLeafCollector : NSObject < OrgApacheLuceneSearchLeafCollector > {
 @public
  jboolean cacheScores_;
  IOSObjectArray *collectors_;
}

- (instancetype)initWithOrgApacheLuceneSearchLeafCollectorArray:(IOSObjectArray *)collectors
                                                    withBoolean:(jboolean)cacheScores;

- (void)setScorerWithOrgApacheLuceneSearchScorer:(OrgApacheLuceneSearchScorer *)scorer;

- (void)collectWithInt:(jint)doc;

@end

J2OBJC_EMPTY_STATIC_INIT(OrgApacheLuceneSearchMultiCollector_MultiLeafCollector)

J2OBJC_FIELD_SETTER(OrgApacheLuceneSearchMultiCollector_MultiLeafCollector, collectors_, IOSObjectArray *)

__attribute__((unused)) static void OrgApacheLuceneSearchMultiCollector_MultiLeafCollector_initWithOrgApacheLuceneSearchLeafCollectorArray_withBoolean_(OrgApacheLuceneSearchMultiCollector_MultiLeafCollector *self, IOSObjectArray *collectors, jboolean cacheScores);

__attribute__((unused)) static OrgApacheLuceneSearchMultiCollector_MultiLeafCollector *new_OrgApacheLuceneSearchMultiCollector_MultiLeafCollector_initWithOrgApacheLuceneSearchLeafCollectorArray_withBoolean_(IOSObjectArray *collectors, jboolean cacheScores) NS_RETURNS_RETAINED;

J2OBJC_TYPE_LITERAL_HEADER(OrgApacheLuceneSearchMultiCollector_MultiLeafCollector)

@implementation OrgApacheLuceneSearchMultiCollector

+ (id<OrgApacheLuceneSearchCollector>)wrapWithOrgApacheLuceneSearchCollectorArray:(IOSObjectArray *)collectors {
  return OrgApacheLuceneSearchMultiCollector_wrapWithOrgApacheLuceneSearchCollectorArray_(collectors);
}

+ (id<OrgApacheLuceneSearchCollector>)wrapWithJavaLangIterable:(id<JavaLangIterable>)collectors {
  return OrgApacheLuceneSearchMultiCollector_wrapWithJavaLangIterable_(collectors);
}

- (instancetype)initWithOrgApacheLuceneSearchCollectorArray:(IOSObjectArray *)collectors {
  OrgApacheLuceneSearchMultiCollector_initWithOrgApacheLuceneSearchCollectorArray_(self, collectors);
  return self;
}

- (jboolean)needsScores {
  {
    IOSObjectArray *a__ = collectors_;
    id<OrgApacheLuceneSearchCollector> const *b__ = ((IOSObjectArray *) nil_chk(a__))->buffer_;
    id<OrgApacheLuceneSearchCollector> const *e__ = b__ + a__->size_;
    while (b__ < e__) {
      id<OrgApacheLuceneSearchCollector> collector = *b__++;
      if ([((id<OrgApacheLuceneSearchCollector>) nil_chk(collector)) needsScores]) {
        return true;
      }
    }
  }
  return false;
}

- (id<OrgApacheLuceneSearchLeafCollector>)getLeafCollectorWithOrgApacheLuceneIndexLeafReaderContext:(OrgApacheLuceneIndexLeafReaderContext *)context {
  IOSObjectArray *leafCollectors = [IOSObjectArray arrayWithLength:((IOSObjectArray *) nil_chk(collectors_))->size_ type:OrgApacheLuceneSearchLeafCollector_class_()];
  for (jint i = 0; i < collectors_->size_; ++i) {
    IOSObjectArray_Set(leafCollectors, i, [((id<OrgApacheLuceneSearchCollector>) nil_chk(IOSObjectArray_Get(collectors_, i))) getLeafCollectorWithOrgApacheLuceneIndexLeafReaderContext:context]);
  }
  return [new_OrgApacheLuceneSearchMultiCollector_MultiLeafCollector_initWithOrgApacheLuceneSearchLeafCollectorArray_withBoolean_(leafCollectors, cacheScores_) autorelease];
}

- (void)dealloc {
  RELEASE_(collectors_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "wrapWithOrgApacheLuceneSearchCollectorArray:", "wrap", "Lorg.apache.lucene.search.Collector;", 0x89, NULL, NULL },
    { "wrapWithJavaLangIterable:", "wrap", "Lorg.apache.lucene.search.Collector;", 0x9, NULL, NULL },
    { "initWithOrgApacheLuceneSearchCollectorArray:", "MultiCollector", NULL, 0x82, NULL, NULL },
    { "needsScores", NULL, "Z", 0x1, NULL, NULL },
    { "getLeafCollectorWithOrgApacheLuceneIndexLeafReaderContext:", "getLeafCollector", "Lorg.apache.lucene.search.LeafCollector;", 0x1, "Ljava.io.IOException;", NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "cacheScores_", NULL, 0x12, "Z", NULL, NULL, .constantValue.asLong = 0 },
    { "collectors_", NULL, 0x12, "[Lorg.apache.lucene.search.Collector;", NULL, NULL, .constantValue.asLong = 0 },
  };
  static const char *inner_classes[] = {"Lorg.apache.lucene.search.MultiCollector$MultiLeafCollector;"};
  static const J2ObjcClassInfo _OrgApacheLuceneSearchMultiCollector = { 2, "MultiCollector", "org.apache.lucene.search", NULL, 0x1, 5, methods, 2, fields, 0, NULL, 1, inner_classes, NULL, NULL };
  return &_OrgApacheLuceneSearchMultiCollector;
}

@end

id<OrgApacheLuceneSearchCollector> OrgApacheLuceneSearchMultiCollector_wrapWithOrgApacheLuceneSearchCollectorArray_(IOSObjectArray *collectors) {
  OrgApacheLuceneSearchMultiCollector_initialize();
  return OrgApacheLuceneSearchMultiCollector_wrapWithJavaLangIterable_(JavaUtilArrays_asListWithNSObjectArray_(collectors));
}

id<OrgApacheLuceneSearchCollector> OrgApacheLuceneSearchMultiCollector_wrapWithJavaLangIterable_(id<JavaLangIterable> collectors) {
  OrgApacheLuceneSearchMultiCollector_initialize();
  jint n = 0;
  for (id<OrgApacheLuceneSearchCollector> __strong c in nil_chk(collectors)) {
    if (c != nil) {
      n++;
    }
  }
  if (n == 0) {
    @throw [new_JavaLangIllegalArgumentException_initWithNSString_(@"At least 1 collector must not be null") autorelease];
  }
  else if (n == 1) {
    id<OrgApacheLuceneSearchCollector> col = nil;
    for (id<OrgApacheLuceneSearchCollector> __strong c in collectors) {
      if (c != nil) {
        col = c;
        break;
      }
    }
    return col;
  }
  else {
    IOSObjectArray *colls = [IOSObjectArray arrayWithLength:n type:OrgApacheLuceneSearchCollector_class_()];
    n = 0;
    for (id<OrgApacheLuceneSearchCollector> __strong c in collectors) {
      if (c != nil) {
        IOSObjectArray_Set(colls, n++, c);
      }
    }
    return [new_OrgApacheLuceneSearchMultiCollector_initWithOrgApacheLuceneSearchCollectorArray_(colls) autorelease];
  }
}

void OrgApacheLuceneSearchMultiCollector_initWithOrgApacheLuceneSearchCollectorArray_(OrgApacheLuceneSearchMultiCollector *self, IOSObjectArray *collectors) {
  NSObject_init(self);
  JreStrongAssign(&self->collectors_, collectors);
  jint numNeedsScores = 0;
  {
    IOSObjectArray *a__ = collectors;
    id<OrgApacheLuceneSearchCollector> const *b__ = ((IOSObjectArray *) nil_chk(a__))->buffer_;
    id<OrgApacheLuceneSearchCollector> const *e__ = b__ + a__->size_;
    while (b__ < e__) {
      id<OrgApacheLuceneSearchCollector> collector = *b__++;
      if ([((id<OrgApacheLuceneSearchCollector>) nil_chk(collector)) needsScores]) {
        numNeedsScores += 1;
      }
    }
  }
  self->cacheScores_ = (numNeedsScores >= 2);
}

OrgApacheLuceneSearchMultiCollector *new_OrgApacheLuceneSearchMultiCollector_initWithOrgApacheLuceneSearchCollectorArray_(IOSObjectArray *collectors) {
  OrgApacheLuceneSearchMultiCollector *self = [OrgApacheLuceneSearchMultiCollector alloc];
  OrgApacheLuceneSearchMultiCollector_initWithOrgApacheLuceneSearchCollectorArray_(self, collectors);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneSearchMultiCollector)

@implementation OrgApacheLuceneSearchMultiCollector_MultiLeafCollector

- (instancetype)initWithOrgApacheLuceneSearchLeafCollectorArray:(IOSObjectArray *)collectors
                                                    withBoolean:(jboolean)cacheScores {
  OrgApacheLuceneSearchMultiCollector_MultiLeafCollector_initWithOrgApacheLuceneSearchLeafCollectorArray_withBoolean_(self, collectors, cacheScores);
  return self;
}

- (void)setScorerWithOrgApacheLuceneSearchScorer:(OrgApacheLuceneSearchScorer *)scorer {
  if (cacheScores_) {
    scorer = [new_OrgApacheLuceneSearchScoreCachingWrappingScorer_initWithOrgApacheLuceneSearchScorer_(scorer) autorelease];
  }
  {
    IOSObjectArray *a__ = collectors_;
    id<OrgApacheLuceneSearchLeafCollector> const *b__ = ((IOSObjectArray *) nil_chk(a__))->buffer_;
    id<OrgApacheLuceneSearchLeafCollector> const *e__ = b__ + a__->size_;
    while (b__ < e__) {
      id<OrgApacheLuceneSearchLeafCollector> c = *b__++;
      [((id<OrgApacheLuceneSearchLeafCollector>) nil_chk(c)) setScorerWithOrgApacheLuceneSearchScorer:scorer];
    }
  }
}

- (void)collectWithInt:(jint)doc {
  {
    IOSObjectArray *a__ = collectors_;
    id<OrgApacheLuceneSearchLeafCollector> const *b__ = ((IOSObjectArray *) nil_chk(a__))->buffer_;
    id<OrgApacheLuceneSearchLeafCollector> const *e__ = b__ + a__->size_;
    while (b__ < e__) {
      id<OrgApacheLuceneSearchLeafCollector> c = *b__++;
      [((id<OrgApacheLuceneSearchLeafCollector>) nil_chk(c)) collectWithInt:doc];
    }
  }
}

- (void)dealloc {
  RELEASE_(collectors_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithOrgApacheLuceneSearchLeafCollectorArray:withBoolean:", "MultiLeafCollector", NULL, 0x2, NULL, NULL },
    { "setScorerWithOrgApacheLuceneSearchScorer:", "setScorer", "V", 0x1, "Ljava.io.IOException;", NULL },
    { "collectWithInt:", "collect", "V", 0x1, "Ljava.io.IOException;", NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "cacheScores_", NULL, 0x12, "Z", NULL, NULL, .constantValue.asLong = 0 },
    { "collectors_", NULL, 0x12, "[Lorg.apache.lucene.search.LeafCollector;", NULL, NULL, .constantValue.asLong = 0 },
  };
  static const J2ObjcClassInfo _OrgApacheLuceneSearchMultiCollector_MultiLeafCollector = { 2, "MultiLeafCollector", "org.apache.lucene.search", "MultiCollector", 0xa, 3, methods, 2, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_OrgApacheLuceneSearchMultiCollector_MultiLeafCollector;
}

@end

void OrgApacheLuceneSearchMultiCollector_MultiLeafCollector_initWithOrgApacheLuceneSearchLeafCollectorArray_withBoolean_(OrgApacheLuceneSearchMultiCollector_MultiLeafCollector *self, IOSObjectArray *collectors, jboolean cacheScores) {
  NSObject_init(self);
  JreStrongAssign(&self->collectors_, collectors);
  self->cacheScores_ = cacheScores;
}

OrgApacheLuceneSearchMultiCollector_MultiLeafCollector *new_OrgApacheLuceneSearchMultiCollector_MultiLeafCollector_initWithOrgApacheLuceneSearchLeafCollectorArray_withBoolean_(IOSObjectArray *collectors, jboolean cacheScores) {
  OrgApacheLuceneSearchMultiCollector_MultiLeafCollector *self = [OrgApacheLuceneSearchMultiCollector_MultiLeafCollector alloc];
  OrgApacheLuceneSearchMultiCollector_MultiLeafCollector_initWithOrgApacheLuceneSearchLeafCollectorArray_withBoolean_(self, collectors, cacheScores);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneSearchMultiCollector_MultiLeafCollector)
