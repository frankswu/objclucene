//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: ./suggest/src/java/org/apache/lucene/search/suggest/fst/FSTCompletion.java
//

#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "java/io/IOException.h"
#include "java/lang/CharSequence.h"
#include "java/lang/Math.h"
#include "java/lang/RuntimeException.h"
#include "java/util/ArrayList.h"
#include "java/util/Collections.h"
#include "java/util/List.h"
#include "org/apache/lucene/search/suggest/fst/FSTCompletion.h"
#include "org/apache/lucene/util/ArrayUtil.h"
#include "org/apache/lucene/util/BytesRef.h"
#include "org/apache/lucene/util/fst/FST.h"

@interface OrgApacheLuceneSearchSuggestFstFSTCompletion () {
 @public
  /*!
   @brief Finite state automaton encoding all the lookup terms.
   See class notes for
 details.
   */
  OrgApacheLuceneUtilFstFST *automaton_;
  /*!
   @brief An array of arcs leaving the root automaton state and encoding weights of
 all completions in their sub-trees.
   */
  IOSObjectArray *rootArcs_;
  /*!
   - seealso: #FSTCompletion(FST,boolean,boolean)
   */
  jboolean exactFirst_;
  /*!
   - seealso: #FSTCompletion(FST,boolean,boolean)
   */
  jboolean higherWeightsFirst_;
}

/*!
 @brief Cache the root node's output arcs starting with completions with the
 highest weights.
 */
+ (IOSObjectArray *)cacheRootArcsWithOrgApacheLuceneUtilFstFST:(OrgApacheLuceneUtilFstFST *)automaton;

/*!
 @brief Returns the first exact match by traversing root arcs, starting from the
 arc <code>rootArcIndex</code>.
 @param rootArcIndex
 The first root arc index in <code>rootArcs</code> to consider when
 matching.
 @param utf8
 The sequence of utf8 bytes to follow.
 @return Returns the bucket number of the match or <code>-1</code> if no
 match was found.
 */
- (jint)getExactMatchStartingFromRootArcWithInt:(jint)rootArcIndex
                withOrgApacheLuceneUtilBytesRef:(OrgApacheLuceneUtilBytesRef *)utf8;

/*!
 @brief Lookup suggestions sorted alphabetically <b>if weights are not
 constant</b>.
 This is a workaround: in general, use constant weights for
 alphabetically sorted result.
 */
- (id<JavaUtilList>)lookupSortedAlphabeticallyWithOrgApacheLuceneUtilBytesRef:(OrgApacheLuceneUtilBytesRef *)key
                                                                      withInt:(jint)num;

/*!
 @brief Lookup suggestions sorted by weight (descending order).
 @param collectAll
 If <code>true</code>, the routine terminates immediately when
 <code>num</code> suggestions have been collected. If
 <code>false</code>, it will collect suggestions from all weight
 arcs (needed for <code>lookupSortedAlphabetically</code>.
 */
- (JavaUtilArrayList *)lookupSortedByWeightWithOrgApacheLuceneUtilBytesRef:(OrgApacheLuceneUtilBytesRef *)key
                                                                   withInt:(jint)num
                                                               withBoolean:(jboolean)collectAll;

/*!
 @brief Checks if the list of
 <code>org.apache.lucene.search.suggest.Lookup.LookupResult</code>s already has a
 <code>key</code>.
 If so, reorders that
 <code>org.apache.lucene.search.suggest.Lookup.LookupResult</code> to the first
 position.
 @return Returns <code>true<code> if and only if <code>list</code> contained
 <code>key</code>.
 */
- (jboolean)checkExistingAndReorderWithJavaUtilArrayList:(JavaUtilArrayList *)list
                         withOrgApacheLuceneUtilBytesRef:(OrgApacheLuceneUtilBytesRef *)key;

/*!
 @brief Descend along the path starting at <code>arc</code> and going through bytes
 in the argument.
 @param arc
 The starting arc. This argument is modified in-place.
 @param utf8
 The term to descend along.
 @return If <code>true</code>, <code>arc</code> will be set to the arc
 matching last byte of <code>term</code>. <code>false</code> is
 returned if no such prefix exists.
 */
- (jboolean)descendWithPrefixWithOrgApacheLuceneUtilFstFST_Arc:(OrgApacheLuceneUtilFstFST_Arc *)arc
                               withOrgApacheLuceneUtilBytesRef:(OrgApacheLuceneUtilBytesRef *)utf8;

/*!
 @brief Recursive collect lookup results from the automaton subgraph starting at
 <code>arc</code>.
 @param num
 Maximum number of results needed (early termination).
 */
- (jboolean)collectWithJavaUtilList:(id<JavaUtilList>)res
                            withInt:(jint)num
                            withInt:(jint)bucket
    withOrgApacheLuceneUtilBytesRef:(OrgApacheLuceneUtilBytesRef *)output
  withOrgApacheLuceneUtilFstFST_Arc:(OrgApacheLuceneUtilFstFST_Arc *)arc;

@end

J2OBJC_FIELD_SETTER(OrgApacheLuceneSearchSuggestFstFSTCompletion, automaton_, OrgApacheLuceneUtilFstFST *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneSearchSuggestFstFSTCompletion, rootArcs_, IOSObjectArray *)

/*!
 @brief An empty result.
 Keep this an <code>ArrayList</code> to keep all the returned
 lists of single type (monomorphic calls).
 */
inline JavaUtilArrayList *OrgApacheLuceneSearchSuggestFstFSTCompletion_get_EMPTY_RESULT();
static JavaUtilArrayList *OrgApacheLuceneSearchSuggestFstFSTCompletion_EMPTY_RESULT;
J2OBJC_STATIC_FIELD_OBJ_FINAL(OrgApacheLuceneSearchSuggestFstFSTCompletion, EMPTY_RESULT, JavaUtilArrayList *)

__attribute__((unused)) static IOSObjectArray *OrgApacheLuceneSearchSuggestFstFSTCompletion_cacheRootArcsWithOrgApacheLuceneUtilFstFST_(OrgApacheLuceneUtilFstFST *automaton);

__attribute__((unused)) static jint OrgApacheLuceneSearchSuggestFstFSTCompletion_getExactMatchStartingFromRootArcWithInt_withOrgApacheLuceneUtilBytesRef_(OrgApacheLuceneSearchSuggestFstFSTCompletion *self, jint rootArcIndex, OrgApacheLuceneUtilBytesRef *utf8);

__attribute__((unused)) static id<JavaUtilList> OrgApacheLuceneSearchSuggestFstFSTCompletion_lookupSortedAlphabeticallyWithOrgApacheLuceneUtilBytesRef_withInt_(OrgApacheLuceneSearchSuggestFstFSTCompletion *self, OrgApacheLuceneUtilBytesRef *key, jint num);

__attribute__((unused)) static JavaUtilArrayList *OrgApacheLuceneSearchSuggestFstFSTCompletion_lookupSortedByWeightWithOrgApacheLuceneUtilBytesRef_withInt_withBoolean_(OrgApacheLuceneSearchSuggestFstFSTCompletion *self, OrgApacheLuceneUtilBytesRef *key, jint num, jboolean collectAll);

__attribute__((unused)) static jboolean OrgApacheLuceneSearchSuggestFstFSTCompletion_checkExistingAndReorderWithJavaUtilArrayList_withOrgApacheLuceneUtilBytesRef_(OrgApacheLuceneSearchSuggestFstFSTCompletion *self, JavaUtilArrayList *list, OrgApacheLuceneUtilBytesRef *key);

__attribute__((unused)) static jboolean OrgApacheLuceneSearchSuggestFstFSTCompletion_descendWithPrefixWithOrgApacheLuceneUtilFstFST_Arc_withOrgApacheLuceneUtilBytesRef_(OrgApacheLuceneSearchSuggestFstFSTCompletion *self, OrgApacheLuceneUtilFstFST_Arc *arc, OrgApacheLuceneUtilBytesRef *utf8);

__attribute__((unused)) static jboolean OrgApacheLuceneSearchSuggestFstFSTCompletion_collectWithJavaUtilList_withInt_withInt_withOrgApacheLuceneUtilBytesRef_withOrgApacheLuceneUtilFstFST_Arc_(OrgApacheLuceneSearchSuggestFstFSTCompletion *self, id<JavaUtilList> res, jint num, jint bucket, OrgApacheLuceneUtilBytesRef *output, OrgApacheLuceneUtilFstFST_Arc *arc);

J2OBJC_INITIALIZED_DEFN(OrgApacheLuceneSearchSuggestFstFSTCompletion)

@implementation OrgApacheLuceneSearchSuggestFstFSTCompletion

+ (jint)DEFAULT_BUCKETS {
  return OrgApacheLuceneSearchSuggestFstFSTCompletion_DEFAULT_BUCKETS;
}

- (instancetype)initWithOrgApacheLuceneUtilFstFST:(OrgApacheLuceneUtilFstFST *)automaton
                                      withBoolean:(jboolean)higherWeightsFirst
                                      withBoolean:(jboolean)exactFirst {
  OrgApacheLuceneSearchSuggestFstFSTCompletion_initWithOrgApacheLuceneUtilFstFST_withBoolean_withBoolean_(self, automaton, higherWeightsFirst, exactFirst);
  return self;
}

- (instancetype)initWithOrgApacheLuceneUtilFstFST:(OrgApacheLuceneUtilFstFST *)automaton {
  OrgApacheLuceneSearchSuggestFstFSTCompletion_initWithOrgApacheLuceneUtilFstFST_(self, automaton);
  return self;
}

+ (IOSObjectArray *)cacheRootArcsWithOrgApacheLuceneUtilFstFST:(OrgApacheLuceneUtilFstFST *)automaton {
  return OrgApacheLuceneSearchSuggestFstFSTCompletion_cacheRootArcsWithOrgApacheLuceneUtilFstFST_(automaton);
}

- (jint)getExactMatchStartingFromRootArcWithInt:(jint)rootArcIndex
                withOrgApacheLuceneUtilBytesRef:(OrgApacheLuceneUtilBytesRef *)utf8 {
  return OrgApacheLuceneSearchSuggestFstFSTCompletion_getExactMatchStartingFromRootArcWithInt_withOrgApacheLuceneUtilBytesRef_(self, rootArcIndex, utf8);
}

- (id<JavaUtilList>)lookupWithJavaLangCharSequence:(id<JavaLangCharSequence>)key
                                           withInt:(jint)num {
  if ([((id<JavaLangCharSequence>) nil_chk(key)) length] == 0 || automaton_ == nil) {
    return OrgApacheLuceneSearchSuggestFstFSTCompletion_EMPTY_RESULT;
  }
  @try {
    OrgApacheLuceneUtilBytesRef *keyUtf8 = create_OrgApacheLuceneUtilBytesRef_initWithJavaLangCharSequence_(key);
    if (!higherWeightsFirst_ && ((IOSObjectArray *) nil_chk(rootArcs_))->size_ > 1) {
      return OrgApacheLuceneSearchSuggestFstFSTCompletion_lookupSortedAlphabeticallyWithOrgApacheLuceneUtilBytesRef_withInt_(self, keyUtf8, num);
    }
    else {
      return OrgApacheLuceneSearchSuggestFstFSTCompletion_lookupSortedByWeightWithOrgApacheLuceneUtilBytesRef_withInt_withBoolean_(self, keyUtf8, num, false);
    }
  }
  @catch (JavaIoIOException *e) {
    @throw create_JavaLangRuntimeException_initWithNSException_(e);
  }
}

- (id<JavaUtilList>)lookupSortedAlphabeticallyWithOrgApacheLuceneUtilBytesRef:(OrgApacheLuceneUtilBytesRef *)key
                                                                      withInt:(jint)num {
  return OrgApacheLuceneSearchSuggestFstFSTCompletion_lookupSortedAlphabeticallyWithOrgApacheLuceneUtilBytesRef_withInt_(self, key, num);
}

- (JavaUtilArrayList *)lookupSortedByWeightWithOrgApacheLuceneUtilBytesRef:(OrgApacheLuceneUtilBytesRef *)key
                                                                   withInt:(jint)num
                                                               withBoolean:(jboolean)collectAll {
  return OrgApacheLuceneSearchSuggestFstFSTCompletion_lookupSortedByWeightWithOrgApacheLuceneUtilBytesRef_withInt_withBoolean_(self, key, num, collectAll);
}

- (jboolean)checkExistingAndReorderWithJavaUtilArrayList:(JavaUtilArrayList *)list
                         withOrgApacheLuceneUtilBytesRef:(OrgApacheLuceneUtilBytesRef *)key {
  return OrgApacheLuceneSearchSuggestFstFSTCompletion_checkExistingAndReorderWithJavaUtilArrayList_withOrgApacheLuceneUtilBytesRef_(self, list, key);
}

- (jboolean)descendWithPrefixWithOrgApacheLuceneUtilFstFST_Arc:(OrgApacheLuceneUtilFstFST_Arc *)arc
                               withOrgApacheLuceneUtilBytesRef:(OrgApacheLuceneUtilBytesRef *)utf8 {
  return OrgApacheLuceneSearchSuggestFstFSTCompletion_descendWithPrefixWithOrgApacheLuceneUtilFstFST_Arc_withOrgApacheLuceneUtilBytesRef_(self, arc, utf8);
}

- (jboolean)collectWithJavaUtilList:(id<JavaUtilList>)res
                            withInt:(jint)num
                            withInt:(jint)bucket
    withOrgApacheLuceneUtilBytesRef:(OrgApacheLuceneUtilBytesRef *)output
  withOrgApacheLuceneUtilFstFST_Arc:(OrgApacheLuceneUtilFstFST_Arc *)arc {
  return OrgApacheLuceneSearchSuggestFstFSTCompletion_collectWithJavaUtilList_withInt_withInt_withOrgApacheLuceneUtilBytesRef_withOrgApacheLuceneUtilFstFST_Arc_(self, res, num, bucket, output, arc);
}

- (jint)getBucketCount {
  return ((IOSObjectArray *) nil_chk(rootArcs_))->size_;
}

- (jint)getBucketWithJavaLangCharSequence:(id<JavaLangCharSequence>)key {
  return OrgApacheLuceneSearchSuggestFstFSTCompletion_getExactMatchStartingFromRootArcWithInt_withOrgApacheLuceneUtilBytesRef_(self, 0, create_OrgApacheLuceneUtilBytesRef_initWithJavaLangCharSequence_(key));
}

- (OrgApacheLuceneUtilFstFST *)getFST {
  return automaton_;
}

- (void)dealloc {
  RELEASE_(automaton_);
  RELEASE_(rootArcs_);
  [super dealloc];
}

+ (void)initialize {
  if (self == [OrgApacheLuceneSearchSuggestFstFSTCompletion class]) {
    JreStrongAssignAndConsume(&OrgApacheLuceneSearchSuggestFstFSTCompletion_EMPTY_RESULT, new_JavaUtilArrayList_init());
    J2OBJC_SET_INITIALIZED(OrgApacheLuceneSearchSuggestFstFSTCompletion)
  }
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithOrgApacheLuceneUtilFstFST:withBoolean:withBoolean:", "FSTCompletion", NULL, 0x1, NULL, "(Lorg/apache/lucene/util/fst/FST<Ljava/lang/Object;>;ZZ)V" },
    { "initWithOrgApacheLuceneUtilFstFST:", "FSTCompletion", NULL, 0x1, NULL, "(Lorg/apache/lucene/util/fst/FST<Ljava/lang/Object;>;)V" },
    { "cacheRootArcsWithOrgApacheLuceneUtilFstFST:", "cacheRootArcs", "[Lorg.apache.lucene.util.fst.FST$Arc;", 0xa, NULL, "(Lorg/apache/lucene/util/fst/FST<Ljava/lang/Object;>;)[Lorg/apache/lucene/util/fst/FST$Arc<Ljava/lang/Object;>;" },
    { "getExactMatchStartingFromRootArcWithInt:withOrgApacheLuceneUtilBytesRef:", "getExactMatchStartingFromRootArc", "I", 0x2, NULL, NULL },
    { "lookupWithJavaLangCharSequence:withInt:", "lookup", "Ljava.util.List;", 0x1, NULL, "(Ljava/lang/CharSequence;I)Ljava/util/List<Lorg/apache/lucene/search/suggest/fst/FSTCompletion$Completion;>;" },
    { "lookupSortedAlphabeticallyWithOrgApacheLuceneUtilBytesRef:withInt:", "lookupSortedAlphabetically", "Ljava.util.List;", 0x2, "Ljava.io.IOException;", "(Lorg/apache/lucene/util/BytesRef;I)Ljava/util/List<Lorg/apache/lucene/search/suggest/fst/FSTCompletion$Completion;>;" },
    { "lookupSortedByWeightWithOrgApacheLuceneUtilBytesRef:withInt:withBoolean:", "lookupSortedByWeight", "Ljava.util.ArrayList;", 0x2, "Ljava.io.IOException;", "(Lorg/apache/lucene/util/BytesRef;IZ)Ljava/util/ArrayList<Lorg/apache/lucene/search/suggest/fst/FSTCompletion$Completion;>;" },
    { "checkExistingAndReorderWithJavaUtilArrayList:withOrgApacheLuceneUtilBytesRef:", "checkExistingAndReorder", "Z", 0x2, NULL, "(Ljava/util/ArrayList<Lorg/apache/lucene/search/suggest/fst/FSTCompletion$Completion;>;Lorg/apache/lucene/util/BytesRef;)Z" },
    { "descendWithPrefixWithOrgApacheLuceneUtilFstFST_Arc:withOrgApacheLuceneUtilBytesRef:", "descendWithPrefix", "Z", 0x2, "Ljava.io.IOException;", "(Lorg/apache/lucene/util/fst/FST$Arc<Ljava/lang/Object;>;Lorg/apache/lucene/util/BytesRef;)Z" },
    { "collectWithJavaUtilList:withInt:withInt:withOrgApacheLuceneUtilBytesRef:withOrgApacheLuceneUtilFstFST_Arc:", "collect", "Z", 0x2, "Ljava.io.IOException;", "(Ljava/util/List<Lorg/apache/lucene/search/suggest/fst/FSTCompletion$Completion;>;IILorg/apache/lucene/util/BytesRef;Lorg/apache/lucene/util/fst/FST$Arc<Ljava/lang/Object;>;)Z" },
    { "getBucketCount", NULL, "I", 0x1, NULL, NULL },
    { "getBucketWithJavaLangCharSequence:", "getBucket", "I", 0x1, NULL, NULL },
    { "getFST", NULL, "Lorg.apache.lucene.util.fst.FST;", 0x1, NULL, "()Lorg/apache/lucene/util/fst/FST<Ljava/lang/Object;>;" },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "DEFAULT_BUCKETS", "DEFAULT_BUCKETS", 0x19, "I", NULL, NULL, .constantValue.asInt = OrgApacheLuceneSearchSuggestFstFSTCompletion_DEFAULT_BUCKETS },
    { "EMPTY_RESULT", "EMPTY_RESULT", 0x1a, "Ljava.util.ArrayList;", &OrgApacheLuceneSearchSuggestFstFSTCompletion_EMPTY_RESULT, "Ljava/util/ArrayList<Lorg/apache/lucene/search/suggest/fst/FSTCompletion$Completion;>;", .constantValue.asLong = 0 },
    { "automaton_", NULL, 0x12, "Lorg.apache.lucene.util.fst.FST;", NULL, "Lorg/apache/lucene/util/fst/FST<Ljava/lang/Object;>;", .constantValue.asLong = 0 },
    { "rootArcs_", NULL, 0x12, "[Lorg.apache.lucene.util.fst.FST$Arc;", NULL, "[Lorg/apache/lucene/util/fst/FST$Arc<Ljava/lang/Object;>;", .constantValue.asLong = 0 },
    { "exactFirst_", NULL, 0x2, "Z", NULL, NULL, .constantValue.asLong = 0 },
    { "higherWeightsFirst_", NULL, 0x2, "Z", NULL, NULL, .constantValue.asLong = 0 },
  };
  static const char *inner_classes[] = {"Lorg.apache.lucene.search.suggest.fst.FSTCompletion$Completion;"};
  static const J2ObjcClassInfo _OrgApacheLuceneSearchSuggestFstFSTCompletion = { 2, "FSTCompletion", "org.apache.lucene.search.suggest.fst", NULL, 0x1, 13, methods, 6, fields, 0, NULL, 1, inner_classes, NULL, NULL };
  return &_OrgApacheLuceneSearchSuggestFstFSTCompletion;
}

@end

void OrgApacheLuceneSearchSuggestFstFSTCompletion_initWithOrgApacheLuceneUtilFstFST_withBoolean_withBoolean_(OrgApacheLuceneSearchSuggestFstFSTCompletion *self, OrgApacheLuceneUtilFstFST *automaton, jboolean higherWeightsFirst, jboolean exactFirst) {
  NSObject_init(self);
  JreStrongAssign(&self->automaton_, automaton);
  if (automaton != nil) {
    JreStrongAssign(&self->rootArcs_, OrgApacheLuceneSearchSuggestFstFSTCompletion_cacheRootArcsWithOrgApacheLuceneUtilFstFST_(automaton));
  }
  else {
    JreStrongAssignAndConsume(&self->rootArcs_, [IOSObjectArray newArrayWithLength:0 type:OrgApacheLuceneUtilFstFST_Arc_class_()]);
  }
  self->higherWeightsFirst_ = higherWeightsFirst;
  self->exactFirst_ = exactFirst;
}

OrgApacheLuceneSearchSuggestFstFSTCompletion *new_OrgApacheLuceneSearchSuggestFstFSTCompletion_initWithOrgApacheLuceneUtilFstFST_withBoolean_withBoolean_(OrgApacheLuceneUtilFstFST *automaton, jboolean higherWeightsFirst, jboolean exactFirst) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneSearchSuggestFstFSTCompletion, initWithOrgApacheLuceneUtilFstFST_withBoolean_withBoolean_, automaton, higherWeightsFirst, exactFirst)
}

OrgApacheLuceneSearchSuggestFstFSTCompletion *create_OrgApacheLuceneSearchSuggestFstFSTCompletion_initWithOrgApacheLuceneUtilFstFST_withBoolean_withBoolean_(OrgApacheLuceneUtilFstFST *automaton, jboolean higherWeightsFirst, jboolean exactFirst) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneSearchSuggestFstFSTCompletion, initWithOrgApacheLuceneUtilFstFST_withBoolean_withBoolean_, automaton, higherWeightsFirst, exactFirst)
}

void OrgApacheLuceneSearchSuggestFstFSTCompletion_initWithOrgApacheLuceneUtilFstFST_(OrgApacheLuceneSearchSuggestFstFSTCompletion *self, OrgApacheLuceneUtilFstFST *automaton) {
  OrgApacheLuceneSearchSuggestFstFSTCompletion_initWithOrgApacheLuceneUtilFstFST_withBoolean_withBoolean_(self, automaton, true, true);
}

OrgApacheLuceneSearchSuggestFstFSTCompletion *new_OrgApacheLuceneSearchSuggestFstFSTCompletion_initWithOrgApacheLuceneUtilFstFST_(OrgApacheLuceneUtilFstFST *automaton) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneSearchSuggestFstFSTCompletion, initWithOrgApacheLuceneUtilFstFST_, automaton)
}

OrgApacheLuceneSearchSuggestFstFSTCompletion *create_OrgApacheLuceneSearchSuggestFstFSTCompletion_initWithOrgApacheLuceneUtilFstFST_(OrgApacheLuceneUtilFstFST *automaton) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneSearchSuggestFstFSTCompletion, initWithOrgApacheLuceneUtilFstFST_, automaton)
}

IOSObjectArray *OrgApacheLuceneSearchSuggestFstFSTCompletion_cacheRootArcsWithOrgApacheLuceneUtilFstFST_(OrgApacheLuceneUtilFstFST *automaton) {
  OrgApacheLuceneSearchSuggestFstFSTCompletion_initialize();
  @try {
    id<JavaUtilList> rootArcs = create_JavaUtilArrayList_init();
    OrgApacheLuceneUtilFstFST_Arc *arc = [((OrgApacheLuceneUtilFstFST *) nil_chk(automaton)) getFirstArcWithOrgApacheLuceneUtilFstFST_Arc:create_OrgApacheLuceneUtilFstFST_Arc_init()];
    OrgApacheLuceneUtilFstFST_BytesReader *fstReader = [automaton getBytesReader];
    [automaton readFirstTargetArcWithOrgApacheLuceneUtilFstFST_Arc:arc withOrgApacheLuceneUtilFstFST_Arc:arc withOrgApacheLuceneUtilFstFST_BytesReader:fstReader];
    while (true) {
      [rootArcs addWithId:[create_OrgApacheLuceneUtilFstFST_Arc_init() copyFromWithOrgApacheLuceneUtilFstFST_Arc:arc]];
      if ([((OrgApacheLuceneUtilFstFST_Arc *) nil_chk(arc)) isLast]) break;
      [automaton readNextArcWithOrgApacheLuceneUtilFstFST_Arc:arc withOrgApacheLuceneUtilFstFST_BytesReader:fstReader];
    }
    JavaUtilCollections_reverseWithJavaUtilList_(rootArcs);
    return [rootArcs toArrayWithNSObjectArray:[IOSObjectArray arrayWithLength:[rootArcs size] type:OrgApacheLuceneUtilFstFST_Arc_class_()]];
  }
  @catch (JavaIoIOException *e) {
    @throw create_JavaLangRuntimeException_initWithNSException_(e);
  }
}

jint OrgApacheLuceneSearchSuggestFstFSTCompletion_getExactMatchStartingFromRootArcWithInt_withOrgApacheLuceneUtilBytesRef_(OrgApacheLuceneSearchSuggestFstFSTCompletion *self, jint rootArcIndex, OrgApacheLuceneUtilBytesRef *utf8) {
  @try {
    OrgApacheLuceneUtilFstFST_Arc *scratch = create_OrgApacheLuceneUtilFstFST_Arc_init();
    OrgApacheLuceneUtilFstFST_BytesReader *fstReader = [((OrgApacheLuceneUtilFstFST *) nil_chk(self->automaton_)) getBytesReader];
    for (; rootArcIndex < ((IOSObjectArray *) nil_chk(self->rootArcs_))->size_; rootArcIndex++) {
      OrgApacheLuceneUtilFstFST_Arc *rootArc = IOSObjectArray_Get(self->rootArcs_, rootArcIndex);
      OrgApacheLuceneUtilFstFST_Arc *arc = [scratch copyFromWithOrgApacheLuceneUtilFstFST_Arc:rootArc];
      if (OrgApacheLuceneSearchSuggestFstFSTCompletion_descendWithPrefixWithOrgApacheLuceneUtilFstFST_Arc_withOrgApacheLuceneUtilBytesRef_(self, arc, utf8)) {
        [self->automaton_ readFirstTargetArcWithOrgApacheLuceneUtilFstFST_Arc:arc withOrgApacheLuceneUtilFstFST_Arc:arc withOrgApacheLuceneUtilFstFST_BytesReader:fstReader];
        if (((OrgApacheLuceneUtilFstFST_Arc *) nil_chk(arc))->label_ == OrgApacheLuceneUtilFstFST_END_LABEL) {
          return ((OrgApacheLuceneUtilFstFST_Arc *) nil_chk(rootArc))->label_;
        }
      }
    }
  }
  @catch (JavaIoIOException *e) {
    @throw create_JavaLangRuntimeException_initWithNSException_(e);
  }
  return -1;
}

id<JavaUtilList> OrgApacheLuceneSearchSuggestFstFSTCompletion_lookupSortedAlphabeticallyWithOrgApacheLuceneUtilBytesRef_withInt_(OrgApacheLuceneSearchSuggestFstFSTCompletion *self, OrgApacheLuceneUtilBytesRef *key, jint num) {
  id<JavaUtilList> res = OrgApacheLuceneSearchSuggestFstFSTCompletion_lookupSortedByWeightWithOrgApacheLuceneUtilBytesRef_withInt_withBoolean_(self, key, num, true);
  JavaUtilCollections_sortWithJavaUtilList_(res);
  if ([((id<JavaUtilList>) nil_chk(res)) size] > num) {
    res = [res subListWithInt:0 withInt:num];
  }
  return res;
}

JavaUtilArrayList *OrgApacheLuceneSearchSuggestFstFSTCompletion_lookupSortedByWeightWithOrgApacheLuceneUtilBytesRef_withInt_withBoolean_(OrgApacheLuceneSearchSuggestFstFSTCompletion *self, OrgApacheLuceneUtilBytesRef *key, jint num, jboolean collectAll) {
  JavaUtilArrayList *res = create_JavaUtilArrayList_initWithInt_(JavaLangMath_minWithInt_withInt_(10, num));
  OrgApacheLuceneUtilBytesRef *output = OrgApacheLuceneUtilBytesRef_deepCopyOfWithOrgApacheLuceneUtilBytesRef_(key);
  for (jint i = 0; i < ((IOSObjectArray *) nil_chk(self->rootArcs_))->size_; i++) {
    OrgApacheLuceneUtilFstFST_Arc *rootArc = IOSObjectArray_Get(self->rootArcs_, i);
    OrgApacheLuceneUtilFstFST_Arc *arc = [create_OrgApacheLuceneUtilFstFST_Arc_init() copyFromWithOrgApacheLuceneUtilFstFST_Arc:rootArc];
    if (OrgApacheLuceneSearchSuggestFstFSTCompletion_descendWithPrefixWithOrgApacheLuceneUtilFstFST_Arc_withOrgApacheLuceneUtilBytesRef_(self, arc, key)) {
      ((OrgApacheLuceneUtilBytesRef *) nil_chk(output))->length_ = ((OrgApacheLuceneUtilBytesRef *) nil_chk(key))->length_ - 1;
      if (OrgApacheLuceneSearchSuggestFstFSTCompletion_collectWithJavaUtilList_withInt_withInt_withOrgApacheLuceneUtilBytesRef_withOrgApacheLuceneUtilFstFST_Arc_(self, res, num, ((OrgApacheLuceneUtilFstFST_Arc *) nil_chk(rootArc))->label_, output, arc) && !collectAll) {
        if (self->exactFirst_) {
          if (!OrgApacheLuceneSearchSuggestFstFSTCompletion_checkExistingAndReorderWithJavaUtilArrayList_withOrgApacheLuceneUtilBytesRef_(self, res, key)) {
            jint exactMatchBucket = OrgApacheLuceneSearchSuggestFstFSTCompletion_getExactMatchStartingFromRootArcWithInt_withOrgApacheLuceneUtilBytesRef_(self, i, key);
            if (exactMatchBucket != -1) {
              while ([res size] >= num) {
                [res removeWithInt:[res size] - 1];
              }
              [res addWithInt:0 withId:create_OrgApacheLuceneSearchSuggestFstFSTCompletion_Completion_initWithOrgApacheLuceneUtilBytesRef_withInt_(key, exactMatchBucket)];
            }
          }
        }
        break;
      }
    }
  }
  return res;
}

jboolean OrgApacheLuceneSearchSuggestFstFSTCompletion_checkExistingAndReorderWithJavaUtilArrayList_withOrgApacheLuceneUtilBytesRef_(OrgApacheLuceneSearchSuggestFstFSTCompletion *self, JavaUtilArrayList *list, OrgApacheLuceneUtilBytesRef *key) {
  for (jint i = [((JavaUtilArrayList *) nil_chk(list)) size]; --i >= 0; ) {
    if ([((OrgApacheLuceneUtilBytesRef *) nil_chk(key)) isEqual:((OrgApacheLuceneSearchSuggestFstFSTCompletion_Completion *) nil_chk([list getWithInt:i]))->utf8_]) {
      [list addWithInt:0 withId:[list removeWithInt:i]];
      return true;
    }
  }
  return false;
}

jboolean OrgApacheLuceneSearchSuggestFstFSTCompletion_descendWithPrefixWithOrgApacheLuceneUtilFstFST_Arc_withOrgApacheLuceneUtilBytesRef_(OrgApacheLuceneSearchSuggestFstFSTCompletion *self, OrgApacheLuceneUtilFstFST_Arc *arc, OrgApacheLuceneUtilBytesRef *utf8) {
  jint max = ((OrgApacheLuceneUtilBytesRef *) nil_chk(utf8))->offset_ + utf8->length_;
  OrgApacheLuceneUtilFstFST_BytesReader *fstReader = [((OrgApacheLuceneUtilFstFST *) nil_chk(self->automaton_)) getBytesReader];
  for (jint i = utf8->offset_; i < max; i++) {
    if ([self->automaton_ findTargetArcWithInt:IOSByteArray_Get(nil_chk(utf8->bytes_), i) & (jint) 0xff withOrgApacheLuceneUtilFstFST_Arc:arc withOrgApacheLuceneUtilFstFST_Arc:arc withOrgApacheLuceneUtilFstFST_BytesReader:fstReader] == nil) {
      return false;
    }
  }
  return true;
}

jboolean OrgApacheLuceneSearchSuggestFstFSTCompletion_collectWithJavaUtilList_withInt_withInt_withOrgApacheLuceneUtilBytesRef_withOrgApacheLuceneUtilFstFST_Arc_(OrgApacheLuceneSearchSuggestFstFSTCompletion *self, id<JavaUtilList> res, jint num, jint bucket, OrgApacheLuceneUtilBytesRef *output, OrgApacheLuceneUtilFstFST_Arc *arc) {
  if (((OrgApacheLuceneUtilBytesRef *) nil_chk(output))->length_ == ((IOSByteArray *) nil_chk(output->bytes_))->size_) {
    JreStrongAssign(&output->bytes_, OrgApacheLuceneUtilArrayUtil_growWithByteArray_(output->bytes_));
  }
  JreAssert((output->offset_ == 0), (@"org/apache/lucene/search/suggest/fst/FSTCompletion.java:363 condition failed: assert output.offset == 0;"));
  *IOSByteArray_GetRef(nil_chk(output->bytes_), output->length_++) = (jbyte) ((OrgApacheLuceneUtilFstFST_Arc *) nil_chk(arc))->label_;
  OrgApacheLuceneUtilFstFST_BytesReader *fstReader = [((OrgApacheLuceneUtilFstFST *) nil_chk(self->automaton_)) getBytesReader];
  [self->automaton_ readFirstTargetArcWithOrgApacheLuceneUtilFstFST_Arc:arc withOrgApacheLuceneUtilFstFST_Arc:arc withOrgApacheLuceneUtilFstFST_BytesReader:fstReader];
  while (true) {
    if (arc->label_ == OrgApacheLuceneUtilFstFST_END_LABEL) {
      [((id<JavaUtilList>) nil_chk(res)) addWithId:create_OrgApacheLuceneSearchSuggestFstFSTCompletion_Completion_initWithOrgApacheLuceneUtilBytesRef_withInt_(output, bucket)];
      if ([res size] >= num) return true;
    }
    else {
      jint save = output->length_;
      if (OrgApacheLuceneSearchSuggestFstFSTCompletion_collectWithJavaUtilList_withInt_withInt_withOrgApacheLuceneUtilBytesRef_withOrgApacheLuceneUtilFstFST_Arc_(self, res, num, bucket, output, [create_OrgApacheLuceneUtilFstFST_Arc_init() copyFromWithOrgApacheLuceneUtilFstFST_Arc:arc])) {
        return true;
      }
      output->length_ = save;
    }
    if ([arc isLast]) {
      break;
    }
    [self->automaton_ readNextArcWithOrgApacheLuceneUtilFstFST_Arc:arc withOrgApacheLuceneUtilFstFST_BytesReader:fstReader];
  }
  return false;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneSearchSuggestFstFSTCompletion)

@implementation OrgApacheLuceneSearchSuggestFstFSTCompletion_Completion

- (instancetype)initWithOrgApacheLuceneUtilBytesRef:(OrgApacheLuceneUtilBytesRef *)key
                                            withInt:(jint)bucket {
  OrgApacheLuceneSearchSuggestFstFSTCompletion_Completion_initWithOrgApacheLuceneUtilBytesRef_withInt_(self, key, bucket);
  return self;
}

- (NSString *)description {
  return JreStrcat("$CI", [((OrgApacheLuceneUtilBytesRef *) nil_chk(utf8_)) utf8ToString], '/', bucket_);
}

- (jint)compareToWithId:(OrgApacheLuceneSearchSuggestFstFSTCompletion_Completion *)o {
  cast_chk(o, [OrgApacheLuceneSearchSuggestFstFSTCompletion_Completion class]);
  return [((OrgApacheLuceneUtilBytesRef *) nil_chk(self->utf8_)) compareToWithId:((OrgApacheLuceneSearchSuggestFstFSTCompletion_Completion *) nil_chk(o))->utf8_];
}

- (void)dealloc {
  RELEASE_(utf8_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithOrgApacheLuceneUtilBytesRef:withInt:", "Completion", NULL, 0x0, NULL, NULL },
    { "description", "toString", "Ljava.lang.String;", 0x1, NULL, NULL },
    { "compareToWithId:", "compareTo", "I", 0x1, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "utf8_", NULL, 0x11, "Lorg.apache.lucene.util.BytesRef;", NULL, NULL, .constantValue.asLong = 0 },
    { "bucket_", NULL, 0x11, "I", NULL, NULL, .constantValue.asLong = 0 },
  };
  static const J2ObjcClassInfo _OrgApacheLuceneSearchSuggestFstFSTCompletion_Completion = { 2, "Completion", "org.apache.lucene.search.suggest.fst", "FSTCompletion", 0x19, 3, methods, 2, fields, 0, NULL, 0, NULL, NULL, "Ljava/lang/Object;Ljava/lang/Comparable<Lorg/apache/lucene/search/suggest/fst/FSTCompletion$Completion;>;" };
  return &_OrgApacheLuceneSearchSuggestFstFSTCompletion_Completion;
}

@end

void OrgApacheLuceneSearchSuggestFstFSTCompletion_Completion_initWithOrgApacheLuceneUtilBytesRef_withInt_(OrgApacheLuceneSearchSuggestFstFSTCompletion_Completion *self, OrgApacheLuceneUtilBytesRef *key, jint bucket) {
  NSObject_init(self);
  JreStrongAssign(&self->utf8_, OrgApacheLuceneUtilBytesRef_deepCopyOfWithOrgApacheLuceneUtilBytesRef_(key));
  self->bucket_ = bucket;
}

OrgApacheLuceneSearchSuggestFstFSTCompletion_Completion *new_OrgApacheLuceneSearchSuggestFstFSTCompletion_Completion_initWithOrgApacheLuceneUtilBytesRef_withInt_(OrgApacheLuceneUtilBytesRef *key, jint bucket) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneSearchSuggestFstFSTCompletion_Completion, initWithOrgApacheLuceneUtilBytesRef_withInt_, key, bucket)
}

OrgApacheLuceneSearchSuggestFstFSTCompletion_Completion *create_OrgApacheLuceneSearchSuggestFstFSTCompletion_Completion_initWithOrgApacheLuceneUtilBytesRef_withInt_(OrgApacheLuceneUtilBytesRef *key, jint bucket) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneSearchSuggestFstFSTCompletion_Completion, initWithOrgApacheLuceneUtilBytesRef_withInt_, key, bucket)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneSearchSuggestFstFSTCompletion_Completion)
