//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: ./suggest/src/java/org/apache/lucene/search/suggest/DocumentValueSourceDictionary.java
//

#include "IOSClass.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "java/io/IOException.h"
#include "java/lang/RuntimeException.h"
#include "java/util/HashMap.h"
#include "java/util/List.h"
#include "org/apache/lucene/document/Document.h"
#include "org/apache/lucene/index/IndexReader.h"
#include "org/apache/lucene/index/LeafReaderContext.h"
#include "org/apache/lucene/index/ReaderUtil.h"
#include "org/apache/lucene/queries/function/FunctionValues.h"
#include "org/apache/lucene/queries/function/ValueSource.h"
#include "org/apache/lucene/search/suggest/DocumentDictionary.h"
#include "org/apache/lucene/search/suggest/DocumentValueSourceDictionary.h"
#include "org/apache/lucene/search/suggest/InputIterator.h"

@interface OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary () {
 @public
  OrgApacheLuceneQueriesFunctionValueSource *weightsValueSource_;
}

@end

J2OBJC_FIELD_SETTER(OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary, weightsValueSource_, OrgApacheLuceneQueriesFunctionValueSource *)

@interface OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary_DocumentValueSourceInputIterator () {
 @public
  OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary *this$1_;
  OrgApacheLuceneQueriesFunctionFunctionValues *currentWeightValues_;
  /*!
   @brief leaves of the reader
   */
  id<JavaUtilList> leaves_;
  /*!
   @brief starting docIds of all the leaves
   */
  IOSIntArray *starts_;
  /*!
   @brief current leave index
   */
  jint currentLeafIndex_;
}

@end

J2OBJC_FIELD_SETTER(OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary_DocumentValueSourceInputIterator, this$1_, OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary_DocumentValueSourceInputIterator, currentWeightValues_, OrgApacheLuceneQueriesFunctionFunctionValues *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary_DocumentValueSourceInputIterator, leaves_, id<JavaUtilList>)
J2OBJC_FIELD_SETTER(OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary_DocumentValueSourceInputIterator, starts_, IOSIntArray *)

@implementation OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary

- (instancetype)initWithOrgApacheLuceneIndexIndexReader:(OrgApacheLuceneIndexIndexReader *)reader
                                           withNSString:(NSString *)field
          withOrgApacheLuceneQueriesFunctionValueSource:(OrgApacheLuceneQueriesFunctionValueSource *)weightsValueSource
                                           withNSString:(NSString *)payload
                                           withNSString:(NSString *)contexts {
  OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary_initWithOrgApacheLuceneIndexIndexReader_withNSString_withOrgApacheLuceneQueriesFunctionValueSource_withNSString_withNSString_(self, reader, field, weightsValueSource, payload, contexts);
  return self;
}

- (instancetype)initWithOrgApacheLuceneIndexIndexReader:(OrgApacheLuceneIndexIndexReader *)reader
                                           withNSString:(NSString *)field
          withOrgApacheLuceneQueriesFunctionValueSource:(OrgApacheLuceneQueriesFunctionValueSource *)weightsValueSource
                                           withNSString:(NSString *)payload {
  OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary_initWithOrgApacheLuceneIndexIndexReader_withNSString_withOrgApacheLuceneQueriesFunctionValueSource_withNSString_(self, reader, field, weightsValueSource, payload);
  return self;
}

- (instancetype)initWithOrgApacheLuceneIndexIndexReader:(OrgApacheLuceneIndexIndexReader *)reader
                                           withNSString:(NSString *)field
          withOrgApacheLuceneQueriesFunctionValueSource:(OrgApacheLuceneQueriesFunctionValueSource *)weightsValueSource {
  OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary_initWithOrgApacheLuceneIndexIndexReader_withNSString_withOrgApacheLuceneQueriesFunctionValueSource_(self, reader, field, weightsValueSource);
  return self;
}

- (id<OrgApacheLuceneSearchSuggestInputIterator>)getEntryIterator {
  return create_OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary_DocumentValueSourceInputIterator_initWithOrgApacheLuceneSearchSuggestDocumentValueSourceDictionary_withBoolean_withBoolean_(self, payloadField_ != nil, contextsField_ != nil);
}

- (void)dealloc {
  RELEASE_(weightsValueSource_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithOrgApacheLuceneIndexIndexReader:withNSString:withOrgApacheLuceneQueriesFunctionValueSource:withNSString:withNSString:", "DocumentValueSourceDictionary", NULL, 0x1, NULL, NULL },
    { "initWithOrgApacheLuceneIndexIndexReader:withNSString:withOrgApacheLuceneQueriesFunctionValueSource:withNSString:", "DocumentValueSourceDictionary", NULL, 0x1, NULL, NULL },
    { "initWithOrgApacheLuceneIndexIndexReader:withNSString:withOrgApacheLuceneQueriesFunctionValueSource:", "DocumentValueSourceDictionary", NULL, 0x1, NULL, NULL },
    { "getEntryIterator", NULL, "Lorg.apache.lucene.search.suggest.InputIterator;", 0x1, "Ljava.io.IOException;", NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "weightsValueSource_", NULL, 0x12, "Lorg.apache.lucene.queries.function.ValueSource;", NULL, NULL, .constantValue.asLong = 0 },
  };
  static const char *inner_classes[] = {"Lorg.apache.lucene.search.suggest.DocumentValueSourceDictionary$DocumentValueSourceInputIterator;"};
  static const J2ObjcClassInfo _OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary = { 2, "DocumentValueSourceDictionary", "org.apache.lucene.search.suggest", NULL, 0x1, 4, methods, 1, fields, 0, NULL, 1, inner_classes, NULL, NULL };
  return &_OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary;
}

@end

void OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary_initWithOrgApacheLuceneIndexIndexReader_withNSString_withOrgApacheLuceneQueriesFunctionValueSource_withNSString_withNSString_(OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary *self, OrgApacheLuceneIndexIndexReader *reader, NSString *field, OrgApacheLuceneQueriesFunctionValueSource *weightsValueSource, NSString *payload, NSString *contexts) {
  OrgApacheLuceneSearchSuggestDocumentDictionary_initWithOrgApacheLuceneIndexIndexReader_withNSString_withNSString_withNSString_withNSString_(self, reader, field, nil, payload, contexts);
  JreStrongAssign(&self->weightsValueSource_, weightsValueSource);
}

OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary *new_OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary_initWithOrgApacheLuceneIndexIndexReader_withNSString_withOrgApacheLuceneQueriesFunctionValueSource_withNSString_withNSString_(OrgApacheLuceneIndexIndexReader *reader, NSString *field, OrgApacheLuceneQueriesFunctionValueSource *weightsValueSource, NSString *payload, NSString *contexts) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary, initWithOrgApacheLuceneIndexIndexReader_withNSString_withOrgApacheLuceneQueriesFunctionValueSource_withNSString_withNSString_, reader, field, weightsValueSource, payload, contexts)
}

OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary *create_OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary_initWithOrgApacheLuceneIndexIndexReader_withNSString_withOrgApacheLuceneQueriesFunctionValueSource_withNSString_withNSString_(OrgApacheLuceneIndexIndexReader *reader, NSString *field, OrgApacheLuceneQueriesFunctionValueSource *weightsValueSource, NSString *payload, NSString *contexts) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary, initWithOrgApacheLuceneIndexIndexReader_withNSString_withOrgApacheLuceneQueriesFunctionValueSource_withNSString_withNSString_, reader, field, weightsValueSource, payload, contexts)
}

void OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary_initWithOrgApacheLuceneIndexIndexReader_withNSString_withOrgApacheLuceneQueriesFunctionValueSource_withNSString_(OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary *self, OrgApacheLuceneIndexIndexReader *reader, NSString *field, OrgApacheLuceneQueriesFunctionValueSource *weightsValueSource, NSString *payload) {
  OrgApacheLuceneSearchSuggestDocumentDictionary_initWithOrgApacheLuceneIndexIndexReader_withNSString_withNSString_withNSString_(self, reader, field, nil, payload);
  JreStrongAssign(&self->weightsValueSource_, weightsValueSource);
}

OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary *new_OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary_initWithOrgApacheLuceneIndexIndexReader_withNSString_withOrgApacheLuceneQueriesFunctionValueSource_withNSString_(OrgApacheLuceneIndexIndexReader *reader, NSString *field, OrgApacheLuceneQueriesFunctionValueSource *weightsValueSource, NSString *payload) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary, initWithOrgApacheLuceneIndexIndexReader_withNSString_withOrgApacheLuceneQueriesFunctionValueSource_withNSString_, reader, field, weightsValueSource, payload)
}

OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary *create_OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary_initWithOrgApacheLuceneIndexIndexReader_withNSString_withOrgApacheLuceneQueriesFunctionValueSource_withNSString_(OrgApacheLuceneIndexIndexReader *reader, NSString *field, OrgApacheLuceneQueriesFunctionValueSource *weightsValueSource, NSString *payload) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary, initWithOrgApacheLuceneIndexIndexReader_withNSString_withOrgApacheLuceneQueriesFunctionValueSource_withNSString_, reader, field, weightsValueSource, payload)
}

void OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary_initWithOrgApacheLuceneIndexIndexReader_withNSString_withOrgApacheLuceneQueriesFunctionValueSource_(OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary *self, OrgApacheLuceneIndexIndexReader *reader, NSString *field, OrgApacheLuceneQueriesFunctionValueSource *weightsValueSource) {
  OrgApacheLuceneSearchSuggestDocumentDictionary_initWithOrgApacheLuceneIndexIndexReader_withNSString_withNSString_withNSString_(self, reader, field, nil, nil);
  JreStrongAssign(&self->weightsValueSource_, weightsValueSource);
}

OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary *new_OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary_initWithOrgApacheLuceneIndexIndexReader_withNSString_withOrgApacheLuceneQueriesFunctionValueSource_(OrgApacheLuceneIndexIndexReader *reader, NSString *field, OrgApacheLuceneQueriesFunctionValueSource *weightsValueSource) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary, initWithOrgApacheLuceneIndexIndexReader_withNSString_withOrgApacheLuceneQueriesFunctionValueSource_, reader, field, weightsValueSource)
}

OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary *create_OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary_initWithOrgApacheLuceneIndexIndexReader_withNSString_withOrgApacheLuceneQueriesFunctionValueSource_(OrgApacheLuceneIndexIndexReader *reader, NSString *field, OrgApacheLuceneQueriesFunctionValueSource *weightsValueSource) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary, initWithOrgApacheLuceneIndexIndexReader_withNSString_withOrgApacheLuceneQueriesFunctionValueSource_, reader, field, weightsValueSource)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary)

@implementation OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary_DocumentValueSourceInputIterator

- (instancetype)initWithOrgApacheLuceneSearchSuggestDocumentValueSourceDictionary:(OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary *)outer$
                                                                      withBoolean:(jboolean)hasPayloads
                                                                      withBoolean:(jboolean)hasContexts {
  OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary_DocumentValueSourceInputIterator_initWithOrgApacheLuceneSearchSuggestDocumentValueSourceDictionary_withBoolean_withBoolean_(self, outer$, hasPayloads, hasContexts);
  return self;
}

- (jlong)getWeightWithOrgApacheLuceneDocumentDocument:(OrgApacheLuceneDocumentDocument *)doc
                                              withInt:(jint)docId {
  if (currentWeightValues_ == nil) {
    return 0;
  }
  jint subIndex = OrgApacheLuceneIndexReaderUtil_subIndexWithInt_withIntArray_(docId, starts_);
  if (subIndex != currentLeafIndex_) {
    currentLeafIndex_ = subIndex;
    @try {
      JreStrongAssign(&currentWeightValues_, [((OrgApacheLuceneQueriesFunctionValueSource *) nil_chk(this$1_->weightsValueSource_)) getValuesWithJavaUtilMap:create_JavaUtilHashMap_init() withOrgApacheLuceneIndexLeafReaderContext:[((id<JavaUtilList>) nil_chk(leaves_)) getWithInt:currentLeafIndex_]]);
    }
    @catch (JavaIoIOException *e) {
      @throw create_JavaLangRuntimeException_initWithNSException_(e);
    }
  }
  return [((OrgApacheLuceneQueriesFunctionFunctionValues *) nil_chk(currentWeightValues_)) longValWithInt:docId - IOSIntArray_Get(nil_chk(starts_), subIndex)];
}

- (void)dealloc {
  RELEASE_(this$1_);
  RELEASE_(currentWeightValues_);
  RELEASE_(leaves_);
  RELEASE_(starts_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithOrgApacheLuceneSearchSuggestDocumentValueSourceDictionary:withBoolean:withBoolean:", "DocumentValueSourceInputIterator", NULL, 0x1, NULL, NULL },
    { "getWeightWithOrgApacheLuceneDocumentDocument:withInt:", "getWeight", "J", 0x4, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "this$1_", NULL, 0x1012, "Lorg.apache.lucene.search.suggest.DocumentValueSourceDictionary;", NULL, NULL, .constantValue.asLong = 0 },
    { "currentWeightValues_", NULL, 0x2, "Lorg.apache.lucene.queries.function.FunctionValues;", NULL, NULL, .constantValue.asLong = 0 },
    { "leaves_", NULL, 0x12, "Ljava.util.List;", NULL, "Ljava/util/List<Lorg/apache/lucene/index/LeafReaderContext;>;", .constantValue.asLong = 0 },
    { "starts_", NULL, 0x12, "[I", NULL, NULL, .constantValue.asLong = 0 },
    { "currentLeafIndex_", NULL, 0x2, "I", NULL, NULL, .constantValue.asLong = 0 },
  };
  static const J2ObjcClassInfo _OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary_DocumentValueSourceInputIterator = { 2, "DocumentValueSourceInputIterator", "org.apache.lucene.search.suggest", "DocumentValueSourceDictionary", 0x10, 2, methods, 5, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary_DocumentValueSourceInputIterator;
}

@end

void OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary_DocumentValueSourceInputIterator_initWithOrgApacheLuceneSearchSuggestDocumentValueSourceDictionary_withBoolean_withBoolean_(OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary_DocumentValueSourceInputIterator *self, OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary *outer$, jboolean hasPayloads, jboolean hasContexts) {
  JreStrongAssign(&self->this$1_, outer$);
  OrgApacheLuceneSearchSuggestDocumentDictionary_DocumentInputIterator_initWithOrgApacheLuceneSearchSuggestDocumentDictionary_withBoolean_withBoolean_(self, outer$, hasPayloads, hasContexts);
  self->currentLeafIndex_ = 0;
  JreStrongAssign(&self->leaves_, [((OrgApacheLuceneIndexIndexReader *) nil_chk(outer$->reader_)) leaves]);
  JreStrongAssignAndConsume(&self->starts_, [IOSIntArray newArrayWithLength:[((id<JavaUtilList>) nil_chk(self->leaves_)) size] + 1]);
  for (jint i = 0; i < [self->leaves_ size]; i++) {
    *IOSIntArray_GetRef(self->starts_, i) = ((OrgApacheLuceneIndexLeafReaderContext *) nil_chk([self->leaves_ getWithInt:i]))->docBase_;
  }
  *IOSIntArray_GetRef(self->starts_, [self->leaves_ size]) = [outer$->reader_ maxDoc];
  JreStrongAssign(&self->currentWeightValues_, ([self->leaves_ size] > 0) ? [((OrgApacheLuceneQueriesFunctionValueSource *) nil_chk(outer$->weightsValueSource_)) getValuesWithJavaUtilMap:create_JavaUtilHashMap_init() withOrgApacheLuceneIndexLeafReaderContext:[self->leaves_ getWithInt:self->currentLeafIndex_]] : nil);
}

OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary_DocumentValueSourceInputIterator *new_OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary_DocumentValueSourceInputIterator_initWithOrgApacheLuceneSearchSuggestDocumentValueSourceDictionary_withBoolean_withBoolean_(OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary *outer$, jboolean hasPayloads, jboolean hasContexts) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary_DocumentValueSourceInputIterator, initWithOrgApacheLuceneSearchSuggestDocumentValueSourceDictionary_withBoolean_withBoolean_, outer$, hasPayloads, hasContexts)
}

OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary_DocumentValueSourceInputIterator *create_OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary_DocumentValueSourceInputIterator_initWithOrgApacheLuceneSearchSuggestDocumentValueSourceDictionary_withBoolean_withBoolean_(OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary *outer$, jboolean hasPayloads, jboolean hasContexts) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary_DocumentValueSourceInputIterator, initWithOrgApacheLuceneSearchSuggestDocumentValueSourceDictionary_withBoolean_withBoolean_, outer$, hasPayloads, hasContexts)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneSearchSuggestDocumentValueSourceDictionary_DocumentValueSourceInputIterator)
