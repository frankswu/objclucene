//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: ./core/src/java/org/apache/lucene/search/TopDocsCollector.java
//

#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "J2ObjC_source.h"
#include "java/lang/Float.h"
#include "java/lang/Math.h"
#include "org/apache/lucene/search/ScoreDoc.h"
#include "org/apache/lucene/search/TopDocs.h"
#include "org/apache/lucene/search/TopDocsCollector.h"
#include "org/apache/lucene/util/PriorityQueue.h"

#pragma clang diagnostic ignored "-Wprotocol"

J2OBJC_INITIALIZED_DEFN(OrgApacheLuceneSearchTopDocsCollector)

OrgApacheLuceneSearchTopDocs *OrgApacheLuceneSearchTopDocsCollector_EMPTY_TOPDOCS_;

@implementation OrgApacheLuceneSearchTopDocsCollector

- (instancetype)initWithOrgApacheLuceneUtilPriorityQueue:(OrgApacheLuceneUtilPriorityQueue *)pq {
  OrgApacheLuceneSearchTopDocsCollector_initWithOrgApacheLuceneUtilPriorityQueue_(self, pq);
  return self;
}

- (void)populateResultsWithOrgApacheLuceneSearchScoreDocArray:(IOSObjectArray *)results
                                                      withInt:(jint)howMany {
  for (jint i = howMany - 1; i >= 0; i--) {
    IOSObjectArray_Set(nil_chk(results), i, [((OrgApacheLuceneUtilPriorityQueue *) nil_chk(pq_)) pop]);
  }
}

- (OrgApacheLuceneSearchTopDocs *)newTopDocsWithOrgApacheLuceneSearchScoreDocArray:(IOSObjectArray *)results
                                                                           withInt:(jint)start {
  return results == nil ? OrgApacheLuceneSearchTopDocsCollector_EMPTY_TOPDOCS_ : [new_OrgApacheLuceneSearchTopDocs_initWithInt_withOrgApacheLuceneSearchScoreDocArray_(totalHits_, results) autorelease];
}

- (jint)topDocsSize {
  return totalHits_ < [((OrgApacheLuceneUtilPriorityQueue *) nil_chk(pq_)) size] ? totalHits_ : [pq_ size];
}

- (OrgApacheLuceneSearchTopDocs *)topDocs {
  return [self topDocsWithInt:0 withInt:[self topDocsSize]];
}

- (OrgApacheLuceneSearchTopDocs *)topDocsWithInt:(jint)start
                                         withInt:(jint)howMany {
  jint size = [self topDocsSize];
  if (start < 0 || start >= size || howMany <= 0) {
    return [self newTopDocsWithOrgApacheLuceneSearchScoreDocArray:nil withInt:start];
  }
  howMany = JavaLangMath_minWithInt_withInt_(size - start, howMany);
  IOSObjectArray *results = [IOSObjectArray arrayWithLength:howMany type:OrgApacheLuceneSearchScoreDoc_class_()];
  for (jint i = [((OrgApacheLuceneUtilPriorityQueue *) nil_chk(pq_)) size] - start - howMany; i > 0; i--) {
    [pq_ pop];
  }
  [self populateResultsWithOrgApacheLuceneSearchScoreDocArray:results withInt:howMany];
  return [self newTopDocsWithOrgApacheLuceneSearchScoreDocArray:results withInt:start];
}

- (void)dealloc {
  RELEASE_(pq_);
  [super dealloc];
}

+ (void)initialize {
  if (self == [OrgApacheLuceneSearchTopDocsCollector class]) {
    JreStrongAssignAndConsume(&OrgApacheLuceneSearchTopDocsCollector_EMPTY_TOPDOCS_, new_OrgApacheLuceneSearchTopDocs_initWithInt_withOrgApacheLuceneSearchScoreDocArray_withFloat_(0, [IOSObjectArray arrayWithLength:0 type:OrgApacheLuceneSearchScoreDoc_class_()], JavaLangFloat_NaN));
    J2OBJC_SET_INITIALIZED(OrgApacheLuceneSearchTopDocsCollector)
  }
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithOrgApacheLuceneUtilPriorityQueue:", "TopDocsCollector", NULL, 0x4, NULL, NULL },
    { "populateResultsWithOrgApacheLuceneSearchScoreDocArray:withInt:", "populateResults", "V", 0x4, NULL, NULL },
    { "newTopDocsWithOrgApacheLuceneSearchScoreDocArray:withInt:", "newTopDocs", "Lorg.apache.lucene.search.TopDocs;", 0x4, NULL, NULL },
    { "topDocsSize", NULL, "I", 0x4, NULL, NULL },
    { "topDocs", NULL, "Lorg.apache.lucene.search.TopDocs;", 0x1, NULL, NULL },
    { "topDocsWithInt:withInt:", "topDocs", "Lorg.apache.lucene.search.TopDocs;", 0x1, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "EMPTY_TOPDOCS_", NULL, 0x1c, "Lorg.apache.lucene.search.TopDocs;", &OrgApacheLuceneSearchTopDocsCollector_EMPTY_TOPDOCS_, NULL, .constantValue.asLong = 0 },
    { "pq_", NULL, 0x4, "Lorg.apache.lucene.util.PriorityQueue;", NULL, "Lorg/apache/lucene/util/PriorityQueue<TT;>;", .constantValue.asLong = 0 },
    { "totalHits_", NULL, 0x4, "I", NULL, NULL, .constantValue.asLong = 0 },
  };
  static const J2ObjcClassInfo _OrgApacheLuceneSearchTopDocsCollector = { 2, "TopDocsCollector", "org.apache.lucene.search", NULL, 0x401, 6, methods, 3, fields, 0, NULL, 0, NULL, NULL, "<T:Lorg/apache/lucene/search/ScoreDoc;>Ljava/lang/Object;Lorg/apache/lucene/search/Collector;" };
  return &_OrgApacheLuceneSearchTopDocsCollector;
}

@end

void OrgApacheLuceneSearchTopDocsCollector_initWithOrgApacheLuceneUtilPriorityQueue_(OrgApacheLuceneSearchTopDocsCollector *self, OrgApacheLuceneUtilPriorityQueue *pq) {
  NSObject_init(self);
  JreStrongAssign(&self->pq_, pq);
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneSearchTopDocsCollector)
