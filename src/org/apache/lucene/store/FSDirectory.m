//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: ./core/src/java/org/apache/lucene/store/FSDirectory.java
//

#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "java/io/FileOutputStream.h"
#include "java/io/FilterOutputStream.h"
#include "java/io/IOException.h"
#include "java/io/OutputStream.h"
#include "java/lang/Math.h"
#include "java/lang/Throwable.h"
#include "java/util/ArrayList.h"
#include "java/util/Collection.h"
#include "java/util/List.h"
#include "org/apache/lucene/store/BaseDirectory.h"
#include "org/apache/lucene/store/FSDirectory.h"
#include "org/apache/lucene/store/FSLockFactory.h"
#include "org/apache/lucene/store/IOContext.h"
#include "org/apache/lucene/store/IndexOutput.h"
#include "org/apache/lucene/store/LockFactory.h"
#include "org/apache/lucene/store/MMapDirectory.h"
#include "org/apache/lucene/store/NIOFSDirectory.h"
#include "org/apache/lucene/store/OutputStreamIndexOutput.h"
#include "org/apache/lucene/store/SimpleFSDirectory.h"
#include "org/apache/lucene/util/Constants.h"
#include "org/apache/lucene/util/IOUtils.h"
#include "org/lukhnos/portmobile/file/DirectoryStream.h"
#include "org/lukhnos/portmobile/file/Files.h"
#include "org/lukhnos/portmobile/file/Path.h"
#include "org/lukhnos/portmobile/file/StandardCopyOption.h"

@interface OrgApacheLuceneStoreFSDirectory_FSIndexOutput_$1 : JavaIoFilterOutputStream

- (void)writeWithByteArray:(IOSByteArray *)b
                   withInt:(jint)offset
                   withInt:(jint)length;

- (instancetype)initWithJavaIoOutputStream:(JavaIoOutputStream *)arg$0;

@end

J2OBJC_EMPTY_STATIC_INIT(OrgApacheLuceneStoreFSDirectory_FSIndexOutput_$1)

__attribute__((unused)) static void OrgApacheLuceneStoreFSDirectory_FSIndexOutput_$1_initWithJavaIoOutputStream_(OrgApacheLuceneStoreFSDirectory_FSIndexOutput_$1 *self, JavaIoOutputStream *arg$0);

__attribute__((unused)) static OrgApacheLuceneStoreFSDirectory_FSIndexOutput_$1 *new_OrgApacheLuceneStoreFSDirectory_FSIndexOutput_$1_initWithJavaIoOutputStream_(JavaIoOutputStream *arg$0) NS_RETURNS_RETAINED;

J2OBJC_TYPE_LITERAL_HEADER(OrgApacheLuceneStoreFSDirectory_FSIndexOutput_$1)

@implementation OrgApacheLuceneStoreFSDirectory

- (instancetype)initWithOrgLukhnosPortmobileFilePath:(OrgLukhnosPortmobileFilePath *)path
                 withOrgApacheLuceneStoreLockFactory:(OrgApacheLuceneStoreLockFactory *)lockFactory {
  OrgApacheLuceneStoreFSDirectory_initWithOrgLukhnosPortmobileFilePath_withOrgApacheLuceneStoreLockFactory_(self, path, lockFactory);
  return self;
}

+ (OrgApacheLuceneStoreFSDirectory *)openWithOrgLukhnosPortmobileFilePath:(OrgLukhnosPortmobileFilePath *)path {
  return OrgApacheLuceneStoreFSDirectory_openWithOrgLukhnosPortmobileFilePath_(path);
}

+ (OrgApacheLuceneStoreFSDirectory *)openWithOrgLukhnosPortmobileFilePath:(OrgLukhnosPortmobileFilePath *)path
                                      withOrgApacheLuceneStoreLockFactory:(OrgApacheLuceneStoreLockFactory *)lockFactory {
  return OrgApacheLuceneStoreFSDirectory_openWithOrgLukhnosPortmobileFilePath_withOrgApacheLuceneStoreLockFactory_(path, lockFactory);
}

+ (IOSObjectArray *)listAllWithOrgLukhnosPortmobileFilePath:(OrgLukhnosPortmobileFilePath *)dir {
  return OrgApacheLuceneStoreFSDirectory_listAllWithOrgLukhnosPortmobileFilePath_(dir);
}

- (IOSObjectArray *)listAll {
  [self ensureOpen];
  return OrgApacheLuceneStoreFSDirectory_listAllWithOrgLukhnosPortmobileFilePath_(directory_);
}

- (jlong)fileLengthWithNSString:(NSString *)name {
  [self ensureOpen];
  return OrgLukhnosPortmobileFileFiles_sizeWithOrgLukhnosPortmobileFilePath_([((OrgLukhnosPortmobileFilePath *) nil_chk(directory_)) resolveWithNSString:name]);
}

- (void)deleteFileWithNSString:(NSString *)name {
  [self ensureOpen];
  OrgLukhnosPortmobileFileFiles_delete__WithOrgLukhnosPortmobileFilePath_([((OrgLukhnosPortmobileFilePath *) nil_chk(directory_)) resolveWithNSString:name]);
}

- (OrgApacheLuceneStoreIndexOutput *)createOutputWithNSString:(NSString *)name
                            withOrgApacheLuceneStoreIOContext:(OrgApacheLuceneStoreIOContext *)context {
  [self ensureOpen];
  [self ensureCanWriteWithNSString:name];
  return [new_OrgApacheLuceneStoreFSDirectory_FSIndexOutput_initWithOrgApacheLuceneStoreFSDirectory_withNSString_(self, name) autorelease];
}

- (void)ensureCanWriteWithNSString:(NSString *)name {
  OrgLukhnosPortmobileFileFiles_deleteIfExistsWithOrgLukhnosPortmobileFilePath_([((OrgLukhnosPortmobileFilePath *) nil_chk(directory_)) resolveWithNSString:name]);
}

- (void)syncWithJavaUtilCollection:(id<JavaUtilCollection>)names {
  [self ensureOpen];
  for (NSString * __strong name in nil_chk(names)) {
    [self fsyncWithNSString:name];
  }
}

- (void)renameFileWithNSString:(NSString *)source
                  withNSString:(NSString *)dest {
  [self ensureOpen];
  OrgLukhnosPortmobileFileFiles_moveWithOrgLukhnosPortmobileFilePath_withOrgLukhnosPortmobileFilePath_withOrgLukhnosPortmobileFileStandardCopyOptionArray_([((OrgLukhnosPortmobileFilePath *) nil_chk(directory_)) resolveWithNSString:source], [directory_ resolveWithNSString:dest], [IOSObjectArray arrayWithObjects:(id[]){ JreLoadStatic(OrgLukhnosPortmobileFileStandardCopyOption, ATOMIC_MOVE_) } count:1 type:OrgLukhnosPortmobileFileStandardCopyOption_class_()]);
  OrgApacheLuceneUtilIOUtils_fsyncWithOrgLukhnosPortmobileFilePath_withBoolean_(directory_, YES);
}

- (void)close {
  @synchronized(self) {
    JreAssignVolatileBoolean(&isOpen_, NO);
  }
}

- (OrgLukhnosPortmobileFilePath *)getDirectory {
  [self ensureOpen];
  return directory_;
}

- (NSString *)description {
  return JreStrcat("$C@$@", [[self getClass] getSimpleName], '@', directory_, @" lockFactory=", lockFactory_);
}

- (void)fsyncWithNSString:(NSString *)name {
  OrgApacheLuceneUtilIOUtils_fsyncWithOrgLukhnosPortmobileFilePath_withBoolean_([((OrgLukhnosPortmobileFilePath *) nil_chk(directory_)) resolveWithNSString:name], NO);
}

- (void)dealloc {
  RELEASE_(directory_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithOrgLukhnosPortmobileFilePath:withOrgApacheLuceneStoreLockFactory:", "FSDirectory", NULL, 0x4, "Ljava.io.IOException;", NULL },
    { "openWithOrgLukhnosPortmobileFilePath:", "open", "Lorg.apache.lucene.store.FSDirectory;", 0x9, "Ljava.io.IOException;", NULL },
    { "openWithOrgLukhnosPortmobileFilePath:withOrgApacheLuceneStoreLockFactory:", "open", "Lorg.apache.lucene.store.FSDirectory;", 0x9, "Ljava.io.IOException;", NULL },
    { "listAllWithOrgLukhnosPortmobileFilePath:", "listAll", "[Ljava.lang.String;", 0x9, "Ljava.io.IOException;", NULL },
    { "listAll", NULL, "[Ljava.lang.String;", 0x1, "Ljava.io.IOException;", NULL },
    { "fileLengthWithNSString:", "fileLength", "J", 0x1, "Ljava.io.IOException;", NULL },
    { "deleteFileWithNSString:", "deleteFile", "V", 0x1, "Ljava.io.IOException;", NULL },
    { "createOutputWithNSString:withOrgApacheLuceneStoreIOContext:", "createOutput", "Lorg.apache.lucene.store.IndexOutput;", 0x1, "Ljava.io.IOException;", NULL },
    { "ensureCanWriteWithNSString:", "ensureCanWrite", "V", 0x4, "Ljava.io.IOException;", NULL },
    { "syncWithJavaUtilCollection:", "sync", "V", 0x1, "Ljava.io.IOException;", NULL },
    { "renameFileWithNSString:withNSString:", "renameFile", "V", 0x1, "Ljava.io.IOException;", NULL },
    { "close", NULL, "V", 0x21, NULL, NULL },
    { "getDirectory", NULL, "Lorg.lukhnos.portmobile.file.Path;", 0x1, NULL, NULL },
    { "description", "toString", "Ljava.lang.String;", 0x1, NULL, NULL },
    { "fsyncWithNSString:", "fsync", "V", 0x4, "Ljava.io.IOException;", NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "directory_", NULL, 0x14, "Lorg.lukhnos.portmobile.file.Path;", NULL, NULL, .constantValue.asLong = 0 },
  };
  static const char *inner_classes[] = {"Lorg.apache.lucene.store.FSDirectory$FSIndexOutput;"};
  static const J2ObjcClassInfo _OrgApacheLuceneStoreFSDirectory = { 2, "FSDirectory", "org.apache.lucene.store", NULL, 0x401, 15, methods, 1, fields, 0, NULL, 1, inner_classes, NULL, NULL };
  return &_OrgApacheLuceneStoreFSDirectory;
}

@end

void OrgApacheLuceneStoreFSDirectory_initWithOrgLukhnosPortmobileFilePath_withOrgApacheLuceneStoreLockFactory_(OrgApacheLuceneStoreFSDirectory *self, OrgLukhnosPortmobileFilePath *path, OrgApacheLuceneStoreLockFactory *lockFactory) {
  OrgApacheLuceneStoreBaseDirectory_initWithOrgApacheLuceneStoreLockFactory_(self, lockFactory);
  if (!OrgLukhnosPortmobileFileFiles_isDirectoryWithOrgLukhnosPortmobileFilePath_(path)) {
    OrgLukhnosPortmobileFileFiles_createDirectoriesWithOrgLukhnosPortmobileFilePath_(path);
  }
  JreStrongAssign(&self->directory_, [((OrgLukhnosPortmobileFilePath *) nil_chk(path)) toRealPath]);
}

OrgApacheLuceneStoreFSDirectory *OrgApacheLuceneStoreFSDirectory_openWithOrgLukhnosPortmobileFilePath_(OrgLukhnosPortmobileFilePath *path) {
  OrgApacheLuceneStoreFSDirectory_initialize();
  return OrgApacheLuceneStoreFSDirectory_openWithOrgLukhnosPortmobileFilePath_withOrgApacheLuceneStoreLockFactory_(path, OrgApacheLuceneStoreFSLockFactory_getDefault());
}

OrgApacheLuceneStoreFSDirectory *OrgApacheLuceneStoreFSDirectory_openWithOrgLukhnosPortmobileFilePath_withOrgApacheLuceneStoreLockFactory_(OrgLukhnosPortmobileFilePath *path, OrgApacheLuceneStoreLockFactory *lockFactory) {
  OrgApacheLuceneStoreFSDirectory_initialize();
  if (JreLoadStatic(OrgApacheLuceneUtilConstants, JRE_IS_64BIT_) && JreLoadStatic(OrgApacheLuceneStoreMMapDirectory, UNMAP_SUPPORTED_)) {
    return [new_OrgApacheLuceneStoreMMapDirectory_initWithOrgLukhnosPortmobileFilePath_withOrgApacheLuceneStoreLockFactory_(path, lockFactory) autorelease];
  }
  else if (JreLoadStatic(OrgApacheLuceneUtilConstants, WINDOWS_)) {
    return [new_OrgApacheLuceneStoreSimpleFSDirectory_initWithOrgLukhnosPortmobileFilePath_withOrgApacheLuceneStoreLockFactory_(path, lockFactory) autorelease];
  }
  else {
    return [new_OrgApacheLuceneStoreNIOFSDirectory_initWithOrgLukhnosPortmobileFilePath_withOrgApacheLuceneStoreLockFactory_(path, lockFactory) autorelease];
  }
}

IOSObjectArray *OrgApacheLuceneStoreFSDirectory_listAllWithOrgLukhnosPortmobileFilePath_(OrgLukhnosPortmobileFilePath *dir) {
  OrgApacheLuceneStoreFSDirectory_initialize();
  id<JavaUtilList> entries = [new_JavaUtilArrayList_init() autorelease];
  {
    JavaLangThrowable *__mainException = nil;
    id<OrgLukhnosPortmobileFileDirectoryStream> stream = OrgLukhnosPortmobileFileFiles_newDirectoryStreamWithOrgLukhnosPortmobileFilePath_(dir);
    @try {
      for (OrgLukhnosPortmobileFilePath * __strong path in nil_chk(stream)) {
        [entries addWithId:[((OrgLukhnosPortmobileFilePath *) nil_chk([((OrgLukhnosPortmobileFilePath *) nil_chk(path)) getFileName])) description]];
      }
    }
    @finally {
      @try {
        [stream close];
      }
      @catch (JavaLangThrowable *e) {
        if (__mainException) {
          [__mainException addSuppressedWithJavaLangThrowable:e];
        } else {
          __mainException = e;
        }
      }
      if (__mainException) {
        @throw __mainException;
      }
    }
  }
  return [entries toArrayWithNSObjectArray:[IOSObjectArray arrayWithLength:[entries size] type:NSString_class_()]];
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneStoreFSDirectory)

@implementation OrgApacheLuceneStoreFSDirectory_FSIndexOutput

- (instancetype)initWithOrgApacheLuceneStoreFSDirectory:(OrgApacheLuceneStoreFSDirectory *)outer$
                                           withNSString:(NSString *)name {
  OrgApacheLuceneStoreFSDirectory_FSIndexOutput_initWithOrgApacheLuceneStoreFSDirectory_withNSString_(self, outer$, name);
  return self;
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithOrgApacheLuceneStoreFSDirectory:withNSString:", "FSIndexOutput", NULL, 0x1, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "CHUNK_SIZE", "CHUNK_SIZE", 0x18, "I", NULL, NULL, .constantValue.asInt = OrgApacheLuceneStoreFSDirectory_FSIndexOutput_CHUNK_SIZE },
  };
  static const J2ObjcClassInfo _OrgApacheLuceneStoreFSDirectory_FSIndexOutput = { 2, "FSIndexOutput", "org.apache.lucene.store", "FSDirectory", 0x10, 1, methods, 1, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_OrgApacheLuceneStoreFSDirectory_FSIndexOutput;
}

@end

void OrgApacheLuceneStoreFSDirectory_FSIndexOutput_initWithOrgApacheLuceneStoreFSDirectory_withNSString_(OrgApacheLuceneStoreFSDirectory_FSIndexOutput *self, OrgApacheLuceneStoreFSDirectory *outer$, NSString *name) {
  OrgApacheLuceneStoreOutputStreamIndexOutput_initWithNSString_withJavaIoOutputStream_withInt_(self, JreStrcat("$@$", @"FSIndexOutput(path=\"", [((OrgLukhnosPortmobileFilePath *) nil_chk(outer$->directory_)) resolveWithNSString:name], @"\")"), [new_OrgApacheLuceneStoreFSDirectory_FSIndexOutput_$1_initWithJavaIoOutputStream_(OrgLukhnosPortmobileFileFiles_newOutputStreamWithOrgLukhnosPortmobileFilePath_([outer$->directory_ resolveWithNSString:name])) autorelease], OrgApacheLuceneStoreFSDirectory_FSIndexOutput_CHUNK_SIZE);
}

OrgApacheLuceneStoreFSDirectory_FSIndexOutput *new_OrgApacheLuceneStoreFSDirectory_FSIndexOutput_initWithOrgApacheLuceneStoreFSDirectory_withNSString_(OrgApacheLuceneStoreFSDirectory *outer$, NSString *name) {
  OrgApacheLuceneStoreFSDirectory_FSIndexOutput *self = [OrgApacheLuceneStoreFSDirectory_FSIndexOutput alloc];
  OrgApacheLuceneStoreFSDirectory_FSIndexOutput_initWithOrgApacheLuceneStoreFSDirectory_withNSString_(self, outer$, name);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneStoreFSDirectory_FSIndexOutput)

@implementation OrgApacheLuceneStoreFSDirectory_FSIndexOutput_$1

- (void)writeWithByteArray:(IOSByteArray *)b
                   withInt:(jint)offset
                   withInt:(jint)length {
  while (length > 0) {
    jint chunk = JavaLangMath_minWithInt_withInt_(length, OrgApacheLuceneStoreFSDirectory_FSIndexOutput_CHUNK_SIZE);
    [((JavaIoOutputStream *) nil_chk(out_)) writeWithByteArray:b withInt:offset withInt:chunk];
    length -= chunk;
    offset += chunk;
  }
}

- (instancetype)initWithJavaIoOutputStream:(JavaIoOutputStream *)arg$0 {
  OrgApacheLuceneStoreFSDirectory_FSIndexOutput_$1_initWithJavaIoOutputStream_(self, arg$0);
  return self;
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "writeWithByteArray:withInt:withInt:", "write", "V", 0x1, "Ljava.io.IOException;", NULL },
    { "initWithJavaIoOutputStream:", "", NULL, 0x0, NULL, NULL },
  };
  static const J2ObjCEnclosingMethodInfo enclosing_method = { "OrgApacheLuceneStoreFSDirectory_FSIndexOutput", "initWithNSString:" };
  static const J2ObjcClassInfo _OrgApacheLuceneStoreFSDirectory_FSIndexOutput_$1 = { 2, "", "org.apache.lucene.store", "FSDirectory$FSIndexOutput", 0x8008, 2, methods, 0, NULL, 0, NULL, 0, NULL, &enclosing_method, NULL };
  return &_OrgApacheLuceneStoreFSDirectory_FSIndexOutput_$1;
}

@end

void OrgApacheLuceneStoreFSDirectory_FSIndexOutput_$1_initWithJavaIoOutputStream_(OrgApacheLuceneStoreFSDirectory_FSIndexOutput_$1 *self, JavaIoOutputStream *arg$0) {
  JavaIoFilterOutputStream_initWithJavaIoOutputStream_(self, arg$0);
}

OrgApacheLuceneStoreFSDirectory_FSIndexOutput_$1 *new_OrgApacheLuceneStoreFSDirectory_FSIndexOutput_$1_initWithJavaIoOutputStream_(JavaIoOutputStream *arg$0) {
  OrgApacheLuceneStoreFSDirectory_FSIndexOutput_$1 *self = [OrgApacheLuceneStoreFSDirectory_FSIndexOutput_$1 alloc];
  OrgApacheLuceneStoreFSDirectory_FSIndexOutput_$1_initWithJavaIoOutputStream_(self, arg$0);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneStoreFSDirectory_FSIndexOutput_$1)
