//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: ./core/src/java/org/apache/lucene/util/packed/PackedLongValues.java
//

#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "java/lang/IllegalStateException.h"
#include "java/lang/Math.h"
#include "java/util/Arrays.h"
#include "java/util/Collection.h"
#include "java/util/Collections.h"
#include "java/util/List.h"
#include "org/apache/lucene/util/ArrayUtil.h"
#include "org/apache/lucene/util/LongValues.h"
#include "org/apache/lucene/util/RamUsageEstimator.h"
#include "org/apache/lucene/util/packed/DeltaPackedLongValues.h"
#include "org/apache/lucene/util/packed/MonotonicLongValues.h"
#include "org/apache/lucene/util/packed/PackedInts.h"
#include "org/apache/lucene/util/packed/PackedLongValues.h"

@interface OrgApacheLuceneUtilPackedPackedLongValues () {
 @public
  jlong size_;
  jlong ramBytesUsed_;
}

@end

static jlong OrgApacheLuceneUtilPackedPackedLongValues_BASE_RAM_BYTES_USED_;
J2OBJC_STATIC_FIELD_GETTER(OrgApacheLuceneUtilPackedPackedLongValues, BASE_RAM_BYTES_USED_, jlong)

__attribute__((unused)) static jlong OrgApacheLuceneUtilPackedPackedLongValues_size(OrgApacheLuceneUtilPackedPackedLongValues *self);

@interface OrgApacheLuceneUtilPackedPackedLongValues_Iterator () {
 @public
  OrgApacheLuceneUtilPackedPackedLongValues *this$0_;
}

- (void)fillBlock;

@end

J2OBJC_FIELD_SETTER(OrgApacheLuceneUtilPackedPackedLongValues_Iterator, this$0_, OrgApacheLuceneUtilPackedPackedLongValues *)

__attribute__((unused)) static void OrgApacheLuceneUtilPackedPackedLongValues_Iterator_fillBlock(OrgApacheLuceneUtilPackedPackedLongValues_Iterator *self);

__attribute__((unused)) static jboolean OrgApacheLuceneUtilPackedPackedLongValues_Iterator_hasNext(OrgApacheLuceneUtilPackedPackedLongValues_Iterator *self);

#define OrgApacheLuceneUtilPackedPackedLongValues_Builder_INITIAL_PAGE_COUNT 16

@interface OrgApacheLuceneUtilPackedPackedLongValues_Builder ()

- (void)pack;

@end

J2OBJC_STATIC_FIELD_GETTER(OrgApacheLuceneUtilPackedPackedLongValues_Builder, INITIAL_PAGE_COUNT, jint)

static jlong OrgApacheLuceneUtilPackedPackedLongValues_Builder_BASE_RAM_BYTES_USED_;
J2OBJC_STATIC_FIELD_GETTER(OrgApacheLuceneUtilPackedPackedLongValues_Builder, BASE_RAM_BYTES_USED_, jlong)

__attribute__((unused)) static void OrgApacheLuceneUtilPackedPackedLongValues_Builder_finish(OrgApacheLuceneUtilPackedPackedLongValues_Builder *self);

__attribute__((unused)) static void OrgApacheLuceneUtilPackedPackedLongValues_Builder_pack(OrgApacheLuceneUtilPackedPackedLongValues_Builder *self);

J2OBJC_INITIALIZED_DEFN(OrgApacheLuceneUtilPackedPackedLongValues)

@implementation OrgApacheLuceneUtilPackedPackedLongValues

+ (OrgApacheLuceneUtilPackedPackedLongValues_Builder *)packedBuilderWithInt:(jint)pageSize
                                                                  withFloat:(jfloat)acceptableOverheadRatio {
  return OrgApacheLuceneUtilPackedPackedLongValues_packedBuilderWithInt_withFloat_(pageSize, acceptableOverheadRatio);
}

+ (OrgApacheLuceneUtilPackedPackedLongValues_Builder *)packedBuilderWithFloat:(jfloat)acceptableOverheadRatio {
  return OrgApacheLuceneUtilPackedPackedLongValues_packedBuilderWithFloat_(acceptableOverheadRatio);
}

+ (OrgApacheLuceneUtilPackedPackedLongValues_Builder *)deltaPackedBuilderWithInt:(jint)pageSize
                                                                       withFloat:(jfloat)acceptableOverheadRatio {
  return OrgApacheLuceneUtilPackedPackedLongValues_deltaPackedBuilderWithInt_withFloat_(pageSize, acceptableOverheadRatio);
}

+ (OrgApacheLuceneUtilPackedPackedLongValues_Builder *)deltaPackedBuilderWithFloat:(jfloat)acceptableOverheadRatio {
  return OrgApacheLuceneUtilPackedPackedLongValues_deltaPackedBuilderWithFloat_(acceptableOverheadRatio);
}

+ (OrgApacheLuceneUtilPackedPackedLongValues_Builder *)monotonicBuilderWithInt:(jint)pageSize
                                                                     withFloat:(jfloat)acceptableOverheadRatio {
  return OrgApacheLuceneUtilPackedPackedLongValues_monotonicBuilderWithInt_withFloat_(pageSize, acceptableOverheadRatio);
}

+ (OrgApacheLuceneUtilPackedPackedLongValues_Builder *)monotonicBuilderWithFloat:(jfloat)acceptableOverheadRatio {
  return OrgApacheLuceneUtilPackedPackedLongValues_monotonicBuilderWithFloat_(acceptableOverheadRatio);
}

- (instancetype)initWithInt:(jint)pageShift
                    withInt:(jint)pageMask
withOrgApacheLuceneUtilPackedPackedInts_ReaderArray:(IOSObjectArray *)values
                   withLong:(jlong)size
                   withLong:(jlong)ramBytesUsed {
  OrgApacheLuceneUtilPackedPackedLongValues_initWithInt_withInt_withOrgApacheLuceneUtilPackedPackedInts_ReaderArray_withLong_withLong_(self, pageShift, pageMask, values, size, ramBytesUsed);
  return self;
}

- (jlong)size {
  return OrgApacheLuceneUtilPackedPackedLongValues_size(self);
}

- (jint)decodeBlockWithInt:(jint)block
             withLongArray:(IOSLongArray *)dest {
  OrgApacheLuceneUtilPackedPackedInts_Reader *vals = IOSObjectArray_Get(nil_chk(values_), block);
  jint size = [((OrgApacheLuceneUtilPackedPackedInts_Reader *) nil_chk(vals)) size];
  for (jint k = 0; k < size; ) {
    k += [vals getWithInt:k withLongArray:dest withInt:k withInt:size - k];
  }
  return size;
}

- (jlong)getWithInt:(jint)block
            withInt:(jint)element {
  return [((OrgApacheLuceneUtilPackedPackedInts_Reader *) nil_chk(IOSObjectArray_Get(nil_chk(values_), block))) getWithInt:element];
}

- (jlong)getWithLong:(jlong)index {
  JreAssert((index >= 0 && index < OrgApacheLuceneUtilPackedPackedLongValues_size(self)), (@"org/apache/lucene/util/packed/PackedLongValues.java:109 condition failed: assert index >= 0 && index < size();"));
  jint block = (jint) (JreRShift64(index, pageShift_));
  jint element = (jint) (index & pageMask_);
  return [self getWithInt:block withInt:element];
}

- (jlong)ramBytesUsed {
  return ramBytesUsed_;
}

- (id<JavaUtilCollection>)getChildResources {
  return JavaUtilCollections_emptyList();
}

- (OrgApacheLuceneUtilPackedPackedLongValues_Iterator *)iterator {
  return [new_OrgApacheLuceneUtilPackedPackedLongValues_Iterator_initWithOrgApacheLuceneUtilPackedPackedLongValues_(self) autorelease];
}

- (void)dealloc {
  RELEASE_(values_);
  [super dealloc];
}

+ (void)initialize {
  if (self == [OrgApacheLuceneUtilPackedPackedLongValues class]) {
    OrgApacheLuceneUtilPackedPackedLongValues_BASE_RAM_BYTES_USED_ = OrgApacheLuceneUtilRamUsageEstimator_shallowSizeOfInstanceWithIOSClass_(OrgApacheLuceneUtilPackedPackedLongValues_class_());
    J2OBJC_SET_INITIALIZED(OrgApacheLuceneUtilPackedPackedLongValues)
  }
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "packedBuilderWithInt:withFloat:", "packedBuilder", "Lorg.apache.lucene.util.packed.PackedLongValues$Builder;", 0x9, NULL, NULL },
    { "packedBuilderWithFloat:", "packedBuilder", "Lorg.apache.lucene.util.packed.PackedLongValues$Builder;", 0x9, NULL, NULL },
    { "deltaPackedBuilderWithInt:withFloat:", "deltaPackedBuilder", "Lorg.apache.lucene.util.packed.PackedLongValues$Builder;", 0x9, NULL, NULL },
    { "deltaPackedBuilderWithFloat:", "deltaPackedBuilder", "Lorg.apache.lucene.util.packed.PackedLongValues$Builder;", 0x9, NULL, NULL },
    { "monotonicBuilderWithInt:withFloat:", "monotonicBuilder", "Lorg.apache.lucene.util.packed.PackedLongValues$Builder;", 0x9, NULL, NULL },
    { "monotonicBuilderWithFloat:", "monotonicBuilder", "Lorg.apache.lucene.util.packed.PackedLongValues$Builder;", 0x9, NULL, NULL },
    { "initWithInt:withInt:withOrgApacheLuceneUtilPackedPackedInts_ReaderArray:withLong:withLong:", "PackedLongValues", NULL, 0x0, NULL, NULL },
    { "size", NULL, "J", 0x11, NULL, NULL },
    { "decodeBlockWithInt:withLongArray:", "decodeBlock", "I", 0x0, NULL, NULL },
    { "getWithInt:withInt:", "get", "J", 0x0, NULL, NULL },
    { "getWithLong:", "get", "J", 0x11, NULL, NULL },
    { "ramBytesUsed", NULL, "J", 0x1, NULL, NULL },
    { "getChildResources", NULL, "Ljava.util.Collection;", 0x1, NULL, NULL },
    { "iterator", NULL, "Lorg.apache.lucene.util.packed.PackedLongValues$Iterator;", 0x1, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "BASE_RAM_BYTES_USED_", NULL, 0x1a, "J", &OrgApacheLuceneUtilPackedPackedLongValues_BASE_RAM_BYTES_USED_, NULL, .constantValue.asLong = 0 },
    { "DEFAULT_PAGE_SIZE", "DEFAULT_PAGE_SIZE", 0x18, "I", NULL, NULL, .constantValue.asInt = OrgApacheLuceneUtilPackedPackedLongValues_DEFAULT_PAGE_SIZE },
    { "MIN_PAGE_SIZE", "MIN_PAGE_SIZE", 0x18, "I", NULL, NULL, .constantValue.asInt = OrgApacheLuceneUtilPackedPackedLongValues_MIN_PAGE_SIZE },
    { "MAX_PAGE_SIZE", "MAX_PAGE_SIZE", 0x18, "I", NULL, NULL, .constantValue.asInt = OrgApacheLuceneUtilPackedPackedLongValues_MAX_PAGE_SIZE },
    { "values_", NULL, 0x10, "[Lorg.apache.lucene.util.packed.PackedInts$Reader;", NULL, NULL, .constantValue.asLong = 0 },
    { "pageShift_", NULL, 0x10, "I", NULL, NULL, .constantValue.asLong = 0 },
    { "pageMask_", NULL, 0x10, "I", NULL, NULL, .constantValue.asLong = 0 },
    { "size_", NULL, 0x12, "J", NULL, NULL, .constantValue.asLong = 0 },
    { "ramBytesUsed_", NULL, 0x12, "J", NULL, NULL, .constantValue.asLong = 0 },
  };
  static const char *inner_classes[] = {"Lorg.apache.lucene.util.packed.PackedLongValues$Iterator;", "Lorg.apache.lucene.util.packed.PackedLongValues$Builder;"};
  static const J2ObjcClassInfo _OrgApacheLuceneUtilPackedPackedLongValues = { 2, "PackedLongValues", "org.apache.lucene.util.packed", NULL, 0x1, 14, methods, 9, fields, 0, NULL, 2, inner_classes, NULL, NULL };
  return &_OrgApacheLuceneUtilPackedPackedLongValues;
}

@end

OrgApacheLuceneUtilPackedPackedLongValues_Builder *OrgApacheLuceneUtilPackedPackedLongValues_packedBuilderWithInt_withFloat_(jint pageSize, jfloat acceptableOverheadRatio) {
  OrgApacheLuceneUtilPackedPackedLongValues_initialize();
  return [new_OrgApacheLuceneUtilPackedPackedLongValues_Builder_initWithInt_withFloat_(pageSize, acceptableOverheadRatio) autorelease];
}

OrgApacheLuceneUtilPackedPackedLongValues_Builder *OrgApacheLuceneUtilPackedPackedLongValues_packedBuilderWithFloat_(jfloat acceptableOverheadRatio) {
  OrgApacheLuceneUtilPackedPackedLongValues_initialize();
  return OrgApacheLuceneUtilPackedPackedLongValues_packedBuilderWithInt_withFloat_(OrgApacheLuceneUtilPackedPackedLongValues_DEFAULT_PAGE_SIZE, acceptableOverheadRatio);
}

OrgApacheLuceneUtilPackedPackedLongValues_Builder *OrgApacheLuceneUtilPackedPackedLongValues_deltaPackedBuilderWithInt_withFloat_(jint pageSize, jfloat acceptableOverheadRatio) {
  OrgApacheLuceneUtilPackedPackedLongValues_initialize();
  return [new_OrgApacheLuceneUtilPackedDeltaPackedLongValues_Builder_initWithInt_withFloat_(pageSize, acceptableOverheadRatio) autorelease];
}

OrgApacheLuceneUtilPackedPackedLongValues_Builder *OrgApacheLuceneUtilPackedPackedLongValues_deltaPackedBuilderWithFloat_(jfloat acceptableOverheadRatio) {
  OrgApacheLuceneUtilPackedPackedLongValues_initialize();
  return OrgApacheLuceneUtilPackedPackedLongValues_deltaPackedBuilderWithInt_withFloat_(OrgApacheLuceneUtilPackedPackedLongValues_DEFAULT_PAGE_SIZE, acceptableOverheadRatio);
}

OrgApacheLuceneUtilPackedPackedLongValues_Builder *OrgApacheLuceneUtilPackedPackedLongValues_monotonicBuilderWithInt_withFloat_(jint pageSize, jfloat acceptableOverheadRatio) {
  OrgApacheLuceneUtilPackedPackedLongValues_initialize();
  return [new_OrgApacheLuceneUtilPackedMonotonicLongValues_Builder_initWithInt_withFloat_(pageSize, acceptableOverheadRatio) autorelease];
}

OrgApacheLuceneUtilPackedPackedLongValues_Builder *OrgApacheLuceneUtilPackedPackedLongValues_monotonicBuilderWithFloat_(jfloat acceptableOverheadRatio) {
  OrgApacheLuceneUtilPackedPackedLongValues_initialize();
  return OrgApacheLuceneUtilPackedPackedLongValues_monotonicBuilderWithInt_withFloat_(OrgApacheLuceneUtilPackedPackedLongValues_DEFAULT_PAGE_SIZE, acceptableOverheadRatio);
}

void OrgApacheLuceneUtilPackedPackedLongValues_initWithInt_withInt_withOrgApacheLuceneUtilPackedPackedInts_ReaderArray_withLong_withLong_(OrgApacheLuceneUtilPackedPackedLongValues *self, jint pageShift, jint pageMask, IOSObjectArray *values, jlong size, jlong ramBytesUsed) {
  OrgApacheLuceneUtilLongValues_init(self);
  self->pageShift_ = pageShift;
  self->pageMask_ = pageMask;
  JreStrongAssign(&self->values_, values);
  self->size_ = size;
  self->ramBytesUsed_ = ramBytesUsed;
}

OrgApacheLuceneUtilPackedPackedLongValues *new_OrgApacheLuceneUtilPackedPackedLongValues_initWithInt_withInt_withOrgApacheLuceneUtilPackedPackedInts_ReaderArray_withLong_withLong_(jint pageShift, jint pageMask, IOSObjectArray *values, jlong size, jlong ramBytesUsed) {
  OrgApacheLuceneUtilPackedPackedLongValues *self = [OrgApacheLuceneUtilPackedPackedLongValues alloc];
  OrgApacheLuceneUtilPackedPackedLongValues_initWithInt_withInt_withOrgApacheLuceneUtilPackedPackedInts_ReaderArray_withLong_withLong_(self, pageShift, pageMask, values, size, ramBytesUsed);
  return self;
}

jlong OrgApacheLuceneUtilPackedPackedLongValues_size(OrgApacheLuceneUtilPackedPackedLongValues *self) {
  return self->size_;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneUtilPackedPackedLongValues)

@implementation OrgApacheLuceneUtilPackedPackedLongValues_Iterator

- (instancetype)initWithOrgApacheLuceneUtilPackedPackedLongValues:(OrgApacheLuceneUtilPackedPackedLongValues *)outer$ {
  OrgApacheLuceneUtilPackedPackedLongValues_Iterator_initWithOrgApacheLuceneUtilPackedPackedLongValues_(self, outer$);
  return self;
}

- (void)fillBlock {
  OrgApacheLuceneUtilPackedPackedLongValues_Iterator_fillBlock(self);
}

- (jboolean)hasNext {
  return OrgApacheLuceneUtilPackedPackedLongValues_Iterator_hasNext(self);
}

- (jlong)next {
  JreAssert((OrgApacheLuceneUtilPackedPackedLongValues_Iterator_hasNext(self)), (@"org/apache/lucene/util/packed/PackedLongValues.java:159 condition failed: assert hasNext();"));
  jlong result = IOSLongArray_Get(nil_chk(currentValues_), pOff_++);
  if (pOff_ == currentCount_) {
    vOff_ += 1;
    pOff_ = 0;
    OrgApacheLuceneUtilPackedPackedLongValues_Iterator_fillBlock(self);
  }
  return result;
}

- (void)dealloc {
  RELEASE_(this$0_);
  RELEASE_(currentValues_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithOrgApacheLuceneUtilPackedPackedLongValues:", "Iterator", NULL, 0x0, NULL, NULL },
    { "fillBlock", NULL, "V", 0x2, NULL, NULL },
    { "hasNext", NULL, "Z", 0x11, NULL, NULL },
    { "next", NULL, "J", 0x11, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "this$0_", NULL, 0x1012, "Lorg.apache.lucene.util.packed.PackedLongValues;", NULL, NULL, .constantValue.asLong = 0 },
    { "currentValues_", NULL, 0x10, "[J", NULL, NULL, .constantValue.asLong = 0 },
    { "vOff_", NULL, 0x0, "I", NULL, NULL, .constantValue.asLong = 0 },
    { "pOff_", NULL, 0x0, "I", NULL, NULL, .constantValue.asLong = 0 },
    { "currentCount_", NULL, 0x0, "I", NULL, NULL, .constantValue.asLong = 0 },
  };
  static const J2ObjcClassInfo _OrgApacheLuceneUtilPackedPackedLongValues_Iterator = { 2, "Iterator", "org.apache.lucene.util.packed", "PackedLongValues", 0x11, 4, methods, 5, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_OrgApacheLuceneUtilPackedPackedLongValues_Iterator;
}

@end

void OrgApacheLuceneUtilPackedPackedLongValues_Iterator_initWithOrgApacheLuceneUtilPackedPackedLongValues_(OrgApacheLuceneUtilPackedPackedLongValues_Iterator *self, OrgApacheLuceneUtilPackedPackedLongValues *outer$) {
  JreStrongAssign(&self->this$0_, outer$);
  NSObject_init(self);
  JreStrongAssignAndConsume(&self->currentValues_, [IOSLongArray newArrayWithLength:outer$->pageMask_ + 1]);
  self->vOff_ = self->pOff_ = 0;
  OrgApacheLuceneUtilPackedPackedLongValues_Iterator_fillBlock(self);
}

OrgApacheLuceneUtilPackedPackedLongValues_Iterator *new_OrgApacheLuceneUtilPackedPackedLongValues_Iterator_initWithOrgApacheLuceneUtilPackedPackedLongValues_(OrgApacheLuceneUtilPackedPackedLongValues *outer$) {
  OrgApacheLuceneUtilPackedPackedLongValues_Iterator *self = [OrgApacheLuceneUtilPackedPackedLongValues_Iterator alloc];
  OrgApacheLuceneUtilPackedPackedLongValues_Iterator_initWithOrgApacheLuceneUtilPackedPackedLongValues_(self, outer$);
  return self;
}

void OrgApacheLuceneUtilPackedPackedLongValues_Iterator_fillBlock(OrgApacheLuceneUtilPackedPackedLongValues_Iterator *self) {
  if (self->vOff_ == ((IOSObjectArray *) nil_chk(self->this$0_->values_))->size_) {
    self->currentCount_ = 0;
  }
  else {
    self->currentCount_ = [self->this$0_ decodeBlockWithInt:self->vOff_ withLongArray:self->currentValues_];
    JreAssert((self->currentCount_ > 0), (@"org/apache/lucene/util/packed/PackedLongValues.java:148 condition failed: assert currentCount > 0;"));
  }
}

jboolean OrgApacheLuceneUtilPackedPackedLongValues_Iterator_hasNext(OrgApacheLuceneUtilPackedPackedLongValues_Iterator *self) {
  return self->pOff_ < self->currentCount_;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneUtilPackedPackedLongValues_Iterator)

J2OBJC_INITIALIZED_DEFN(OrgApacheLuceneUtilPackedPackedLongValues_Builder)

@implementation OrgApacheLuceneUtilPackedPackedLongValues_Builder

- (instancetype)initWithInt:(jint)pageSize
                  withFloat:(jfloat)acceptableOverheadRatio {
  OrgApacheLuceneUtilPackedPackedLongValues_Builder_initWithInt_withFloat_(self, pageSize, acceptableOverheadRatio);
  return self;
}

- (OrgApacheLuceneUtilPackedPackedLongValues *)build {
  OrgApacheLuceneUtilPackedPackedLongValues_Builder_finish(self);
  JreStrongAssign(&pending_, nil);
  IOSObjectArray *values = JavaUtilArrays_copyOfWithNSObjectArray_withInt_(self->values_, valuesOff_);
  jlong ramBytesUsed = JreLoadStatic(OrgApacheLuceneUtilPackedPackedLongValues, BASE_RAM_BYTES_USED_) + OrgApacheLuceneUtilRamUsageEstimator_sizeOfWithOrgApacheLuceneUtilAccountableArray_(values);
  return [new_OrgApacheLuceneUtilPackedPackedLongValues_initWithInt_withInt_withOrgApacheLuceneUtilPackedPackedInts_ReaderArray_withLong_withLong_(pageShift_, pageMask_, values, size_, ramBytesUsed) autorelease];
}

- (jlong)baseRamBytesUsed {
  return OrgApacheLuceneUtilPackedPackedLongValues_Builder_BASE_RAM_BYTES_USED_;
}

- (jlong)ramBytesUsed {
  return ramBytesUsed_;
}

- (id<JavaUtilCollection>)getChildResources {
  return JavaUtilCollections_emptyList();
}

- (jlong)size {
  return size_;
}

- (OrgApacheLuceneUtilPackedPackedLongValues_Builder *)addWithLong:(jlong)l {
  if (pending_ == nil) {
    @throw [new_JavaLangIllegalStateException_initWithNSString_(@"Cannot be reused after build()") autorelease];
  }
  if (pendingOff_ == ((IOSLongArray *) nil_chk(pending_))->size_) {
    if (((IOSObjectArray *) nil_chk(values_))->size_ == valuesOff_) {
      jint newLength = OrgApacheLuceneUtilArrayUtil_oversizeWithInt_withInt_(valuesOff_ + 1, 8);
      [self growWithInt:newLength];
    }
    OrgApacheLuceneUtilPackedPackedLongValues_Builder_pack(self);
  }
  *IOSLongArray_GetRef(pending_, pendingOff_++) = l;
  size_ += 1;
  return self;
}

- (void)finish {
  OrgApacheLuceneUtilPackedPackedLongValues_Builder_finish(self);
}

- (void)pack {
  OrgApacheLuceneUtilPackedPackedLongValues_Builder_pack(self);
}

- (void)packWithLongArray:(IOSLongArray *)values
                  withInt:(jint)numValues
                  withInt:(jint)block
                withFloat:(jfloat)acceptableOverheadRatio {
  JreAssert((numValues > 0), (@"org/apache/lucene/util/packed/PackedLongValues.java:264 condition failed: assert numValues > 0;"));
  jlong minValue = IOSLongArray_Get(nil_chk(values), 0);
  jlong maxValue = IOSLongArray_Get(values, 0);
  for (jint i = 1; i < numValues; ++i) {
    minValue = JavaLangMath_minWithLong_withLong_(minValue, IOSLongArray_Get(values, i));
    maxValue = JavaLangMath_maxWithLong_withLong_(maxValue, IOSLongArray_Get(values, i));
  }
  if (minValue == 0 && maxValue == 0) {
    IOSObjectArray_SetAndConsume(nil_chk(self->values_), block, new_OrgApacheLuceneUtilPackedPackedInts_NullReader_initWithInt_(numValues));
  }
  else {
    jint bitsRequired = minValue < 0 ? 64 : OrgApacheLuceneUtilPackedPackedInts_bitsRequiredWithLong_(maxValue);
    OrgApacheLuceneUtilPackedPackedInts_Mutable *mutable_ = OrgApacheLuceneUtilPackedPackedInts_getMutableWithInt_withInt_withFloat_(numValues, bitsRequired, acceptableOverheadRatio);
    for (jint i = 0; i < numValues; ) {
      i += [((OrgApacheLuceneUtilPackedPackedInts_Mutable *) nil_chk(mutable_)) setWithInt:i withLongArray:values withInt:i withInt:numValues - i];
    }
    IOSObjectArray_Set(nil_chk(self->values_), block, mutable_);
  }
}

- (void)growWithInt:(jint)newBlockCount {
  ramBytesUsed_ -= OrgApacheLuceneUtilRamUsageEstimator_shallowSizeOfWithNSObjectArray_(values_);
  JreStrongAssign(&values_, JavaUtilArrays_copyOfWithNSObjectArray_withInt_(values_, newBlockCount));
  ramBytesUsed_ += OrgApacheLuceneUtilRamUsageEstimator_shallowSizeOfWithNSObjectArray_(values_);
}

- (void)dealloc {
  RELEASE_(pending_);
  RELEASE_(values_);
  [super dealloc];
}

+ (void)initialize {
  if (self == [OrgApacheLuceneUtilPackedPackedLongValues_Builder class]) {
    OrgApacheLuceneUtilPackedPackedLongValues_Builder_BASE_RAM_BYTES_USED_ = OrgApacheLuceneUtilRamUsageEstimator_shallowSizeOfInstanceWithIOSClass_(OrgApacheLuceneUtilPackedPackedLongValues_Builder_class_());
    J2OBJC_SET_INITIALIZED(OrgApacheLuceneUtilPackedPackedLongValues_Builder)
  }
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithInt:withFloat:", "Builder", NULL, 0x0, NULL, NULL },
    { "build", NULL, "Lorg.apache.lucene.util.packed.PackedLongValues;", 0x1, NULL, NULL },
    { "baseRamBytesUsed", NULL, "J", 0x0, NULL, NULL },
    { "ramBytesUsed", NULL, "J", 0x11, NULL, NULL },
    { "getChildResources", NULL, "Ljava.util.Collection;", 0x1, NULL, NULL },
    { "size", NULL, "J", 0x11, NULL, NULL },
    { "addWithLong:", "add", "Lorg.apache.lucene.util.packed.PackedLongValues$Builder;", 0x1, NULL, NULL },
    { "finish", NULL, "V", 0x10, NULL, NULL },
    { "pack", NULL, "V", 0x2, NULL, NULL },
    { "packWithLongArray:withInt:withInt:withFloat:", "pack", "V", 0x0, NULL, NULL },
    { "growWithInt:", "grow", "V", 0x0, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "INITIAL_PAGE_COUNT", "INITIAL_PAGE_COUNT", 0x1a, "I", NULL, NULL, .constantValue.asInt = OrgApacheLuceneUtilPackedPackedLongValues_Builder_INITIAL_PAGE_COUNT },
    { "BASE_RAM_BYTES_USED_", NULL, 0x1a, "J", &OrgApacheLuceneUtilPackedPackedLongValues_Builder_BASE_RAM_BYTES_USED_, NULL, .constantValue.asLong = 0 },
    { "pageShift_", NULL, 0x10, "I", NULL, NULL, .constantValue.asLong = 0 },
    { "pageMask_", NULL, 0x10, "I", NULL, NULL, .constantValue.asLong = 0 },
    { "acceptableOverheadRatio_", NULL, 0x10, "F", NULL, NULL, .constantValue.asLong = 0 },
    { "pending_", NULL, 0x0, "[J", NULL, NULL, .constantValue.asLong = 0 },
    { "size_", NULL, 0x0, "J", NULL, NULL, .constantValue.asLong = 0 },
    { "values_", NULL, 0x0, "[Lorg.apache.lucene.util.packed.PackedInts$Reader;", NULL, NULL, .constantValue.asLong = 0 },
    { "ramBytesUsed_", NULL, 0x0, "J", NULL, NULL, .constantValue.asLong = 0 },
    { "valuesOff_", NULL, 0x0, "I", NULL, NULL, .constantValue.asLong = 0 },
    { "pendingOff_", NULL, 0x0, "I", NULL, NULL, .constantValue.asLong = 0 },
  };
  static const J2ObjcClassInfo _OrgApacheLuceneUtilPackedPackedLongValues_Builder = { 2, "Builder", "org.apache.lucene.util.packed", "PackedLongValues", 0x9, 11, methods, 11, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_OrgApacheLuceneUtilPackedPackedLongValues_Builder;
}

@end

void OrgApacheLuceneUtilPackedPackedLongValues_Builder_initWithInt_withFloat_(OrgApacheLuceneUtilPackedPackedLongValues_Builder *self, jint pageSize, jfloat acceptableOverheadRatio) {
  NSObject_init(self);
  self->pageShift_ = OrgApacheLuceneUtilPackedPackedInts_checkBlockSizeWithInt_withInt_withInt_(pageSize, OrgApacheLuceneUtilPackedPackedLongValues_MIN_PAGE_SIZE, OrgApacheLuceneUtilPackedPackedLongValues_MAX_PAGE_SIZE);
  self->pageMask_ = pageSize - 1;
  self->acceptableOverheadRatio_ = acceptableOverheadRatio;
  JreStrongAssignAndConsume(&self->values_, [IOSObjectArray newArrayWithLength:OrgApacheLuceneUtilPackedPackedLongValues_Builder_INITIAL_PAGE_COUNT type:OrgApacheLuceneUtilPackedPackedInts_Reader_class_()]);
  JreStrongAssignAndConsume(&self->pending_, [IOSLongArray newArrayWithLength:pageSize]);
  self->valuesOff_ = 0;
  self->pendingOff_ = 0;
  self->size_ = 0;
  self->ramBytesUsed_ = [self baseRamBytesUsed] + OrgApacheLuceneUtilRamUsageEstimator_sizeOfWithLongArray_(self->pending_) + OrgApacheLuceneUtilRamUsageEstimator_shallowSizeOfWithNSObjectArray_(self->values_);
}

OrgApacheLuceneUtilPackedPackedLongValues_Builder *new_OrgApacheLuceneUtilPackedPackedLongValues_Builder_initWithInt_withFloat_(jint pageSize, jfloat acceptableOverheadRatio) {
  OrgApacheLuceneUtilPackedPackedLongValues_Builder *self = [OrgApacheLuceneUtilPackedPackedLongValues_Builder alloc];
  OrgApacheLuceneUtilPackedPackedLongValues_Builder_initWithInt_withFloat_(self, pageSize, acceptableOverheadRatio);
  return self;
}

void OrgApacheLuceneUtilPackedPackedLongValues_Builder_finish(OrgApacheLuceneUtilPackedPackedLongValues_Builder *self) {
  if (self->pendingOff_ > 0) {
    if (((IOSObjectArray *) nil_chk(self->values_))->size_ == self->valuesOff_) {
      [self growWithInt:self->valuesOff_ + 1];
    }
    OrgApacheLuceneUtilPackedPackedLongValues_Builder_pack(self);
  }
}

void OrgApacheLuceneUtilPackedPackedLongValues_Builder_pack(OrgApacheLuceneUtilPackedPackedLongValues_Builder *self) {
  [self packWithLongArray:self->pending_ withInt:self->pendingOff_ withInt:self->valuesOff_ withFloat:self->acceptableOverheadRatio_];
  self->ramBytesUsed_ += [((OrgApacheLuceneUtilPackedPackedInts_Reader *) nil_chk(IOSObjectArray_Get(nil_chk(self->values_), self->valuesOff_))) ramBytesUsed];
  self->valuesOff_ += 1;
  self->pendingOff_ = 0;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneUtilPackedPackedLongValues_Builder)
