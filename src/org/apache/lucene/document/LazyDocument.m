//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: ./misc/src/java/org/apache/lucene/document/LazyDocument.java
//

#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "J2ObjC_source.h"
#include "java/io/IOException.h"
#include "java/io/Reader.h"
#include "java/lang/IllegalStateException.h"
#include "java/lang/Integer.h"
#include "java/util/ArrayList.h"
#include "java/util/HashMap.h"
#include "java/util/HashSet.h"
#include "java/util/List.h"
#include "java/util/Map.h"
#include "java/util/Set.h"
#include "org/apache/lucene/analysis/Analyzer.h"
#include "org/apache/lucene/analysis/TokenStream.h"
#include "org/apache/lucene/document/Document.h"
#include "org/apache/lucene/document/LazyDocument.h"
#include "org/apache/lucene/index/FieldInfo.h"
#include "org/apache/lucene/index/IndexReader.h"
#include "org/apache/lucene/index/IndexableField.h"
#include "org/apache/lucene/index/IndexableFieldType.h"
#include "org/apache/lucene/util/BytesRef.h"

@interface OrgApacheLuceneDocumentLazyDocument () {
 @public
  OrgApacheLuceneIndexIndexReader *reader_;
  jint docID_;
  OrgApacheLuceneDocumentDocument *doc_;
  id<JavaUtilMap> fields_;
  id<JavaUtilSet> fieldNames_;
}

- (void)fetchRealValuesWithNSString:(NSString *)name
                            withInt:(jint)fieldNum;

@end

J2OBJC_FIELD_SETTER(OrgApacheLuceneDocumentLazyDocument, reader_, OrgApacheLuceneIndexIndexReader *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneDocumentLazyDocument, doc_, OrgApacheLuceneDocumentDocument *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneDocumentLazyDocument, fields_, id<JavaUtilMap>)
J2OBJC_FIELD_SETTER(OrgApacheLuceneDocumentLazyDocument, fieldNames_, id<JavaUtilSet>)

__attribute__((unused)) static void OrgApacheLuceneDocumentLazyDocument_fetchRealValuesWithNSString_withInt_(OrgApacheLuceneDocumentLazyDocument *self, NSString *name, jint fieldNum);

@interface OrgApacheLuceneDocumentLazyDocument_LazyField () {
 @public
  OrgApacheLuceneDocumentLazyDocument *this$0_;
  NSString *name_;
  jint fieldNum_;
}

- (instancetype)initWithOrgApacheLuceneDocumentLazyDocument:(OrgApacheLuceneDocumentLazyDocument *)outer$
                                               withNSString:(NSString *)name
                                                    withInt:(jint)fieldNum;

- (id<OrgApacheLuceneIndexIndexableField>)getRealValue;

@end

J2OBJC_FIELD_SETTER(OrgApacheLuceneDocumentLazyDocument_LazyField, this$0_, OrgApacheLuceneDocumentLazyDocument *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneDocumentLazyDocument_LazyField, name_, NSString *)

__attribute__((unused)) static void OrgApacheLuceneDocumentLazyDocument_LazyField_initWithOrgApacheLuceneDocumentLazyDocument_withNSString_withInt_(OrgApacheLuceneDocumentLazyDocument_LazyField *self, OrgApacheLuceneDocumentLazyDocument *outer$, NSString *name, jint fieldNum);

__attribute__((unused)) static OrgApacheLuceneDocumentLazyDocument_LazyField *new_OrgApacheLuceneDocumentLazyDocument_LazyField_initWithOrgApacheLuceneDocumentLazyDocument_withNSString_withInt_(OrgApacheLuceneDocumentLazyDocument *outer$, NSString *name, jint fieldNum) NS_RETURNS_RETAINED;

__attribute__((unused)) static OrgApacheLuceneDocumentLazyDocument_LazyField *create_OrgApacheLuceneDocumentLazyDocument_LazyField_initWithOrgApacheLuceneDocumentLazyDocument_withNSString_withInt_(OrgApacheLuceneDocumentLazyDocument *outer$, NSString *name, jint fieldNum);

__attribute__((unused)) static id<OrgApacheLuceneIndexIndexableField> OrgApacheLuceneDocumentLazyDocument_LazyField_getRealValue(OrgApacheLuceneDocumentLazyDocument_LazyField *self);

@implementation OrgApacheLuceneDocumentLazyDocument

- (instancetype)initWithOrgApacheLuceneIndexIndexReader:(OrgApacheLuceneIndexIndexReader *)reader
                                                withInt:(jint)docID {
  OrgApacheLuceneDocumentLazyDocument_initWithOrgApacheLuceneIndexIndexReader_withInt_(self, reader, docID);
  return self;
}

- (id<OrgApacheLuceneIndexIndexableField>)getFieldWithOrgApacheLuceneIndexFieldInfo:(OrgApacheLuceneIndexFieldInfo *)fieldInfo {
  [((id<JavaUtilSet>) nil_chk(fieldNames_)) addWithId:((OrgApacheLuceneIndexFieldInfo *) nil_chk(fieldInfo))->name_];
  id<JavaUtilList> values = [((id<JavaUtilMap>) nil_chk(fields_)) getWithId:JavaLangInteger_valueOfWithInt_(fieldInfo->number_)];
  if (nil == values) {
    values = create_JavaUtilArrayList_init();
    [((id<JavaUtilMap>) nil_chk(fields_)) putWithId:JavaLangInteger_valueOfWithInt_(fieldInfo->number_) withId:values];
  }
  OrgApacheLuceneDocumentLazyDocument_LazyField *value = create_OrgApacheLuceneDocumentLazyDocument_LazyField_initWithOrgApacheLuceneDocumentLazyDocument_withNSString_withInt_(self, fieldInfo->name_, fieldInfo->number_);
  [values addWithId:value];
  @synchronized(self) {
    JreStrongAssign(&doc_, nil);
  }
  return value;
}

- (OrgApacheLuceneDocumentDocument *)getDocument {
  @synchronized(self) {
    if (doc_ == nil) {
      @try {
        JreStrongAssign(&doc_, [((OrgApacheLuceneIndexIndexReader *) nil_chk(reader_)) documentWithInt:docID_ withJavaUtilSet:fieldNames_]);
      }
      @catch (JavaIoIOException *ioe) {
        @throw create_JavaLangIllegalStateException_initWithNSString_withNSException_(@"unable to load document", ioe);
      }
    }
    return doc_;
  }
}

- (void)fetchRealValuesWithNSString:(NSString *)name
                            withInt:(jint)fieldNum {
  OrgApacheLuceneDocumentLazyDocument_fetchRealValuesWithNSString_withInt_(self, name, fieldNum);
}

- (void)dealloc {
  RELEASE_(reader_);
  RELEASE_(doc_);
  RELEASE_(fields_);
  RELEASE_(fieldNames_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithOrgApacheLuceneIndexIndexReader:withInt:", "LazyDocument", NULL, 0x1, NULL, NULL },
    { "getFieldWithOrgApacheLuceneIndexFieldInfo:", "getField", "Lorg.apache.lucene.index.IndexableField;", 0x1, NULL, NULL },
    { "getDocument", NULL, "Lorg.apache.lucene.document.Document;", 0x20, NULL, NULL },
    { "fetchRealValuesWithNSString:withInt:", "fetchRealValues", "V", 0x2, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "reader_", NULL, 0x12, "Lorg.apache.lucene.index.IndexReader;", NULL, NULL, .constantValue.asLong = 0 },
    { "docID_", NULL, 0x12, "I", NULL, NULL, .constantValue.asLong = 0 },
    { "doc_", NULL, 0x2, "Lorg.apache.lucene.document.Document;", NULL, NULL, .constantValue.asLong = 0 },
    { "fields_", NULL, 0x2, "Ljava.util.Map;", NULL, "Ljava/util/Map<Ljava/lang/Integer;Ljava/util/List<Lorg/apache/lucene/document/LazyDocument$LazyField;>;>;", .constantValue.asLong = 0 },
    { "fieldNames_", NULL, 0x2, "Ljava.util.Set;", NULL, "Ljava/util/Set<Ljava/lang/String;>;", .constantValue.asLong = 0 },
  };
  static const char *inner_classes[] = {"Lorg.apache.lucene.document.LazyDocument$LazyField;"};
  static const J2ObjcClassInfo _OrgApacheLuceneDocumentLazyDocument = { 2, "LazyDocument", "org.apache.lucene.document", NULL, 0x1, 4, methods, 5, fields, 0, NULL, 1, inner_classes, NULL, NULL };
  return &_OrgApacheLuceneDocumentLazyDocument;
}

@end

void OrgApacheLuceneDocumentLazyDocument_initWithOrgApacheLuceneIndexIndexReader_withInt_(OrgApacheLuceneDocumentLazyDocument *self, OrgApacheLuceneIndexIndexReader *reader, jint docID) {
  NSObject_init(self);
  JreStrongAssignAndConsume(&self->fields_, new_JavaUtilHashMap_init());
  JreStrongAssignAndConsume(&self->fieldNames_, new_JavaUtilHashSet_init());
  JreStrongAssign(&self->reader_, reader);
  self->docID_ = docID;
}

OrgApacheLuceneDocumentLazyDocument *new_OrgApacheLuceneDocumentLazyDocument_initWithOrgApacheLuceneIndexIndexReader_withInt_(OrgApacheLuceneIndexIndexReader *reader, jint docID) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneDocumentLazyDocument, initWithOrgApacheLuceneIndexIndexReader_withInt_, reader, docID)
}

OrgApacheLuceneDocumentLazyDocument *create_OrgApacheLuceneDocumentLazyDocument_initWithOrgApacheLuceneIndexIndexReader_withInt_(OrgApacheLuceneIndexIndexReader *reader, jint docID) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneDocumentLazyDocument, initWithOrgApacheLuceneIndexIndexReader_withInt_, reader, docID)
}

void OrgApacheLuceneDocumentLazyDocument_fetchRealValuesWithNSString_withInt_(OrgApacheLuceneDocumentLazyDocument *self, NSString *name, jint fieldNum) {
  OrgApacheLuceneDocumentDocument *d = [self getDocument];
  id<JavaUtilList> lazyValues = [((id<JavaUtilMap>) nil_chk(self->fields_)) getWithId:JavaLangInteger_valueOfWithInt_(fieldNum)];
  IOSObjectArray *realValues = [((OrgApacheLuceneDocumentDocument *) nil_chk(d)) getFieldsWithNSString:name];
  JreAssert((((IOSObjectArray *) nil_chk(realValues))->size_ <= [((id<JavaUtilList>) nil_chk(lazyValues)) size]), (JreStrcat("$$", @"More lazy values then real values for field: ", name)));
  for (jint i = 0; i < [lazyValues size]; i++) {
    OrgApacheLuceneDocumentLazyDocument_LazyField *f = [lazyValues getWithInt:i];
    if (nil != f) {
      JreVolatileStrongAssign(&f->realValue_, IOSObjectArray_Get(realValues, i));
    }
  }
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneDocumentLazyDocument)

@implementation OrgApacheLuceneDocumentLazyDocument_LazyField

- (instancetype)initWithOrgApacheLuceneDocumentLazyDocument:(OrgApacheLuceneDocumentLazyDocument *)outer$
                                               withNSString:(NSString *)name
                                                    withInt:(jint)fieldNum {
  OrgApacheLuceneDocumentLazyDocument_LazyField_initWithOrgApacheLuceneDocumentLazyDocument_withNSString_withInt_(self, outer$, name, fieldNum);
  return self;
}

- (jboolean)hasBeenLoaded {
  return nil != JreLoadVolatileId(&realValue_);
}

- (id<OrgApacheLuceneIndexIndexableField>)getRealValue {
  return OrgApacheLuceneDocumentLazyDocument_LazyField_getRealValue(self);
}

- (NSString *)name {
  return name_;
}

- (jfloat)boost {
  return 1.0f;
}

- (OrgApacheLuceneUtilBytesRef *)binaryValue {
  return [((id<OrgApacheLuceneIndexIndexableField>) nil_chk(OrgApacheLuceneDocumentLazyDocument_LazyField_getRealValue(self))) binaryValue];
}

- (NSString *)stringValue {
  return [((id<OrgApacheLuceneIndexIndexableField>) nil_chk(OrgApacheLuceneDocumentLazyDocument_LazyField_getRealValue(self))) stringValue];
}

- (JavaIoReader *)readerValue {
  return [((id<OrgApacheLuceneIndexIndexableField>) nil_chk(OrgApacheLuceneDocumentLazyDocument_LazyField_getRealValue(self))) readerValue];
}

- (NSNumber *)numericValue {
  return [((id<OrgApacheLuceneIndexIndexableField>) nil_chk(OrgApacheLuceneDocumentLazyDocument_LazyField_getRealValue(self))) numericValue];
}

- (id<OrgApacheLuceneIndexIndexableFieldType>)fieldType {
  return [((id<OrgApacheLuceneIndexIndexableField>) nil_chk(OrgApacheLuceneDocumentLazyDocument_LazyField_getRealValue(self))) fieldType];
}

- (OrgApacheLuceneAnalysisTokenStream *)tokenStreamWithOrgApacheLuceneAnalysisAnalyzer:(OrgApacheLuceneAnalysisAnalyzer *)analyzer
                                                withOrgApacheLuceneAnalysisTokenStream:(OrgApacheLuceneAnalysisTokenStream *)reuse {
  return [((id<OrgApacheLuceneIndexIndexableField>) nil_chk(OrgApacheLuceneDocumentLazyDocument_LazyField_getRealValue(self))) tokenStreamWithOrgApacheLuceneAnalysisAnalyzer:analyzer withOrgApacheLuceneAnalysisTokenStream:reuse];
}

- (void)__javaClone:(OrgApacheLuceneDocumentLazyDocument_LazyField *)original {
  [super __javaClone:original];
  JreCloneVolatileStrong(&realValue_, &original->realValue_);
}

- (void)dealloc {
  RELEASE_(this$0_);
  RELEASE_(name_);
  JreReleaseVolatile(&realValue_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithOrgApacheLuceneDocumentLazyDocument:withNSString:withInt:", "LazyField", NULL, 0x2, NULL, NULL },
    { "hasBeenLoaded", NULL, "Z", 0x1, NULL, NULL },
    { "getRealValue", NULL, "Lorg.apache.lucene.index.IndexableField;", 0x2, NULL, NULL },
    { "name", NULL, "Ljava.lang.String;", 0x1, NULL, NULL },
    { "boost", NULL, "F", 0x1, NULL, NULL },
    { "binaryValue", NULL, "Lorg.apache.lucene.util.BytesRef;", 0x1, NULL, NULL },
    { "stringValue", NULL, "Ljava.lang.String;", 0x1, NULL, NULL },
    { "readerValue", NULL, "Ljava.io.Reader;", 0x1, NULL, NULL },
    { "numericValue", NULL, "Ljava.lang.Number;", 0x1, NULL, NULL },
    { "fieldType", NULL, "Lorg.apache.lucene.index.IndexableFieldType;", 0x1, NULL, NULL },
    { "tokenStreamWithOrgApacheLuceneAnalysisAnalyzer:withOrgApacheLuceneAnalysisTokenStream:", "tokenStream", "Lorg.apache.lucene.analysis.TokenStream;", 0x1, "Ljava.io.IOException;", NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "this$0_", NULL, 0x1012, "Lorg.apache.lucene.document.LazyDocument;", NULL, NULL, .constantValue.asLong = 0 },
    { "name_", NULL, 0x2, "Ljava.lang.String;", NULL, NULL, .constantValue.asLong = 0 },
    { "fieldNum_", NULL, 0x2, "I", NULL, NULL, .constantValue.asLong = 0 },
    { "realValue_", NULL, 0x40, "Lorg.apache.lucene.index.IndexableField;", NULL, NULL, .constantValue.asLong = 0 },
  };
  static const J2ObjcClassInfo _OrgApacheLuceneDocumentLazyDocument_LazyField = { 2, "LazyField", "org.apache.lucene.document", "LazyDocument", 0x1, 11, methods, 4, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_OrgApacheLuceneDocumentLazyDocument_LazyField;
}

@end

void OrgApacheLuceneDocumentLazyDocument_LazyField_initWithOrgApacheLuceneDocumentLazyDocument_withNSString_withInt_(OrgApacheLuceneDocumentLazyDocument_LazyField *self, OrgApacheLuceneDocumentLazyDocument *outer$, NSString *name, jint fieldNum) {
  JreStrongAssign(&self->this$0_, outer$);
  NSObject_init(self);
  JreVolatileStrongAssign(&self->realValue_, nil);
  JreStrongAssign(&self->name_, name);
  self->fieldNum_ = fieldNum;
}

OrgApacheLuceneDocumentLazyDocument_LazyField *new_OrgApacheLuceneDocumentLazyDocument_LazyField_initWithOrgApacheLuceneDocumentLazyDocument_withNSString_withInt_(OrgApacheLuceneDocumentLazyDocument *outer$, NSString *name, jint fieldNum) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneDocumentLazyDocument_LazyField, initWithOrgApacheLuceneDocumentLazyDocument_withNSString_withInt_, outer$, name, fieldNum)
}

OrgApacheLuceneDocumentLazyDocument_LazyField *create_OrgApacheLuceneDocumentLazyDocument_LazyField_initWithOrgApacheLuceneDocumentLazyDocument_withNSString_withInt_(OrgApacheLuceneDocumentLazyDocument *outer$, NSString *name, jint fieldNum) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneDocumentLazyDocument_LazyField, initWithOrgApacheLuceneDocumentLazyDocument_withNSString_withInt_, outer$, name, fieldNum)
}

id<OrgApacheLuceneIndexIndexableField> OrgApacheLuceneDocumentLazyDocument_LazyField_getRealValue(OrgApacheLuceneDocumentLazyDocument_LazyField *self) {
  if (nil == JreLoadVolatileId(&self->realValue_)) {
    OrgApacheLuceneDocumentLazyDocument_fetchRealValuesWithNSString_withInt_(self->this$0_, self->name_, self->fieldNum_);
  }
  JreAssert(([self hasBeenLoaded]), (@"field value was not lazy loaded"));
  JreAssert(([((NSString *) nil_chk([((id<OrgApacheLuceneIndexIndexableField>) nil_chk(JreLoadVolatileId(&self->realValue_))) name])) isEqual:[self name]]), (JreStrcat("$$$$", @"realvalue name != name: ", [((id<OrgApacheLuceneIndexIndexableField>) nil_chk(JreLoadVolatileId(&self->realValue_))) name], @" != ", [self name])));
  return JreLoadVolatileId(&self->realValue_);
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneDocumentLazyDocument_LazyField)
